<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.527">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="SEOYEON CHOI">
<meta name="dcterms.date" content="2023-10-20">

<title>Seoyeon’s Blog for study - [GODE]final GODE code</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Seoyeon’s Blog for study</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../about.html" aria-current="page"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/seoyeonc/blog/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Posts</li><li class="breadcrumb-item"><a href="../../posts/GODE/index.html">GODE</a></li><li class="breadcrumb-item"><a href="../../posts/GODE/2023-10-20-final_GODE_code.html"><strong>[GODE]</strong>final GODE code</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Posts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">CAM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CAM/2023-08-28-HCAM_random_old.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[CAM]</strong>HCAM random</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CAM/2023-09-15-CAM-Original_rst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[CAM]</strong>Original CAM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CAM/2023-09-16-Grad_CAM_rst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[CAM]</strong>Grad CAM(Original, Randombox)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CAM/2023-09-19-HCAM_original.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[CAM]</strong>HCAM original</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CAM/2023-09-21-CAM_chest_xray.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[CAM]</strong>chest xray</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CAM/2023-09-23-HCAM_hy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[CAM]</strong>HCAM_ebayes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CAM/2023-10-18-CAM_Other_Methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[CAM]</strong>Other Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CAM/2023-10-31-HCAM_Other_Methods_chest_xray.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[CAM]</strong>other methods chest xray</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CAM/2023-11-09-CAM_Scorecam_rst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[CAM]</strong>Score CAM(Original, Randombox)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CAM/2023-11-29-HCAM_Tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[CAM]</strong>HCAM Tutorial</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">FRAUD</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/FRAUD/2023-07-10-fraud_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fraud data</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/GCN/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GCN</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-07-torchgcn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TORCH_GEOMETRIC.NN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-21-ST-GCN_Dataset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PyTorch ST-GCN Dataset</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-28-gcn_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulation of geometric-temporal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-29-STGCN-tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[IT-STGCN]</strong> STGCN 튜토리얼</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-05-GNAR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GNAR data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-11-Algorithm_EX_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GCN Algorithm Example 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-18-Algorithm_traintest_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2nd ST-GCN Example dividing train and test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-20-Algorithm_traintest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1st ST-GCN Example dividing train and test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-21-Class.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class of Method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-26-ESTGCN_GNAR_DATA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class of Method(GNAR) lag 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-26-ESTGCN_WIKI_DATA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class of Method(WikiMath) lag 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-26-guebin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class of Method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-06-ESTGCN_GNAR_DATA_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class of Method(GNAR) lag 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-06-ESTGCN_GNAR_DATA_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class of Method(GNAR) lag 1 80% Missing repeat</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-07-ESTGCN_WIKI_DATA_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class of Method(WikiMath) lag 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-20-ESTGCN_GNAR_edit_guebin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1st ITSTGCN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-20-ESTGCN_GNAR_edit_guebin2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2nd ITSTGCN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-03-ESTGCN_GNAR_edit_guebin2_seoyeon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SY 1st ITSTGCN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-17-ITSTGCN-Tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ITSTGCN-Tutorial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-20-data load, data save as pickle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">data load, data save as pickle</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-05-Simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-05-Simulation_boxplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-06-METRLADatasetLoader.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">METRLADatasetLoader-Tutorial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-25-note_matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Note_weight amatrix</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-27-simulation_table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulation Tables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-27-toy_example_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Toy Example Note</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-29-pedalme_GSO_st.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Padalme GSO_st</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-04-questions of pytorch geometric temporal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Questions of PyTorch Geometric Temporal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-06-article_refer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ITSTGCN Article Refernece</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-11-CPUvsGPU.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PyG Geometric Temporal CPU vs GPU</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-11-PyGGeometricTemporalEx.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PyG Geometric Temporal Examples</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-17-itstgcntry)fail_version__Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulation_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-17-xx_GCONVGRU_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GConvGRU_Simulation Tables_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-25-GCONVGRU_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GConvGRU and GNAR_Simulation Tables_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-25-GCONVGRU_snd_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GConvGRU_Simulation Boxplot_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-27-AddingtheRecurrentGCNmodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Adding the RecurrentGCN models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-30-GConvLSTM_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GConvLSTM_Simulation_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-30-GConvLSTM_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GConvLSTM_Simulation Tables_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-06-GCLSTM_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GCLSTM_Simulation_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-06-GCLSTM_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GCLSTM_Simulation Tables_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-13-DCRNN_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DCRNN_Simulation_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-13-DCRNN_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DCRNN_Simulation Tables_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-19-LRGCN_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LRGCN_Simulation_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-19-LRGCN_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LRGCN_Simulation Tables_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-20-TGCN_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TGCN_Simulation_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-20-TGCN_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TGCN_Simulation Tables_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-25-EvolveGCNO_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EvolveGCNO_Simulation_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-25-EvolveGCNO_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EvolveGCNO_Simulation Tables_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-28-DYGRENCODER_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DYGRENCODER_Simulation_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-28-DYGRENCODER_Simulation_boxplot_reshape (SEOYEON CHOI's conflicted copy 2023-09-27).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DYGRENCODER_Simulation_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-28-DYGRENCODER_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DYGRENCODER_Simulation Tables_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-07-01-EvolveGCNH_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EvolveGCNH_Simulation_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-07-01-EvolveGCNH_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EvolveGCNH_Simulation Tables_reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-07-04-toy_example_figure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Toy Example Figure(Intro)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-07-08-toy_example_using_gnar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Toy example using GNAR</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-07-17-toy_example_guebin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Toy example using GNAR</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-07-18-EbayesThresh toy ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EbayesThresh Toy ex</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-07-18-Self Consistency toy ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Self Consistency Toy ex</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-08-25-batch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Batch</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2099-03-18-SimulationPlanner-Tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SimualtionPlanner-Tutorial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2099-03-22-Baseline_SimulationPlanner-Tutorial_test_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SimualtionPlanner-Tutorial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2099-05-31-Other Method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ITSTGCN add Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2099-07-05-ITSTGCN_data_management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data management for ITSTGCN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2099-07-20-ITSTGCN_data_magement_figure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data management Figure for ITSTGCN</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/GODE/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GODE</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-09-02-paper_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-10-02-Earthquake_real.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Earthquake</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-11-19-class_code_for_paper.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class code for Comparison Study</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-12-01-graph_code_guebin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graph code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-12-16-linspace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">linspace</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-12-27-DFT_study.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete Fourier Transform</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2023-06-22-comparison_earthquake.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Comparison Results on Real Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2023-06-27-Linear_graph_code_for_paper.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Graph code for Paper</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2023-07-03-other_outlier_detection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other Outlier Detection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2023-08-05-semifinal_simulation_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Semifinal_Other Outlier Detection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2023-08-16-final GODE code(paper).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">final GODE code(paper)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2023-08-16-options.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The options of Outlier Detection method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2023-10-20-final_GODE_code.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><strong>[GODE]</strong>final GODE code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2023-11-03-final_graph_code_for_paper.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">[GODE]Final Graph code for GODE Paper</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2023-11-27-GODE_Tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[GODE]</strong>Package Tutorial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2023-11-29-PR_Other Methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[GODE]</strong>GODE Other Methods</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/RESEARCHES/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RESEARCHES</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/RESEARCHES/2023-07-07-Stock_Crawling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stock Crawling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/RESEARCHES/2023-07-08-stock_on_graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stock on Graph</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/RESEARCHES/2023-07-22-ls2.out.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PyG lesson2: 벤치마크 데이터셋 (train/test분리)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/RESEARCHES/2023-08-26-zero-shot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[LLM]</strong>Zeroshot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/RESEARCHES/2023-09-07-ANOMALOUS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[ANOMALOUS]</strong>Graph</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/RESEARCHES/2023-09-08-llama2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[LLM]</strong>LLAMA2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/RESEARCHES/2023-10-26-pygod.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[ANOMALOUS]</strong>PYGOD</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import" id="toc-import" class="nav-link active" data-scroll-target="#import">Import</a></li>
  <li><a href="#class" id="toc-class" class="nav-link" data-scroll-target="#class">Class</a></li>
  <li><a href="#linear" id="toc-linear" class="nav-link" data-scroll-target="#linear">Linear</a>
  <ul class="collapse">
  <li><a href="#gode_linear" id="toc-gode_linear" class="nav-link" data-scroll-target="#gode_linear">GODE_Linear</a></li>
  <li><a href="#lof_linear" id="toc-lof_linear" class="nav-link" data-scroll-target="#lof_linear">LOF_Linear</a></li>
  <li><a href="#knn_linear" id="toc-knn_linear" class="nav-link" data-scroll-target="#knn_linear">KNN_Linear</a></li>
  <li><a href="#cblof_linear" id="toc-cblof_linear" class="nav-link" data-scroll-target="#cblof_linear">CBLOF_Linear</a></li>
  <li><a href="#ocsvm_linear" id="toc-ocsvm_linear" class="nav-link" data-scroll-target="#ocsvm_linear">OCSVM_Linear</a></li>
  <li><a href="#mcd_linear" id="toc-mcd_linear" class="nav-link" data-scroll-target="#mcd_linear">MCD_Linear</a></li>
  <li><a href="#feature-bagging_linear" id="toc-feature-bagging_linear" class="nav-link" data-scroll-target="#feature-bagging_linear">Feature Bagging_Linear</a></li>
  <li><a href="#abod_linear" id="toc-abod_linear" class="nav-link" data-scroll-target="#abod_linear">ABOD_Linear</a></li>
  <li><a href="#iforest_linear" id="toc-iforest_linear" class="nav-link" data-scroll-target="#iforest_linear">IForest_Linear</a></li>
  <li><a href="#hbos_linear" id="toc-hbos_linear" class="nav-link" data-scroll-target="#hbos_linear">HBOS_Linear</a></li>
  <li><a href="#sos_linear" id="toc-sos_linear" class="nav-link" data-scroll-target="#sos_linear">SOS_Linear</a></li>
  <li><a href="#so_gaal_linear" id="toc-so_gaal_linear" class="nav-link" data-scroll-target="#so_gaal_linear">SO_GAAL_Linear</a></li>
  <li><a href="#mo_gaal_linear" id="toc-mo_gaal_linear" class="nav-link" data-scroll-target="#mo_gaal_linear">MO_GAAL_Linear</a></li>
  <li><a href="#lscp_linear" id="toc-lscp_linear" class="nav-link" data-scroll-target="#lscp_linear">LSCP_Linear</a></li>
  <li><a href="#tab_linear" id="toc-tab_linear" class="nav-link" data-scroll-target="#tab_linear">tab_linear</a></li>
  </ul></li>
  <li><a href="#orbit" id="toc-orbit" class="nav-link" data-scroll-target="#orbit">Orbit</a>
  <ul class="collapse">
  <li><a href="#gode_orbit" id="toc-gode_orbit" class="nav-link" data-scroll-target="#gode_orbit">GODE_Orbit</a></li>
  <li><a href="#lof_orbit" id="toc-lof_orbit" class="nav-link" data-scroll-target="#lof_orbit">LOF_Orbit</a></li>
  <li><a href="#knn_orbit" id="toc-knn_orbit" class="nav-link" data-scroll-target="#knn_orbit">KNN_Orbit</a></li>
  <li><a href="#cblof_orbit" id="toc-cblof_orbit" class="nav-link" data-scroll-target="#cblof_orbit">CBLOF_Orbit</a></li>
  <li><a href="#ocsvm_orbit" id="toc-ocsvm_orbit" class="nav-link" data-scroll-target="#ocsvm_orbit">OCSVM_Orbit</a></li>
  <li><a href="#mcd_orbit" id="toc-mcd_orbit" class="nav-link" data-scroll-target="#mcd_orbit">MCD_Orbit</a></li>
  <li><a href="#feature-bagging_orbit" id="toc-feature-bagging_orbit" class="nav-link" data-scroll-target="#feature-bagging_orbit">Feature Bagging_Orbit</a></li>
  <li><a href="#abod_orbit" id="toc-abod_orbit" class="nav-link" data-scroll-target="#abod_orbit">ABOD_Orbit</a></li>
  <li><a href="#iforest_orbit" id="toc-iforest_orbit" class="nav-link" data-scroll-target="#iforest_orbit">IForest_Orbit</a></li>
  <li><a href="#hbos_orbit" id="toc-hbos_orbit" class="nav-link" data-scroll-target="#hbos_orbit">HBOS_Orbit</a></li>
  <li><a href="#sos_orbit" id="toc-sos_orbit" class="nav-link" data-scroll-target="#sos_orbit">SOS_Orbit</a></li>
  <li><a href="#so_gaal_orbit" id="toc-so_gaal_orbit" class="nav-link" data-scroll-target="#so_gaal_orbit">SO_GAAL_Orbit</a></li>
  <li><a href="#mo_gaal_orbit" id="toc-mo_gaal_orbit" class="nav-link" data-scroll-target="#mo_gaal_orbit">MO_GAAL_Orbit</a></li>
  <li><a href="#lscp_orbit" id="toc-lscp_orbit" class="nav-link" data-scroll-target="#lscp_orbit">LSCP_Orbit</a></li>
  <li><a href="#tab_orbit" id="toc-tab_orbit" class="nav-link" data-scroll-target="#tab_orbit">tab_orbit</a></li>
  </ul></li>
  <li><a href="#bunny" id="toc-bunny" class="nav-link" data-scroll-target="#bunny">Bunny</a>
  <ul class="collapse">
  <li><a href="#gode_bunny" id="toc-gode_bunny" class="nav-link" data-scroll-target="#gode_bunny">GODE_Bunny</a></li>
  <li><a href="#lof_bunny" id="toc-lof_bunny" class="nav-link" data-scroll-target="#lof_bunny">LOF_Bunny</a></li>
  <li><a href="#knn_bunny" id="toc-knn_bunny" class="nav-link" data-scroll-target="#knn_bunny">KNN_Bunny</a></li>
  <li><a href="#cblof_bunny" id="toc-cblof_bunny" class="nav-link" data-scroll-target="#cblof_bunny">CBLOF_Bunny</a></li>
  <li><a href="#ocsvm_bunny" id="toc-ocsvm_bunny" class="nav-link" data-scroll-target="#ocsvm_bunny">OCSVM_Bunny</a></li>
  <li><a href="#mcd_bunny" id="toc-mcd_bunny" class="nav-link" data-scroll-target="#mcd_bunny">MCD_Bunny</a></li>
  <li><a href="#feature-bagging_bunny" id="toc-feature-bagging_bunny" class="nav-link" data-scroll-target="#feature-bagging_bunny">Feature Bagging_Bunny</a></li>
  <li><a href="#abod_bunny" id="toc-abod_bunny" class="nav-link" data-scroll-target="#abod_bunny">ABOD_Bunny</a></li>
  <li><a href="#iforest_bunny" id="toc-iforest_bunny" class="nav-link" data-scroll-target="#iforest_bunny">IForest_Bunny</a></li>
  <li><a href="#hbos_bunny" id="toc-hbos_bunny" class="nav-link" data-scroll-target="#hbos_bunny">HBOS_Bunny</a></li>
  <li><a href="#sos_bunny" id="toc-sos_bunny" class="nav-link" data-scroll-target="#sos_bunny">SOS_Bunny</a></li>
  <li><a href="#so_gaal_bunny" id="toc-so_gaal_bunny" class="nav-link" data-scroll-target="#so_gaal_bunny">SO_GAAL_Bunny</a></li>
  <li><a href="#mo_gaal_bunny" id="toc-mo_gaal_bunny" class="nav-link" data-scroll-target="#mo_gaal_bunny">MO_GAAL_Bunny</a></li>
  <li><a href="#lscp_bunny" id="toc-lscp_bunny" class="nav-link" data-scroll-target="#lscp_bunny">LSCP_Bunny</a></li>
  <li><a href="#tab_bunny" id="toc-tab_bunny" class="nav-link" data-scroll-target="#tab_bunny">tab_bunny</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="2023-10-20-final_GODE_code.out.ipynb" download="2023-10-20-final_GODE_code.out.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Posts</li><li class="breadcrumb-item"><a href="../../posts/GODE/index.html">GODE</a></li><li class="breadcrumb-item"><a href="../../posts/GODE/2023-10-20-final_GODE_code.html"><strong>[GODE]</strong>final GODE code</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><strong>[GODE]</strong>final GODE code</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>SEOYEON CHOI </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 20, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="import" class="level1">
<h1>Import</h1>
<div id="2a4d8094-356e-4769-94d7-e221cd2f38f8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">"ignore"</span>, np.ComplexWarning)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> haversine <span class="im">import</span> haversine</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> copy </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tqdm</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.packages <span class="im">import</span> importr</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.vectors <span class="im">import</span> FloatVector </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pygsp <span class="im">import</span> graphs, filters, plotting, utils</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, precision_score, recall_score, f1_score, accuracy_score, roc_curve, auc</span></code></pre></div>
</div>
<div id="466f3f5d-9899-4a27-b509-15971c3a62c9" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.lof <span class="im">import</span> LOF</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.knn <span class="im">import</span> KNN</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.cblof <span class="im">import</span> CBLOF</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.ocsvm <span class="im">import</span> OCSVM</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.mcd <span class="im">import</span> MCD</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.feature_bagging <span class="im">import</span> FeatureBagging</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.abod <span class="im">import</span> ABOD</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.iforest <span class="im">import</span> IForest</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.hbos <span class="im">import</span> HBOS</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.sos <span class="im">import</span> SOS</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.so_gaal <span class="im">import</span> SO_GAAL</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.mo_gaal <span class="im">import</span> MO_GAAL</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyod.models.lscp <span class="im">import</span> LSCP</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-11-27 13:23:42.982919: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.</code></pre>
</div>
</div>
</section>
<section id="class" class="level1">
<h1>Class</h1>
<div id="cf09a4b7-f70b-483a-82e3-99c99cc3c0dc" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Conf_matrx:</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,original,compare):</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.original <span class="op">=</span> original</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.compare <span class="op">=</span> compare</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> conf(<span class="va">self</span>,name):</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.conf_matrix <span class="op">=</span> confusion_matrix(<span class="va">self</span>.original, <span class="va">self</span>.compare)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        ax.matshow(<span class="va">self</span>.conf_matrix, cmap<span class="op">=</span>plt.cm.Oranges, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.conf_matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.conf_matrix.shape[<span class="dv">1</span>]):</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                ax.text(x<span class="op">=</span>j, y<span class="op">=</span>i,s<span class="op">=</span><span class="va">self</span>.conf_matrix[i, j], va<span class="op">=</span><span class="st">'center'</span>, ha<span class="op">=</span><span class="st">'center'</span>, size<span class="op">=</span><span class="st">'xx-large'</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(<span class="st">'Predictions'</span>, fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">'Actuals'</span>, fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="st">'Confusion Matrix of '</span> <span class="op">+</span> <span class="bu">str</span>(name), fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.acc <span class="op">=</span> accuracy_score(<span class="va">self</span>.original, <span class="va">self</span>.compare)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.pre <span class="op">=</span> precision_score(<span class="va">self</span>.original, <span class="va">self</span>.compare)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.rec <span class="op">=</span> recall_score(<span class="va">self</span>.original, <span class="va">self</span>.compare)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.f1 <span class="op">=</span> f1_score(<span class="va">self</span>.original, <span class="va">self</span>.compare)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'Accuracy: </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="va">self</span>.acc)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'Precision: </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="va">self</span>.pre)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'Recall: </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="va">self</span>.rec)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'F1 Score: </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="va">self</span>.f1)</span></code></pre></div>
</div>
<div id="5ac59005-c866-4308-af3d-376e69928bbb" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Linear:</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,df):</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df <span class="op">=</span> df</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.y <span class="op">=</span> df.y.to_numpy()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x <span class="op">=</span> df.x.to_numpy()</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.y)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.W <span class="op">=</span> w</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _eigen(<span class="va">self</span>):</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        d<span class="op">=</span> <span class="va">self</span>.W.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        D<span class="op">=</span> np.diag(d)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.L <span class="op">=</span> np.diag(<span class="dv">1</span><span class="op">/</span>np.sqrt(d)) <span class="op">@</span> (D<span class="op">-</span><span class="va">self</span>.W) <span class="op">@</span> np.diag(<span class="dv">1</span><span class="op">/</span>np.sqrt(d))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lamb, <span class="va">self</span>.Psi <span class="op">=</span> np.linalg.eigh(<span class="va">self</span>.L)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.Lamb <span class="op">=</span> np.diag(<span class="va">self</span>.lamb)      </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fit(<span class="va">self</span>,sd<span class="op">=</span><span class="dv">20</span>): <span class="co"># fit with ebayesthresh</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._eigen()</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ybar <span class="op">=</span> <span class="va">self</span>.Psi.T <span class="op">@</span> <span class="va">self</span>.y <span class="co"># fbar := graph fourier transform of f</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.power <span class="op">=</span> <span class="va">self</span>.ybar<span class="op">**</span><span class="dv">2</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        ebayesthresh <span class="op">=</span> importr(<span class="st">'EbayesThresh'</span>).ebayesthresh</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.power_threshed<span class="op">=</span>np.array(ebayesthresh(FloatVector(<span class="va">self</span>.power),sd<span class="op">=</span>sd))</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ybar_threshed <span class="op">=</span> np.where(<span class="va">self</span>.power_threshed<span class="op">&gt;</span><span class="dv">0</span>,<span class="va">self</span>.ybar,<span class="dv">0</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.yhat <span class="op">=</span> <span class="va">self</span>.Psi<span class="op">@</span>self.ybar_threshed</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df <span class="op">=</span> <span class="va">self</span>.df.assign(yHat <span class="op">=</span> <span class="va">self</span>.yhat)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df <span class="op">=</span> <span class="va">self</span>.df.assign(Residual <span class="op">=</span> <span class="va">self</span>.df.y<span class="op">-</span> <span class="va">self</span>.df.yHat)</span></code></pre></div>
</div>
<div id="cf41ddd6-2466-4bb4-a402-63ed0ba5bf67" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Orbit:</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,df):</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df <span class="op">=</span> df </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.f <span class="op">=</span> df.f.to_numpy()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x <span class="op">=</span> df.x.to_numpy()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.y <span class="op">=</span> df.y.to_numpy()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.f)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.theta<span class="op">=</span> <span class="va">None</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_distance(<span class="va">self</span>):</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.D <span class="op">=</span> np.zeros([<span class="va">self</span>.n,<span class="va">self</span>.n])</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        locations <span class="op">=</span> np.stack([<span class="va">self</span>.x, <span class="va">self</span>.y],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> tqdm.tqdm(<span class="bu">range</span>(<span class="va">self</span>.n)):</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i,<span class="va">self</span>.n):</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.D[i,j]<span class="op">=</span>np.linalg.norm(locations[i]<span class="op">-</span>locations[j])</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.D <span class="op">=</span> <span class="va">self</span>.D <span class="op">+</span> <span class="va">self</span>.D.T</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_weightmatrix(<span class="va">self</span>,theta<span class="op">=</span><span class="dv">1</span>,beta<span class="op">=</span><span class="fl">0.5</span>,kappa<span class="op">=</span><span class="dv">4000</span>):</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.theta <span class="op">=</span> theta</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        dist <span class="op">=</span> np.where(<span class="va">self</span>.D <span class="op">&lt;</span> kappa,<span class="va">self</span>.D,<span class="dv">0</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.W <span class="op">=</span> np.exp(<span class="op">-</span>(dist<span class="op">/</span><span class="va">self</span>.theta)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _eigen(<span class="va">self</span>):</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>        d<span class="op">=</span> <span class="va">self</span>.W.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>        D<span class="op">=</span> np.diag(d)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.L <span class="op">=</span> np.diag(<span class="dv">1</span><span class="op">/</span>np.sqrt(d)) <span class="op">@</span> (D<span class="op">-</span><span class="va">self</span>.W) <span class="op">@</span> np.diag(<span class="dv">1</span><span class="op">/</span>np.sqrt(d))</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lamb, <span class="va">self</span>.Psi <span class="op">=</span> np.linalg.eigh(<span class="va">self</span>.L)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.Lamb <span class="op">=</span> np.diag(<span class="va">self</span>.lamb)       </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fit(<span class="va">self</span>,sd<span class="op">=</span><span class="dv">5</span>): <span class="co"># fit with ebayesthresh</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._eigen()</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fbar <span class="op">=</span> <span class="va">self</span>.Psi.T <span class="op">@</span> <span class="va">self</span>.f <span class="co"># fbar := graph fourier transform of f</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.power <span class="op">=</span> <span class="va">self</span>.fbar<span class="op">**</span><span class="dv">2</span> </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        ebayesthresh <span class="op">=</span> importr(<span class="st">'EbayesThresh'</span>).ebayesthresh</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.power_threshed<span class="op">=</span>np.array(ebayesthresh(FloatVector(<span class="va">self</span>.power),sd<span class="op">=</span>sd))</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fbar_threshed <span class="op">=</span> np.where(<span class="va">self</span>.power_threshed<span class="op">&gt;</span><span class="dv">0</span>,<span class="va">self</span>.fbar,<span class="dv">0</span>)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fhat <span class="op">=</span> <span class="va">self</span>.Psi<span class="op">@</span>self.fbar_threshed</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df <span class="op">=</span> <span class="va">self</span>.df.assign(fHat <span class="op">=</span> <span class="va">self</span>.fhat)</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df <span class="op">=</span> <span class="va">self</span>.df.assign(Residual <span class="op">=</span> <span class="va">self</span>.df.f<span class="op">-</span> <span class="va">self</span>.df.fHat)</span></code></pre></div>
</div>
<div id="f1e62c61-755d-4497-a557-b54137e04f18" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BUNNY:</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,df):</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df <span class="op">=</span> df </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.f <span class="op">=</span> df.f.to_numpy()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.z <span class="op">=</span> df.z.to_numpy()</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x <span class="op">=</span> df.x.to_numpy()</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.y <span class="op">=</span> df.y.to_numpy()</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.noise <span class="op">=</span> df.noise.to_numpy()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fnoise <span class="op">=</span> <span class="va">self</span>.f <span class="op">+</span> <span class="va">self</span>.noise</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.W <span class="op">=</span> _W</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.f)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.theta<span class="op">=</span> <span class="va">None</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _eigen(<span class="va">self</span>):</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        d<span class="op">=</span> <span class="va">self</span>.W.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        D<span class="op">=</span> np.diag(d)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.L <span class="op">=</span> np.diag(<span class="dv">1</span><span class="op">/</span>np.sqrt(d)) <span class="op">@</span> (D<span class="op">-</span><span class="va">self</span>.W) <span class="op">@</span> np.diag(<span class="dv">1</span><span class="op">/</span>np.sqrt(d))</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lamb, <span class="va">self</span>.Psi <span class="op">=</span> np.linalg.eigh(<span class="va">self</span>.L)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.Lamb <span class="op">=</span> np.diag(<span class="va">self</span>.lamb)       </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fit(<span class="va">self</span>,sd<span class="op">=</span><span class="dv">5</span>): <span class="co"># fit with ebayesthresh</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._eigen()</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fbar <span class="op">=</span> <span class="va">self</span>.Psi.T <span class="op">@</span> <span class="va">self</span>.fnoise <span class="co"># fbar := graph fourier transform of f</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.power <span class="op">=</span> <span class="va">self</span>.fbar<span class="op">**</span><span class="dv">2</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        ebayesthresh <span class="op">=</span> importr(<span class="st">'EbayesThresh'</span>).ebayesthresh</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.power_threshed<span class="op">=</span>np.array(ebayesthresh(FloatVector(<span class="va">self</span>.power),sd<span class="op">=</span>sd))</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fbar_threshed <span class="op">=</span> np.where(<span class="va">self</span>.power_threshed<span class="op">&gt;</span><span class="dv">0</span>,<span class="va">self</span>.fbar,<span class="dv">0</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fhat <span class="op">=</span> <span class="va">self</span>.Psi<span class="op">@</span>self.fbar_threshed</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df <span class="op">=</span> <span class="va">self</span>.df.assign(fnoise <span class="op">=</span> <span class="va">self</span>.fnoise)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df <span class="op">=</span> <span class="va">self</span>.df.assign(fHat <span class="op">=</span> <span class="va">self</span>.fhat)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df <span class="op">=</span> <span class="va">self</span>.df.assign(Residual <span class="op">=</span> <span class="va">self</span>.df.f <span class="op">+</span> <span class="va">self</span>.df.noise <span class="op">-</span> <span class="va">self</span>.df.fHat)</span></code></pre></div>
</div>
<div id="bceeaf51-6b2c-40ae-b6ad-5db1a4b9868c" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">"Accuracy"</span>,<span class="st">"Precision"</span>,<span class="st">"Recall"</span>,<span class="st">"F1"</span>,<span class="st">"AUC"</span>])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">"Accuracy"</span>,<span class="st">"Precision"</span>,<span class="st">"Recall"</span>,<span class="st">"F1"</span>,<span class="st">"AUC"</span>])</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">"Accuracy"</span>,<span class="st">"Precision"</span>,<span class="st">"Recall"</span>,<span class="st">"F1"</span>,<span class="st">"AUC"</span>])</span></code></pre></div>
</div>
</section>
<section id="linear" class="level1">
<h1>Linear</h1>
<div id="23dd9607-3d46-4532-bfdb-a8efe0d54cea" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">6</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>epsilon <span class="op">=</span> np.around(np.random.normal(size<span class="op">=</span><span class="dv">1000</span>),<span class="dv">15</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>signal <span class="op">=</span> np.random.choice(np.concatenate((np.random.uniform(<span class="op">-</span><span class="dv">7</span>, <span class="op">-</span><span class="dv">5</span>, <span class="dv">25</span>).<span class="bu">round</span>(<span class="dv">15</span>), np.random.uniform(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">25</span>).<span class="bu">round</span>(<span class="dv">15</span>), np.repeat(<span class="dv">0</span>, <span class="dv">950</span>))), <span class="dv">1000</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>eta <span class="op">=</span> signal <span class="op">+</span> epsilon</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>outlier_true_linear<span class="op">=</span> signal.copy()</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>outlier_true_linear <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x<span class="op">!=</span><span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>,outlier_true_linear))</span></code></pre></div>
</div>
<div id="7888042f-362b-4847-acd5-e22f51dc8c8a" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x_1 <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y1_1 <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> x_1</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>y_1 <span class="op">=</span> y1_1 <span class="op">+</span> eta <span class="co"># eta = signal + epsilon</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>_df<span class="op">=</span>pd.DataFrame({<span class="st">'x'</span>:x_1, <span class="st">'y'</span>:y_1})</span></code></pre></div>
</div>
<div id="c6595059-c1e1-4b0f-8819-944d48050b0b" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>w<span class="op">=</span>np.zeros((<span class="dv">1000</span>,<span class="dv">1000</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i<span class="op">==</span>j :</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>            w[i,j] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> np.<span class="bu">abs</span>(i<span class="op">-</span>j) <span class="op">&lt;=</span> <span class="dv">1</span> : </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>            w[i,j] <span class="op">=</span> <span class="dv">1</span></span></code></pre></div>
</div>
<section id="gode_linear" class="level2">
<h2 class="anchored" data-anchor-id="gode_linear">GODE_Linear</h2>
<div id="51d5de85-9748-4745-b676-d1c2f0f816c7" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>_Linear <span class="op">=</span> Linear(_df)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>_Linear.fit(sd<span class="op">=</span><span class="dv">20</span>)</span></code></pre></div>
</div>
<div id="21181938-ac79-4ab2-ac3e-d0249c2d9246" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>outlier_GODE_linear_old <span class="op">=</span> (_Linear.df[<span class="st">'Residual'</span>]<span class="op">**</span><span class="dv">2</span>).tolist()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sorted_data <span class="op">=</span> <span class="bu">sorted</span>(outlier_GODE_linear_old,reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(sorted_data) <span class="op">*</span> <span class="fl">0.05</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>five_percent <span class="op">=</span> sorted_data[index]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>outlier_GODE_linear <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="op">&gt;</span> five_percent <span class="cf">else</span> <span class="dv">0</span>,outlier_GODE_linear_old))</span></code></pre></div>
</div>
<div id="6dbb7d74-b9b1-4bea-80d3-76f43a36fc50" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_GODE_linear)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">'GODE'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.999
Precision: 1.000
Recall: 0.980
F1 Score: 0.990</code></pre>
</div>
</div>
<div id="f589914f-70f1-477c-a33c-a7a4287ce407" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.999
Precision(TP / TP + FP): 1.000
Recall(TP / TP + FN): 0.980
F1 Score(2*precision*recall/precision+recall): 0.990</code></pre>
</div>
</div>
<div id="2baff8bb-7309-4070-b442-f9d6ee03d17a" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,outlier_GODE_linear_old)</span></code></pre></div>
</div>
<div id="0031cf44-dca9-4c56-ac2f-f66973887908" class="cell" data-scrolled="true" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>0.999979338416083</code></pre>
</div>
</div>
<div id="23a0ed27-59a1-4b0e-b42c-09518ca56d90" class="cell" data-scrolled="true" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.0</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="lof_linear" class="level2">
<h2 class="anchored" data-anchor-id="lof_linear">LOF_Linear</h2>
<div id="8b39ef59-b42b-4c01-8f81-aaac1c54639c" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LOF(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>LOF(algorithm='auto', contamination=0.05, leaf_size=30, metric='minkowski',
  metric_params=None, n_jobs=1, n_neighbors=20, novelty=True, p=2)</code></pre>
</div>
</div>
<div id="877d4157-b0e8-4194-b1ee-086ab93cfb36" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>outlier_LOF_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="1876e689-b431-4f9b-a9fc-7cc9eff4fa5f" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,clf.fit_predict(_df))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"LOF (Breunig et al., 2000)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/utils/deprecation.py:86: FutureWarning: Function fit_predict is deprecated
  warnings.warn(msg, category=FutureWarning)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-21-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.991
Precision: 0.920
Recall: 0.902
F1 Score: 0.911</code></pre>
</div>
</div>
<div id="45cc4d90-2db5-468b-85a9-e97b985e2b8c" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.991
Precision(TP / TP + FP): 0.920
Recall(TP / TP + FN): 0.902
F1 Score(2*precision*recall/precision+recall): 0.911</code></pre>
</div>
</div>
<div id="32697087-c53f-4ab7-8fb5-25098a283ba1" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="5c8e029f-51f5-4bdf-bddd-bc33c2264bba" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>0.9975412715138742</code></pre>
</div>
</div>
<div id="f122a31e-45d7-408e-9f89-ab86dfd9a9bf" class="cell" data-scrolled="true" data-execution_count="24">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.00</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="knn_linear" class="level2">
<h2 class="anchored" data-anchor-id="knn_linear">KNN_Linear</h2>
<div id="7417f126-be08-4cae-8da3-aab47e6e251c" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> KNN(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>KNN(algorithm='auto', contamination=0.05, leaf_size=30, method='largest',
  metric='minkowski', metric_params=None, n_jobs=1, n_neighbors=5, p=2,
  radius=1.0)</code></pre>
</div>
</div>
<div id="da183bb5-be4f-4d68-8f6d-086a3411c3a0" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>outlier_KNN_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="02964ac2-eb66-44c4-90db-7854ed9fc809" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_KNN_one)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"kNN (Ramaswamy et al., 2000)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-28-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.991
Precision: 0.920
Recall: 0.902
F1 Score: 0.911</code></pre>
</div>
</div>
<div id="8a0358be-3df8-4797-b405-1de61971f40d" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.991
Precision(TP / TP + FP): 0.920
Recall(TP / TP + FN): 0.902
F1 Score(2*precision*recall/precision+recall): 0.911</code></pre>
</div>
</div>
<div id="f1c6b33b-1b7e-42c3-89e7-0bd086caf029" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="513234ec-2ff3-45d4-9b1f-cc35b7fb35a4" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>0.9973656480505795</code></pre>
</div>
</div>
<div id="4d7c8524-1811-49d6-ac63-42d7752378fc" class="cell" data-scrolled="true" data-execution_count="31">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.00</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997366</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="cblof_linear" class="level2">
<h2 class="anchored" data-anchor-id="cblof_linear">CBLOF_Linear</h2>
<div id="5fd5d5dd-fd98-408c-886f-383aca80b7fe" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> CBLOF(contamination<span class="op">=</span><span class="fl">0.05</span>,random_state<span class="op">=</span><span class="dv">77</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/cluster/_kmeans.py:1412: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>CBLOF(alpha=0.9, beta=5, check_estimator=False, clustering_estimator=None,
   contamination=0.05, n_clusters=8, n_jobs=None, random_state=77,
   use_weights=False)</code></pre>
</div>
</div>
<div id="d6262a0e-2d08-4fbc-905a-0469912f9da8" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>outlier_CBLOF_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="6ed4ca44-5328-480a-926f-29cd79d61d19" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_CBLOF_one)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"CBLOF (He et al., 2003)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-35-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.969
Precision: 0.700
Recall: 0.686
F1 Score: 0.693</code></pre>
</div>
</div>
<div id="6c87d5cf-089e-4452-afd7-410b66d83054" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.969
Precision(TP / TP + FP): 0.700
Recall(TP / TP + FN): 0.686
F1 Score(2*precision*recall/precision+recall): 0.693</code></pre>
</div>
</div>
<div id="0ca6b04b-edd1-42d2-890c-c5984e5f33f1" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="db073c68-ba70-48df-82ce-450e28ad62c3" class="cell" data-scrolled="true" data-execution_count="37">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>0.9592140333477964</code></pre>
</div>
</div>
<div id="93ba6ba1-6c81-4145-99f7-e857a580a4ca" class="cell" data-scrolled="true" data-execution_count="38">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.00</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997366</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.969</td>
<td>0.70</td>
<td>0.686275</td>
<td>0.693069</td>
<td>0.959214</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="ocsvm_linear" class="level2">
<h2 class="anchored" data-anchor-id="ocsvm_linear">OCSVM_Linear</h2>
<div id="312ed6c6-0e3e-4ccb-a2d4-e178da87c04b" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> OCSVM(nu<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>OCSVM(cache_size=200, coef0=0.0, contamination=0.1, degree=3, gamma='auto',
   kernel='rbf', max_iter=-1, nu=0.05, shrinking=True, tol=0.001,
   verbose=False)</code></pre>
</div>
</div>
<div id="4eea4223-309d-457d-aa80-360bcb9f8a71" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>outlier_OSVM_one <span class="op">=</span> <span class="bu">list</span>(clf.predict(_df))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/base.py:457: UserWarning: X has feature names, but OneClassSVM was fitted without feature names
  warnings.warn(</code></pre>
</div>
</div>
<div id="994dd519-21de-4428-9321-657d3170a8ec" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_OSVM_one)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"OCSVM (Sch ̈olkopf et al., 2001)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-42-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.923
Precision: 0.370
Recall: 0.725
F1 Score: 0.490</code></pre>
</div>
</div>
<div id="15f7285c-5494-4032-b624-68ebdaf76391" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.923
Precision(TP / TP + FP): 0.370
Recall(TP / TP + FN): 0.725
F1 Score(2*precision*recall/precision+recall): 0.490</code></pre>
</div>
</div>
<div id="4a170de7-9b8a-4686-8639-b750b2584c4d" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/base.py:457: UserWarning: X has feature names, but OneClassSVM was fitted without feature names
  warnings.warn(</code></pre>
</div>
</div>
<div id="d01d1b92-743b-4352-a60c-d7ee9019b531" class="cell" data-scrolled="true" data-execution_count="44">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>0.8641500857455733</code></pre>
</div>
</div>
<div id="1e9859d0-8ce8-4810-aeee-9c06dc9b0aff" class="cell" data-scrolled="true" data-execution_count="45">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.00</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997366</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.969</td>
<td>0.70</td>
<td>0.686275</td>
<td>0.693069</td>
<td>0.959214</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.923</td>
<td>0.37</td>
<td>0.725490</td>
<td>0.490066</td>
<td>0.864150</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="mcd_linear" class="level2">
<h2 class="anchored" data-anchor-id="mcd_linear">MCD_Linear</h2>
<div id="2f0d88e2-6659-46ea-b32b-bcadf18ac99a" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> MCD(contamination<span class="op">=</span><span class="fl">0.05</span>, random_state <span class="op">=</span> <span class="dv">77</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>MCD(assume_centered=False, contamination=0.05, random_state=77,
  store_precision=True, support_fraction=None)</code></pre>
</div>
</div>
<div id="68605e70-9eef-4685-bbcd-992d2009b9cd" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>outlier_MCD_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="12862cfe-1aa7-4e4c-a070-245290dbfc19" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_MCD_one)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"MCD (Hardin and Rocke, 2004)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-49-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.999
Precision: 1.000
Recall: 0.980
F1 Score: 0.990</code></pre>
</div>
</div>
<div id="e7b8c9b8-e7b8-4957-aaa1-2dcd7427bcda" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.999
Precision(TP / TP + FP): 1.000
Recall(TP / TP + FN): 0.980
F1 Score(2*precision*recall/precision+recall): 0.990</code></pre>
</div>
</div>
<div id="e0292b88-0bd8-4aaa-89d4-9664d347b023" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="33fde9c3-3673-446e-a924-82698e082e7f" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>0.999958676832166</code></pre>
</div>
</div>
<div id="e4be64b2-550a-408a-bbad-a7011a4c7728" class="cell" data-scrolled="true" data-execution_count="52">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.00</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997366</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.969</td>
<td>0.70</td>
<td>0.686275</td>
<td>0.693069</td>
<td>0.959214</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.923</td>
<td>0.37</td>
<td>0.725490</td>
<td>0.490066</td>
<td>0.864150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.999</td>
<td>1.00</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999959</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="feature-bagging_linear" class="level2">
<h2 class="anchored" data-anchor-id="feature-bagging_linear">Feature Bagging_Linear</h2>
<div id="ac320be3-d00a-4c13-9366-fd6ed9d79263" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> FeatureBagging(contamination<span class="op">=</span><span class="fl">0.05</span>, random_state<span class="op">=</span><span class="dv">77</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>FeatureBagging(base_estimator=None, bootstrap_features=False,
        check_detector=True, check_estimator=False, combination='average',
        contamination=0.05, estimator_params={}, max_features=1.0,
        n_estimators=10, n_jobs=1, random_state=77, verbose=0)</code></pre>
</div>
</div>
<div id="76a09558-e4dd-48ee-bea3-c321166bfe7f" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>outlier_FeatureBagging_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="10b63eb5-50f2-45d1-8aeb-cba6bc36df40" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_FeatureBagging_one)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"Feature Bagging (Lazarevic and Kumar, 2005)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-56-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.993
Precision: 0.940
Recall: 0.922
F1 Score: 0.931</code></pre>
</div>
</div>
<div id="e1c54b3f-5748-418b-abbc-376c4006e8e0" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.993
Precision(TP / TP + FP): 0.940
Recall(TP / TP + FN): 0.922
F1 Score(2*precision*recall/precision+recall): 0.931</code></pre>
</div>
</div>
<div id="50003c42-ce8b-41a4-8b08-9ba93004c3cc" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="e14d6e3d-7ab8-4edc-a4a1-111876c6df9b" class="cell" data-scrolled="true" data-execution_count="58">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>0.9973966404264551</code></pre>
</div>
</div>
<div id="bfd514f9-6197-4288-9d3d-7a0be747c325" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.00</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997366</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.969</td>
<td>0.70</td>
<td>0.686275</td>
<td>0.693069</td>
<td>0.959214</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.923</td>
<td>0.37</td>
<td>0.725490</td>
<td>0.490066</td>
<td>0.864150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.999</td>
<td>1.00</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999959</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.993</td>
<td>0.94</td>
<td>0.921569</td>
<td>0.930693</td>
<td>0.997397</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="abod_linear" class="level2">
<h2 class="anchored" data-anchor-id="abod_linear">ABOD_Linear</h2>
<div id="961235ec-1f2a-4f3d-9888-7a38494e558e" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> ABOD(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>ABOD(contamination=0.05, method='fast', n_neighbors=5)</code></pre>
</div>
</div>
<div id="5de13dba-6740-40cd-a40d-9953fff547ed" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>outlier_ABOD_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="13cad543-a4f1-4648-be40-c40a01fa08e4" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_ABOD_one)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"ABOD (Kriegel et al., 2008)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-63-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.973
Precision: 0.740
Recall: 0.725
F1 Score: 0.733</code></pre>
</div>
</div>
<div id="563db35a-3a0a-4021-9765-88f6516c4d2c" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.973
Precision(TP / TP + FP): 0.740
Recall(TP / TP + FN): 0.725
F1 Score(2*precision*recall/precision+recall): 0.733</code></pre>
</div>
</div>
<div id="293f98c0-d9a9-4ef3-9aad-05cfc0747165" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="08f38d87-4326-4cb2-a8f4-daf2ead209d7" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>0.9902064092233311</code></pre>
</div>
</div>
<div id="ea96bc66-879b-49d6-8422-b7c465df465a" class="cell" data-scrolled="true" data-execution_count="66">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.00</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997366</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.969</td>
<td>0.70</td>
<td>0.686275</td>
<td>0.693069</td>
<td>0.959214</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.923</td>
<td>0.37</td>
<td>0.725490</td>
<td>0.490066</td>
<td>0.864150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.999</td>
<td>1.00</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999959</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.993</td>
<td>0.94</td>
<td>0.921569</td>
<td>0.930693</td>
<td>0.997397</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.973</td>
<td>0.74</td>
<td>0.725490</td>
<td>0.732673</td>
<td>0.990206</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="iforest_linear" class="level2">
<h2 class="anchored" data-anchor-id="iforest_linear">IForest_Linear</h2>
<div id="0f449aac-955a-4721-af5f-28f6be2345bb" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> IForest(contamination<span class="op">=</span><span class="fl">0.05</span>,random_state<span class="op">=</span><span class="dv">77</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>IForest(behaviour='old', bootstrap=False, contamination=0.05,
    max_features=1.0, max_samples='auto', n_estimators=100, n_jobs=1,
    random_state=77, verbose=0)</code></pre>
</div>
</div>
<div id="7fa7310f-ee7b-4391-9e19-fe7a771b9dcb" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>outlier_IForest_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="fba5ffb2-7f00-4dd5-b71e-de81721b6494" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_IForest_one)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"Isolation Forest (Liu et al., 2008)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-70-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.987
Precision: 0.880
Recall: 0.863
F1 Score: 0.871</code></pre>
</div>
</div>
<div id="140ce4e3-9370-4d0e-b2ff-fae8f47e0710" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.987
Precision(TP / TP + FP): 0.880
Recall(TP / TP + FN): 0.863
F1 Score(2*precision*recall/precision+recall): 0.871</code></pre>
</div>
</div>
<div id="abf0d529-ece4-44e2-8e0a-7704c0c0bfcd" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/base.py:457: UserWarning: X has feature names, but IsolationForest was fitted without feature names
  warnings.warn(</code></pre>
</div>
</div>
<div id="b18682e6-129f-4628-a18f-008966741ad8" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>0.9958263600487613</code></pre>
</div>
</div>
<div id="fa2c5449-d3df-41d5-843d-9c8e132d258f" class="cell" data-scrolled="true" data-execution_count="73">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.00</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.92</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997366</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.969</td>
<td>0.70</td>
<td>0.686275</td>
<td>0.693069</td>
<td>0.959214</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.923</td>
<td>0.37</td>
<td>0.725490</td>
<td>0.490066</td>
<td>0.864150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.999</td>
<td>1.00</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999959</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.993</td>
<td>0.94</td>
<td>0.921569</td>
<td>0.930693</td>
<td>0.997397</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.973</td>
<td>0.74</td>
<td>0.725490</td>
<td>0.732673</td>
<td>0.990206</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.987</td>
<td>0.88</td>
<td>0.862745</td>
<td>0.871287</td>
<td>0.995826</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="hbos_linear" class="level2">
<h2 class="anchored" data-anchor-id="hbos_linear">HBOS_Linear</h2>
<div id="7145aea7-ba45-4531-a342-dc1979ecda57" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> HBOS(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>HBOS(alpha=0.1, contamination=0.05, n_bins=10, tol=0.5)</code></pre>
</div>
</div>
<div id="2446b87d-3e8c-40d3-946f-f477b3b76965" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>outlier_HBOS_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="27f2d343-990c-45ea-b62c-c7314b647a96" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_HBOS_one)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"HBOS (Goldstein and Dengel, 2012)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-77-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.972
Precision: 0.926
Recall: 0.490
F1 Score: 0.641</code></pre>
</div>
</div>
<div id="caa03eec-7035-4b78-b781-4d77491feaf7" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.972
Precision(TP / TP + FP): 0.926
Recall(TP / TP + FN): 0.490
F1 Score(2*precision*recall/precision+recall): 0.641</code></pre>
</div>
</div>
<div id="7349aada-fc75-44e3-a2e5-63064275af03" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="25971a48-c02d-4386-bcb4-519d3cbb5a4a" class="cell" data-scrolled="true" data-execution_count="79">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>0.8636438769396062</code></pre>
</div>
</div>
<div id="4eacf5b9-6cb6-4539-b115-5859e11d1259" class="cell" data-scrolled="true" data-execution_count="80">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.000000</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.920000</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.920000</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997366</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.969</td>
<td>0.700000</td>
<td>0.686275</td>
<td>0.693069</td>
<td>0.959214</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.923</td>
<td>0.370000</td>
<td>0.725490</td>
<td>0.490066</td>
<td>0.864150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.999</td>
<td>1.000000</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999959</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.993</td>
<td>0.940000</td>
<td>0.921569</td>
<td>0.930693</td>
<td>0.997397</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.973</td>
<td>0.740000</td>
<td>0.725490</td>
<td>0.732673</td>
<td>0.990206</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.987</td>
<td>0.880000</td>
<td>0.862745</td>
<td>0.871287</td>
<td>0.995826</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.972</td>
<td>0.925926</td>
<td>0.490196</td>
<td>0.641026</td>
<td>0.863644</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="sos_linear" class="level2">
<h2 class="anchored" data-anchor-id="sos_linear">SOS_Linear</h2>
<div id="cc87e357-a413-4fec-87ce-80c1b05a61a0" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SOS(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>SOS(contamination=0.05, eps=1e-05, metric='euclidean', perplexity=4.5)</code></pre>
</div>
</div>
<div id="6a686e94-03fb-4a63-bc8a-663ade53b1c7" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>outlier_SOS_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="5805c0ed-6fe1-44cd-ad59-a8a8ab65b8f0" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_SOS_one)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"SOS (Janssens et al., 2012)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-84-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.907
Precision: 0.080
Recall: 0.078
F1 Score: 0.079</code></pre>
</div>
</div>
<div id="7c2f48fd-c4cb-488c-a883-e6aa74129044" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.907
Precision(TP / TP + FP): 0.080
Recall(TP / TP + FN): 0.078
F1 Score(2*precision*recall/precision+recall): 0.079</code></pre>
</div>
</div>
<div id="8c0e91f2-99da-4c65-bc1d-cdec2c243bcd" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="c5e335de-4331-4f8f-894d-4247206d94df" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>0.5417054071365112</code></pre>
</div>
</div>
<div id="6f6f715e-c8e0-4053-ae80-97d04432a116" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.000000</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.920000</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.920000</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997366</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.969</td>
<td>0.700000</td>
<td>0.686275</td>
<td>0.693069</td>
<td>0.959214</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.923</td>
<td>0.370000</td>
<td>0.725490</td>
<td>0.490066</td>
<td>0.864150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.999</td>
<td>1.000000</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999959</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.993</td>
<td>0.940000</td>
<td>0.921569</td>
<td>0.930693</td>
<td>0.997397</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.973</td>
<td>0.740000</td>
<td>0.725490</td>
<td>0.732673</td>
<td>0.990206</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.987</td>
<td>0.880000</td>
<td>0.862745</td>
<td>0.871287</td>
<td>0.995826</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.972</td>
<td>0.925926</td>
<td>0.490196</td>
<td>0.641026</td>
<td>0.863644</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.907</td>
<td>0.080000</td>
<td>0.078431</td>
<td>0.079208</td>
<td>0.541705</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="so_gaal_linear" class="level2">
<h2 class="anchored" data-anchor-id="so_gaal_linear">SO_GAAL_Linear</h2>
<div id="72e27bb4-844e-42f9-bbfc-11ece0274c30" class="cell" data-scrolled="true" data-execution_count="88">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SO_GAAL(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/keras/src/optimizers/legacy/gradient_descent.py:114: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super().__init__(name, **kwargs)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1 of 60

Testing for epoch 1 index 1:

Testing for epoch 1 index 2:
Epoch 2 of 60

Testing for epoch 2 index 1:

Testing for epoch 2 index 2:
Epoch 3 of 60

Testing for epoch 3 index 1:

Testing for epoch 3 index 2:
Epoch 4 of 60

Testing for epoch 4 index 1:

Testing for epoch 4 index 2:
Epoch 5 of 60

Testing for epoch 5 index 1:

Testing for epoch 5 index 2:
Epoch 6 of 60

Testing for epoch 6 index 1:

Testing for epoch 6 index 2:
Epoch 7 of 60

Testing for epoch 7 index 1:

Testing for epoch 7 index 2:
Epoch 8 of 60

Testing for epoch 8 index 1:

Testing for epoch 8 index 2:
Epoch 9 of 60

Testing for epoch 9 index 1:

Testing for epoch 9 index 2:
Epoch 10 of 60

Testing for epoch 10 index 1:

Testing for epoch 10 index 2:
Epoch 11 of 60

Testing for epoch 11 index 1:

Testing for epoch 11 index 2:
Epoch 12 of 60

Testing for epoch 12 index 1:

Testing for epoch 12 index 2:
Epoch 13 of 60

Testing for epoch 13 index 1:

Testing for epoch 13 index 2:
Epoch 14 of 60

Testing for epoch 14 index 1:

Testing for epoch 14 index 2:
Epoch 15 of 60

Testing for epoch 15 index 1:

Testing for epoch 15 index 2:
Epoch 16 of 60

Testing for epoch 16 index 1:

Testing for epoch 16 index 2:
Epoch 17 of 60

Testing for epoch 17 index 1:

Testing for epoch 17 index 2:
Epoch 18 of 60

Testing for epoch 18 index 1:

Testing for epoch 18 index 2:
Epoch 19 of 60

Testing for epoch 19 index 1:

Testing for epoch 19 index 2:
Epoch 20 of 60

Testing for epoch 20 index 1:

Testing for epoch 20 index 2:
Epoch 21 of 60

Testing for epoch 21 index 1:

Testing for epoch 21 index 2:
Epoch 22 of 60

Testing for epoch 22 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.1165

Testing for epoch 22 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.1189
Epoch 23 of 60

Testing for epoch 23 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.1783

Testing for epoch 23 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.1937
Epoch 24 of 60

Testing for epoch 24 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.2216

Testing for epoch 24 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.2049
Epoch 25 of 60

Testing for epoch 25 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.2399

Testing for epoch 25 index 2:
16/16 [==============================] - 0s 909us/step - loss: 1.2524
Epoch 26 of 60

Testing for epoch 26 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.2894

Testing for epoch 26 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.3202
Epoch 27 of 60

Testing for epoch 27 index 1:
16/16 [==============================] - 0s 811us/step - loss: 1.2910

Testing for epoch 27 index 2:
16/16 [==============================] - 0s 815us/step - loss: 1.3322
Epoch 28 of 60

Testing for epoch 28 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.3269

Testing for epoch 28 index 2:
16/16 [==============================] - 0s 810us/step - loss: 1.3402
Epoch 29 of 60

Testing for epoch 29 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.3536

Testing for epoch 29 index 2:
16/16 [==============================] - 0s 789us/step - loss: 1.4119
Epoch 30 of 60

Testing for epoch 30 index 1:
16/16 [==============================] - 0s 809us/step - loss: 1.4078

Testing for epoch 30 index 2:
16/16 [==============================] - 0s 793us/step - loss: 1.3819
Epoch 31 of 60

Testing for epoch 31 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.4048

Testing for epoch 31 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.4149
Epoch 32 of 60

Testing for epoch 32 index 1:
16/16 [==============================] - 0s 774us/step - loss: 1.4285

Testing for epoch 32 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.4326
Epoch 33 of 60

Testing for epoch 33 index 1:
16/16 [==============================] - 0s 790us/step - loss: 1.4830

Testing for epoch 33 index 2:
16/16 [==============================] - 0s 844us/step - loss: 1.4463
Epoch 34 of 60

Testing for epoch 34 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.4626

Testing for epoch 34 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.4730
Epoch 35 of 60

Testing for epoch 35 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.4690

Testing for epoch 35 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.5170
Epoch 36 of 60

Testing for epoch 36 index 1:
16/16 [==============================] - 0s 841us/step - loss: 1.5280

Testing for epoch 36 index 2:
16/16 [==============================] - 0s 907us/step - loss: 1.5116
Epoch 37 of 60

Testing for epoch 37 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.5294

Testing for epoch 37 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.5397
Epoch 38 of 60

Testing for epoch 38 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.5235

Testing for epoch 38 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.5700
Epoch 39 of 60

Testing for epoch 39 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.5820

Testing for epoch 39 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.5393
Epoch 40 of 60

Testing for epoch 40 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.5693

Testing for epoch 40 index 2:
16/16 [==============================] - 0s 959us/step - loss: 1.5822
Epoch 41 of 60

Testing for epoch 41 index 1:
16/16 [==============================] - 0s 869us/step - loss: 1.6224

Testing for epoch 41 index 2:
16/16 [==============================] - 0s 964us/step - loss: 1.6510
Epoch 42 of 60

Testing for epoch 42 index 1:
16/16 [==============================] - 0s 855us/step - loss: 1.6076

Testing for epoch 42 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.5986
Epoch 43 of 60

Testing for epoch 43 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.6366

Testing for epoch 43 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.6675
Epoch 44 of 60

Testing for epoch 44 index 1:
16/16 [==============================] - 0s 839us/step - loss: 1.6276

Testing for epoch 44 index 2:
16/16 [==============================] - 0s 942us/step - loss: 1.6894
Epoch 45 of 60

Testing for epoch 45 index 1:
16/16 [==============================] - 0s 779us/step - loss: 1.7096

Testing for epoch 45 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.7009
Epoch 46 of 60

Testing for epoch 46 index 1:
16/16 [==============================] - 0s 950us/step - loss: 1.7469

Testing for epoch 46 index 2:
16/16 [==============================] - 0s 802us/step - loss: 1.7162
Epoch 47 of 60

Testing for epoch 47 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.6864

Testing for epoch 47 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.7342
Epoch 48 of 60

Testing for epoch 48 index 1:
16/16 [==============================] - 0s 850us/step - loss: 1.7271

Testing for epoch 48 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.8060
Epoch 49 of 60

Testing for epoch 49 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.7241

Testing for epoch 49 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.8112
Epoch 50 of 60

Testing for epoch 50 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.7575

Testing for epoch 50 index 2:
16/16 [==============================] - 0s 797us/step - loss: 1.7625
Epoch 51 of 60

Testing for epoch 51 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.7826

Testing for epoch 51 index 2:
16/16 [==============================] - 0s 852us/step - loss: 1.7773
Epoch 52 of 60

Testing for epoch 52 index 1:
16/16 [==============================] - 0s 845us/step - loss: 1.7978

Testing for epoch 52 index 2:
16/16 [==============================] - 0s 948us/step - loss: 1.8201
Epoch 53 of 60

Testing for epoch 53 index 1:
16/16 [==============================] - 0s 996us/step - loss: 1.8171

Testing for epoch 53 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.8348
Epoch 54 of 60

Testing for epoch 54 index 1:
16/16 [==============================] - 0s 788us/step - loss: 1.8149

Testing for epoch 54 index 2:
16/16 [==============================] - 0s 795us/step - loss: 1.8123
Epoch 55 of 60

Testing for epoch 55 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.8203

Testing for epoch 55 index 2:
16/16 [==============================] - 0s 759us/step - loss: 1.8700
Epoch 56 of 60

Testing for epoch 56 index 1:
16/16 [==============================] - 0s 822us/step - loss: 1.8608

Testing for epoch 56 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.8683
Epoch 57 of 60

Testing for epoch 57 index 1:
16/16 [==============================] - 0s 810us/step - loss: 1.9068

Testing for epoch 57 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.9222
Epoch 58 of 60

Testing for epoch 58 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.8711

Testing for epoch 58 index 2:
16/16 [==============================] - 0s 995us/step - loss: 1.8794
Epoch 59 of 60

Testing for epoch 59 index 1:
16/16 [==============================] - 0s 784us/step - loss: 1.9300

Testing for epoch 59 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.8748
Epoch 60 of 60

Testing for epoch 60 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.9501

Testing for epoch 60 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.9530
32/32 [==============================] - 0s 1ms/step</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>SO_GAAL(contamination=0.05, lr_d=0.01, lr_g=0.0001, momentum=0.9,
    stop_epochs=20)</code></pre>
</div>
</div>
<div id="28e8511b-8ea2-4ef6-8c1b-497844347714" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>outlier_SO_GAAL_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="acdc3781-c287-4c6b-afb5-e36952977732" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_SO_GAAL_one)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"SO-GAAL (Liu et al., 2019)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-91-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.946
Precision: 0.468
Recall: 0.431
F1 Score: 0.449</code></pre>
</div>
</div>
<div id="cc7ba227-2367-4961-a49f-fcac9f28f2f2" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.946
Precision(TP / TP + FP): 0.468
Recall(TP / TP + FN): 0.431
F1 Score(2*precision*recall/precision+recall): 0.449</code></pre>
</div>
</div>
<div id="09974a54-b4e0-4cd6-b196-06ca05f442eb" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 0s 823us/step</code></pre>
</div>
</div>
<div id="1e78caae-7a18-4627-aa05-8d4c9f8f91f2" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>0.575208165457964</code></pre>
</div>
</div>
<div id="68c74bd6-a2b8-4a98-b521-6ffaaca4d8c9" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.000000</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.920000</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.920000</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997366</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.969</td>
<td>0.700000</td>
<td>0.686275</td>
<td>0.693069</td>
<td>0.959214</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.923</td>
<td>0.370000</td>
<td>0.725490</td>
<td>0.490066</td>
<td>0.864150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.999</td>
<td>1.000000</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999959</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.993</td>
<td>0.940000</td>
<td>0.921569</td>
<td>0.930693</td>
<td>0.997397</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.973</td>
<td>0.740000</td>
<td>0.725490</td>
<td>0.732673</td>
<td>0.990206</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.987</td>
<td>0.880000</td>
<td>0.862745</td>
<td>0.871287</td>
<td>0.995826</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.972</td>
<td>0.925926</td>
<td>0.490196</td>
<td>0.641026</td>
<td>0.863644</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.907</td>
<td>0.080000</td>
<td>0.078431</td>
<td>0.079208</td>
<td>0.541705</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SO-GAAL (Liu et al., 2019)</td>
<td>0.946</td>
<td>0.468085</td>
<td>0.431373</td>
<td>0.448980</td>
<td>0.575208</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="mo_gaal_linear" class="level2">
<h2 class="anchored" data-anchor-id="mo_gaal_linear">MO_GAAL_Linear</h2>
<div id="71f515f4-69d4-4d8d-897a-6dd8eb563a4f" class="cell" data-scrolled="true" data-execution_count="95">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> MO_GAAL(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/keras/src/optimizers/legacy/gradient_descent.py:114: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super().__init__(name, **kwargs)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1 of 60

Testing for epoch 1 index 1:
WARNING:tensorflow:5 out of the last 74 calls to &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x7fd6d0525000&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:5 out of the last 12 calls to &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x7fd7f68d8e50&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
32/32 [==============================] - 0s 1ms/step
WARNING:tensorflow:5 out of the last 165 calls to &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x7fd6d014c0d0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:6 out of the last 166 calls to &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x7fd7ee5e8c10&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.

Testing for epoch 1 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 2 of 60

Testing for epoch 2 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 2 index 2:
32/32 [==============================] - 0s 799us/step
Epoch 3 of 60

Testing for epoch 3 index 1:
32/32 [==============================] - 0s 590us/step

Testing for epoch 3 index 2:
32/32 [==============================] - 0s 799us/step
Epoch 4 of 60

Testing for epoch 4 index 1:
32/32 [==============================] - 0s 576us/step

Testing for epoch 4 index 2:
32/32 [==============================] - 0s 574us/step
Epoch 5 of 60

Testing for epoch 5 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 5 index 2:
32/32 [==============================] - 0s 588us/step
Epoch 6 of 60

Testing for epoch 6 index 1:
32/32 [==============================] - 0s 590us/step

Testing for epoch 6 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 7 of 60

Testing for epoch 7 index 1:
32/32 [==============================] - 0s 773us/step

Testing for epoch 7 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 8 of 60

Testing for epoch 8 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 8 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 9 of 60

Testing for epoch 9 index 1:
32/32 [==============================] - 0s 599us/step

Testing for epoch 9 index 2:
32/32 [==============================] - 0s 571us/step
Epoch 10 of 60

Testing for epoch 10 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 10 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 11 of 60

Testing for epoch 11 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 11 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 12 of 60

Testing for epoch 12 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 12 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 13 of 60

Testing for epoch 13 index 1:
32/32 [==============================] - 0s 977us/step

Testing for epoch 13 index 2:
32/32 [==============================] - 0s 577us/step
Epoch 14 of 60

Testing for epoch 14 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 14 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 15 of 60

Testing for epoch 15 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 15 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 16 of 60

Testing for epoch 16 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 16 index 2:
32/32 [==============================] - 0s 577us/step
Epoch 17 of 60

Testing for epoch 17 index 1:
32/32 [==============================] - 0s 570us/step

Testing for epoch 17 index 2:
32/32 [==============================] - 0s 564us/step
Epoch 18 of 60

Testing for epoch 18 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 18 index 2:
32/32 [==============================] - 0s 737us/step
Epoch 19 of 60

Testing for epoch 19 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 19 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 20 of 60

Testing for epoch 20 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 20 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 21 of 60

Testing for epoch 21 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 21 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.4345
16/16 [==============================] - 0s 2ms/step - loss: 0.7133
16/16 [==============================] - 0s 2ms/step - loss: 0.9237
16/16 [==============================] - 0s 992us/step - loss: 1.0992
16/16 [==============================] - 0s 2ms/step - loss: 1.2285
16/16 [==============================] - 0s 2ms/step - loss: 1.2994
16/16 [==============================] - 0s 2ms/step - loss: 1.3332
16/16 [==============================] - 0s 2ms/step - loss: 1.3530
16/16 [==============================] - 0s 2ms/step - loss: 1.3618
16/16 [==============================] - 0s 844us/step - loss: 1.3663
Epoch 22 of 60

Testing for epoch 22 index 1:
32/32 [==============================] - 0s 566us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.4261
16/16 [==============================] - 0s 2ms/step - loss: 0.7204
16/16 [==============================] - 0s 2ms/step - loss: 0.9432
16/16 [==============================] - 0s 990us/step - loss: 1.1288
16/16 [==============================] - 0s 1ms/step - loss: 1.2626
16/16 [==============================] - 0s 2ms/step - loss: 1.3345
16/16 [==============================] - 0s 2ms/step - loss: 1.3678
16/16 [==============================] - 0s 1ms/step - loss: 1.3869
16/16 [==============================] - 0s 2ms/step - loss: 1.3953
16/16 [==============================] - 0s 2ms/step - loss: 1.3994

Testing for epoch 22 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 834us/step - loss: 0.4211
16/16 [==============================] - 0s 2ms/step - loss: 0.7245
16/16 [==============================] - 0s 1ms/step - loss: 0.9541
16/16 [==============================] - 0s 863us/step - loss: 1.1454
16/16 [==============================] - 0s 2ms/step - loss: 1.2804
16/16 [==============================] - 0s 868us/step - loss: 1.3515
16/16 [==============================] - 0s 2ms/step - loss: 1.3836
16/16 [==============================] - 0s 876us/step - loss: 1.4016
16/16 [==============================] - 0s 1ms/step - loss: 1.4093
16/16 [==============================] - 0s 901us/step - loss: 1.4131
Epoch 23 of 60

Testing for epoch 23 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.4209
16/16 [==============================] - 0s 2ms/step - loss: 0.7261
16/16 [==============================] - 0s 2ms/step - loss: 0.9649
16/16 [==============================] - 0s 2ms/step - loss: 1.1574
16/16 [==============================] - 0s 1ms/step - loss: 1.2891
16/16 [==============================] - 0s 2ms/step - loss: 1.3559
16/16 [==============================] - 0s 2ms/step - loss: 1.3848
16/16 [==============================] - 0s 868us/step - loss: 1.4003
16/16 [==============================] - 0s 826us/step - loss: 1.4068
16/16 [==============================] - 0s 850us/step - loss: 1.4100

Testing for epoch 23 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.4184
16/16 [==============================] - 0s 2ms/step - loss: 0.7292
16/16 [==============================] - 0s 2ms/step - loss: 0.9809
16/16 [==============================] - 0s 875us/step - loss: 1.1760
16/16 [==============================] - 0s 1ms/step - loss: 1.3069
16/16 [==============================] - 0s 2ms/step - loss: 1.3704
16/16 [==============================] - 0s 1ms/step - loss: 1.3970
16/16 [==============================] - 0s 947us/step - loss: 1.4107
16/16 [==============================] - 0s 2ms/step - loss: 1.4164
16/16 [==============================] - 0s 2ms/step - loss: 1.4191
Epoch 24 of 60

Testing for epoch 24 index 1:
32/32 [==============================] - 0s 575us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.4212
16/16 [==============================] - 0s 1ms/step - loss: 0.7335
16/16 [==============================] - 0s 2ms/step - loss: 0.9945
16/16 [==============================] - 0s 2ms/step - loss: 1.1886
16/16 [==============================] - 0s 988us/step - loss: 1.3164
16/16 [==============================] - 0s 2ms/step - loss: 1.3739
16/16 [==============================] - 0s 1ms/step - loss: 1.3967
16/16 [==============================] - 0s 2ms/step - loss: 1.4083
16/16 [==============================] - 0s 894us/step - loss: 1.4130
16/16 [==============================] - 0s 847us/step - loss: 1.4152

Testing for epoch 24 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.4112
16/16 [==============================] - 0s 826us/step - loss: 0.7397
16/16 [==============================] - 0s 2ms/step - loss: 1.0222
16/16 [==============================] - 0s 2ms/step - loss: 1.2268
16/16 [==============================] - 0s 2ms/step - loss: 1.3574
16/16 [==============================] - 0s 2ms/step - loss: 1.4137
16/16 [==============================] - 0s 914us/step - loss: 1.4346
16/16 [==============================] - 0s 1ms/step - loss: 1.4449
16/16 [==============================] - 0s 837us/step - loss: 1.4490
16/16 [==============================] - 0s 1ms/step - loss: 1.4509
Epoch 25 of 60

Testing for epoch 25 index 1:
32/32 [==============================] - 0s 690us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.4111
16/16 [==============================] - 0s 2ms/step - loss: 0.7434
16/16 [==============================] - 0s 2ms/step - loss: 1.0359
16/16 [==============================] - 0s 923us/step - loss: 1.2430
16/16 [==============================] - 0s 2ms/step - loss: 1.3672
16/16 [==============================] - 0s 2ms/step - loss: 1.4166
16/16 [==============================] - 0s 2ms/step - loss: 1.4345
16/16 [==============================] - 0s 836us/step - loss: 1.4430
16/16 [==============================] - 0s 2ms/step - loss: 1.4463
16/16 [==============================] - 0s 813us/step - loss: 1.4479

Testing for epoch 25 index 2:
32/32 [==============================] - 0s 578us/step
16/16 [==============================] - 0s 794us/step - loss: 0.4204
16/16 [==============================] - 0s 786us/step - loss: 0.7453
16/16 [==============================] - 0s 2ms/step - loss: 1.0374
16/16 [==============================] - 0s 2ms/step - loss: 1.2369
16/16 [==============================] - 0s 802us/step - loss: 1.3520
16/16 [==============================] - 0s 772us/step - loss: 1.3951
16/16 [==============================] - 0s 774us/step - loss: 1.4104
16/16 [==============================] - 0s 1ms/step - loss: 1.4173
16/16 [==============================] - 0s 805us/step - loss: 1.4201
16/16 [==============================] - 0s 868us/step - loss: 1.4214
Epoch 26 of 60

Testing for epoch 26 index 1:
32/32 [==============================] - 0s 566us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.4233
16/16 [==============================] - 0s 2ms/step - loss: 0.7493
16/16 [==============================] - 0s 2ms/step - loss: 1.0474
16/16 [==============================] - 0s 1ms/step - loss: 1.2468
16/16 [==============================] - 0s 1ms/step - loss: 1.3530
16/16 [==============================] - 0s 2ms/step - loss: 1.3921
16/16 [==============================] - 0s 839us/step - loss: 1.4053
16/16 [==============================] - 0s 2ms/step - loss: 1.4109
16/16 [==============================] - 0s 885us/step - loss: 1.4132
16/16 [==============================] - 0s 911us/step - loss: 1.4143

Testing for epoch 26 index 2:
32/32 [==============================] - 0s 569us/step
16/16 [==============================] - 0s 776us/step - loss: 0.4195
16/16 [==============================] - 0s 772us/step - loss: 0.7540
16/16 [==============================] - 0s 795us/step - loss: 1.0687
16/16 [==============================] - 0s 790us/step - loss: 1.2702
16/16 [==============================] - 0s 816us/step - loss: 1.3736
16/16 [==============================] - 0s 778us/step - loss: 1.4104
16/16 [==============================] - 0s 798us/step - loss: 1.4223
16/16 [==============================] - 0s 792us/step - loss: 1.4272
16/16 [==============================] - 0s 761us/step - loss: 1.4291
16/16 [==============================] - 0s 793us/step - loss: 1.4301
Epoch 27 of 60

Testing for epoch 27 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 781us/step - loss: 0.4196
16/16 [==============================] - 0s 807us/step - loss: 0.7599
16/16 [==============================] - 0s 781us/step - loss: 1.0875
16/16 [==============================] - 0s 775us/step - loss: 1.2839
16/16 [==============================] - 0s 785us/step - loss: 1.3836
16/16 [==============================] - 0s 2ms/step - loss: 1.4168
16/16 [==============================] - 0s 2ms/step - loss: 1.4273
16/16 [==============================] - 0s 877us/step - loss: 1.4314
16/16 [==============================] - 0s 824us/step - loss: 1.4330
16/16 [==============================] - 0s 785us/step - loss: 1.4339

Testing for epoch 27 index 2:
32/32 [==============================] - 0s 565us/step
16/16 [==============================] - 0s 779us/step - loss: 0.4253
16/16 [==============================] - 0s 781us/step - loss: 0.7594
16/16 [==============================] - 0s 776us/step - loss: 1.0874
16/16 [==============================] - 0s 2ms/step - loss: 1.2752
16/16 [==============================] - 0s 798us/step - loss: 1.3672
16/16 [==============================] - 0s 1ms/step - loss: 1.3966
16/16 [==============================] - 0s 2ms/step - loss: 1.4057
16/16 [==============================] - 0s 1ms/step - loss: 1.4092
16/16 [==============================] - 0s 2ms/step - loss: 1.4106
16/16 [==============================] - 0s 2ms/step - loss: 1.4114
Epoch 28 of 60

Testing for epoch 28 index 1:
32/32 [==============================] - 0s 556us/step
16/16 [==============================] - 0s 788us/step - loss: 0.4191
16/16 [==============================] - 0s 797us/step - loss: 0.7672
16/16 [==============================] - 0s 802us/step - loss: 1.1148
16/16 [==============================] - 0s 825us/step - loss: 1.3046
16/16 [==============================] - 0s 2ms/step - loss: 1.3941
16/16 [==============================] - 0s 834us/step - loss: 1.4213
16/16 [==============================] - 0s 802us/step - loss: 1.4294
16/16 [==============================] - 0s 2ms/step - loss: 1.4325
16/16 [==============================] - 0s 2ms/step - loss: 1.4337
16/16 [==============================] - 0s 806us/step - loss: 1.4345

Testing for epoch 28 index 2:
32/32 [==============================] - 0s 577us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.4230
16/16 [==============================] - 0s 1ms/step - loss: 0.7713
16/16 [==============================] - 0s 799us/step - loss: 1.1226
16/16 [==============================] - 0s 787us/step - loss: 1.3086
16/16 [==============================] - 0s 778us/step - loss: 1.3931
16/16 [==============================] - 0s 802us/step - loss: 1.4179
16/16 [==============================] - 0s 788us/step - loss: 1.4251
16/16 [==============================] - 0s 2ms/step - loss: 1.4278
16/16 [==============================] - 0s 834us/step - loss: 1.4288
16/16 [==============================] - 0s 788us/step - loss: 1.4296
Epoch 29 of 60

Testing for epoch 29 index 1:
32/32 [==============================] - 0s 661us/step
16/16 [==============================] - 0s 822us/step - loss: 0.4148
16/16 [==============================] - 0s 789us/step - loss: 0.7758
16/16 [==============================] - 0s 1ms/step - loss: 1.1424
16/16 [==============================] - 0s 793us/step - loss: 1.3333
16/16 [==============================] - 0s 774us/step - loss: 1.4154
16/16 [==============================] - 0s 842us/step - loss: 1.4387
16/16 [==============================] - 0s 2ms/step - loss: 1.4453
16/16 [==============================] - 0s 1ms/step - loss: 1.4477
16/16 [==============================] - 0s 2ms/step - loss: 1.4486
16/16 [==============================] - 0s 2ms/step - loss: 1.4493

Testing for epoch 29 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.4225
16/16 [==============================] - 0s 2ms/step - loss: 0.7755
16/16 [==============================] - 0s 1ms/step - loss: 1.1337
16/16 [==============================] - 0s 871us/step - loss: 1.3172
16/16 [==============================] - 0s 793us/step - loss: 1.3930
16/16 [==============================] - 0s 779us/step - loss: 1.4138
16/16 [==============================] - 0s 777us/step - loss: 1.4195
16/16 [==============================] - 0s 2ms/step - loss: 1.4217
16/16 [==============================] - 0s 837us/step - loss: 1.4225
16/16 [==============================] - 0s 2ms/step - loss: 1.4232
Epoch 30 of 60

Testing for epoch 30 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.4221
16/16 [==============================] - 0s 2ms/step - loss: 0.7804
16/16 [==============================] - 0s 2ms/step - loss: 1.1445
16/16 [==============================] - 0s 1ms/step - loss: 1.3280
16/16 [==============================] - 0s 2ms/step - loss: 1.4003
16/16 [==============================] - 0s 2ms/step - loss: 1.4195
16/16 [==============================] - 0s 2ms/step - loss: 1.4246
16/16 [==============================] - 0s 2ms/step - loss: 1.4266
16/16 [==============================] - 0s 2ms/step - loss: 1.4274
16/16 [==============================] - 0s 837us/step - loss: 1.4281

Testing for epoch 30 index 2:
32/32 [==============================] - 0s 555us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.4129
16/16 [==============================] - 0s 1ms/step - loss: 0.7881
16/16 [==============================] - 0s 2ms/step - loss: 1.1734
16/16 [==============================] - 0s 2ms/step - loss: 1.3635
16/16 [==============================] - 0s 1ms/step - loss: 1.4366
16/16 [==============================] - 0s 2ms/step - loss: 1.4555
16/16 [==============================] - 0s 2ms/step - loss: 1.4605
16/16 [==============================] - 0s 2ms/step - loss: 1.4623
16/16 [==============================] - 0s 1ms/step - loss: 1.4630
16/16 [==============================] - 0s 1ms/step - loss: 1.4637
Epoch 31 of 60

Testing for epoch 31 index 1:
32/32 [==============================] - 0s 604us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.4140
16/16 [==============================] - 0s 998us/step - loss: 0.7917
16/16 [==============================] - 0s 2ms/step - loss: 1.1828
16/16 [==============================] - 0s 1ms/step - loss: 1.3694
16/16 [==============================] - 0s 1ms/step - loss: 1.4394
16/16 [==============================] - 0s 823us/step - loss: 1.4570
16/16 [==============================] - 0s 2ms/step - loss: 1.4615
16/16 [==============================] - 0s 2ms/step - loss: 1.4631
16/16 [==============================] - 0s 825us/step - loss: 1.4638
16/16 [==============================] - 0s 2ms/step - loss: 1.4645

Testing for epoch 31 index 2:
32/32 [==============================] - 0s 568us/step
16/16 [==============================] - 0s 797us/step - loss: 0.4160
16/16 [==============================] - 0s 2ms/step - loss: 0.7876
16/16 [==============================] - 0s 2ms/step - loss: 1.1724
16/16 [==============================] - 0s 2ms/step - loss: 1.3533
16/16 [==============================] - 0s 864us/step - loss: 1.4196
16/16 [==============================] - 0s 968us/step - loss: 1.4358
16/16 [==============================] - 0s 2ms/step - loss: 1.4400
16/16 [==============================] - 0s 873us/step - loss: 1.4415
16/16 [==============================] - 0s 791us/step - loss: 1.4422
16/16 [==============================] - 0s 794us/step - loss: 1.4428
Epoch 32 of 60

Testing for epoch 32 index 1:
32/32 [==============================] - 0s 583us/step
16/16 [==============================] - 0s 788us/step - loss: 0.4174
16/16 [==============================] - 0s 2ms/step - loss: 0.7933
16/16 [==============================] - 0s 2ms/step - loss: 1.1831
16/16 [==============================] - 0s 2ms/step - loss: 1.3641
16/16 [==============================] - 0s 862us/step - loss: 1.4285
16/16 [==============================] - 0s 770us/step - loss: 1.4438
16/16 [==============================] - 0s 794us/step - loss: 1.4477
16/16 [==============================] - 0s 754us/step - loss: 1.4491
16/16 [==============================] - 0s 2ms/step - loss: 1.4497
16/16 [==============================] - 0s 785us/step - loss: 1.4504

Testing for epoch 32 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 782us/step - loss: 0.4087
16/16 [==============================] - 0s 2ms/step - loss: 0.7935
16/16 [==============================] - 0s 964us/step - loss: 1.1935
16/16 [==============================] - 0s 2ms/step - loss: 1.3777
16/16 [==============================] - 0s 831us/step - loss: 1.4420
16/16 [==============================] - 0s 2ms/step - loss: 1.4570
16/16 [==============================] - 0s 1ms/step - loss: 1.4608
16/16 [==============================] - 0s 2ms/step - loss: 1.4621
16/16 [==============================] - 0s 930us/step - loss: 1.4628
16/16 [==============================] - 0s 1ms/step - loss: 1.4635
Epoch 33 of 60

Testing for epoch 33 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 841us/step - loss: 0.4160
16/16 [==============================] - 0s 2ms/step - loss: 0.7925
16/16 [==============================] - 0s 2ms/step - loss: 1.1814
16/16 [==============================] - 0s 2ms/step - loss: 1.3582
16/16 [==============================] - 0s 1ms/step - loss: 1.4186
16/16 [==============================] - 0s 2ms/step - loss: 1.4324
16/16 [==============================] - 0s 853us/step - loss: 1.4358
16/16 [==============================] - 0s 786us/step - loss: 1.4370
16/16 [==============================] - 0s 788us/step - loss: 1.4377
16/16 [==============================] - 0s 798us/step - loss: 1.4384

Testing for epoch 33 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 872us/step - loss: 0.4056
16/16 [==============================] - 0s 2ms/step - loss: 0.8016
16/16 [==============================] - 0s 800us/step - loss: 1.2083
16/16 [==============================] - 0s 2ms/step - loss: 1.3936
16/16 [==============================] - 0s 1ms/step - loss: 1.4561
16/16 [==============================] - 0s 2ms/step - loss: 1.4702
16/16 [==============================] - 0s 801us/step - loss: 1.4736
16/16 [==============================] - 0s 2ms/step - loss: 1.4749
16/16 [==============================] - 0s 817us/step - loss: 1.4755
16/16 [==============================] - 0s 2ms/step - loss: 1.4762
Epoch 34 of 60

Testing for epoch 34 index 1:
32/32 [==============================] - 0s 563us/step
16/16 [==============================] - 0s 802us/step - loss: 0.3972
16/16 [==============================] - 0s 813us/step - loss: 0.8100
16/16 [==============================] - 0s 793us/step - loss: 1.2301
16/16 [==============================] - 0s 2ms/step - loss: 1.4208
16/16 [==============================] - 0s 806us/step - loss: 1.4840
16/16 [==============================] - 0s 1ms/step - loss: 1.4980
16/16 [==============================] - 0s 765us/step - loss: 1.5014
16/16 [==============================] - 0s 786us/step - loss: 1.5026
16/16 [==============================] - 0s 775us/step - loss: 1.5032
16/16 [==============================] - 0s 1ms/step - loss: 1.5039

Testing for epoch 34 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.3993
16/16 [==============================] - 0s 2ms/step - loss: 0.8090
16/16 [==============================] - 0s 865us/step - loss: 1.2207
16/16 [==============================] - 0s 846us/step - loss: 1.4083
16/16 [==============================] - 0s 837us/step - loss: 1.4698
16/16 [==============================] - 0s 2ms/step - loss: 1.4832
16/16 [==============================] - 0s 816us/step - loss: 1.4864
16/16 [==============================] - 0s 2ms/step - loss: 1.4876
16/16 [==============================] - 0s 915us/step - loss: 1.4882
16/16 [==============================] - 0s 844us/step - loss: 1.4889
Epoch 35 of 60

Testing for epoch 35 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 858us/step - loss: 0.3885
16/16 [==============================] - 0s 2ms/step - loss: 0.8232
16/16 [==============================] - 0s 2ms/step - loss: 1.2556
16/16 [==============================] - 0s 801us/step - loss: 1.4530
16/16 [==============================] - 0s 2ms/step - loss: 1.5168
16/16 [==============================] - 0s 2ms/step - loss: 1.5306
16/16 [==============================] - 0s 2ms/step - loss: 1.5339
16/16 [==============================] - 0s 806us/step - loss: 1.5350
16/16 [==============================] - 0s 905us/step - loss: 1.5356
16/16 [==============================] - 0s 2ms/step - loss: 1.5363

Testing for epoch 35 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 885us/step - loss: 0.3917
16/16 [==============================] - 0s 815us/step - loss: 0.8212
16/16 [==============================] - 0s 822us/step - loss: 1.2414
16/16 [==============================] - 0s 921us/step - loss: 1.4339
16/16 [==============================] - 0s 933us/step - loss: 1.4957
16/16 [==============================] - 0s 841us/step - loss: 1.5090
16/16 [==============================] - 0s 799us/step - loss: 1.5121
16/16 [==============================] - 0s 786us/step - loss: 1.5132
16/16 [==============================] - 0s 1ms/step - loss: 1.5138
16/16 [==============================] - 0s 801us/step - loss: 1.5145
Epoch 36 of 60

Testing for epoch 36 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.3811
16/16 [==============================] - 0s 1ms/step - loss: 0.8277
16/16 [==============================] - 0s 2ms/step - loss: 1.2615
16/16 [==============================] - 0s 814us/step - loss: 1.4581
16/16 [==============================] - 0s 886us/step - loss: 1.5210
16/16 [==============================] - 0s 777us/step - loss: 1.5343
16/16 [==============================] - 0s 792us/step - loss: 1.5374
16/16 [==============================] - 0s 760us/step - loss: 1.5385
16/16 [==============================] - 0s 785us/step - loss: 1.5391
16/16 [==============================] - 0s 775us/step - loss: 1.5398

Testing for epoch 36 index 2:
32/32 [==============================] - 0s 574us/step
16/16 [==============================] - 0s 766us/step - loss: 0.3871
16/16 [==============================] - 0s 794us/step - loss: 0.8338
16/16 [==============================] - 0s 928us/step - loss: 1.2599
16/16 [==============================] - 0s 1ms/step - loss: 1.4551
16/16 [==============================] - 0s 1ms/step - loss: 1.5166
16/16 [==============================] - 0s 2ms/step - loss: 1.5297
16/16 [==============================] - 0s 2ms/step - loss: 1.5327
16/16 [==============================] - 0s 794us/step - loss: 1.5338
16/16 [==============================] - 0s 838us/step - loss: 1.5344
16/16 [==============================] - 0s 2ms/step - loss: 1.5351
Epoch 37 of 60

Testing for epoch 37 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 807us/step - loss: 0.3797
16/16 [==============================] - 0s 812us/step - loss: 0.8402
16/16 [==============================] - 0s 778us/step - loss: 1.2755
16/16 [==============================] - 0s 789us/step - loss: 1.4745
16/16 [==============================] - 0s 800us/step - loss: 1.5370
16/16 [==============================] - 0s 798us/step - loss: 1.5501
16/16 [==============================] - 0s 795us/step - loss: 1.5531
16/16 [==============================] - 0s 785us/step - loss: 1.5542
16/16 [==============================] - 0s 767us/step - loss: 1.5548
16/16 [==============================] - 0s 864us/step - loss: 1.5555

Testing for epoch 37 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 839us/step - loss: 0.3801
16/16 [==============================] - 0s 786us/step - loss: 0.8431
16/16 [==============================] - 0s 774us/step - loss: 1.2754
16/16 [==============================] - 0s 793us/step - loss: 1.4705
16/16 [==============================] - 0s 790us/step - loss: 1.5327
16/16 [==============================] - 0s 2ms/step - loss: 1.5457
16/16 [==============================] - 0s 2ms/step - loss: 1.5487
16/16 [==============================] - 0s 2ms/step - loss: 1.5497
16/16 [==============================] - 0s 979us/step - loss: 1.5504
16/16 [==============================] - 0s 906us/step - loss: 1.5511
Epoch 38 of 60

Testing for epoch 38 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 799us/step - loss: 0.3624
16/16 [==============================] - 0s 776us/step - loss: 0.8601
16/16 [==============================] - 0s 2ms/step - loss: 1.3194
16/16 [==============================] - 0s 2ms/step - loss: 1.5287
16/16 [==============================] - 0s 1ms/step - loss: 1.5949
16/16 [==============================] - 0s 2ms/step - loss: 1.6086
16/16 [==============================] - 0s 1ms/step - loss: 1.6117
16/16 [==============================] - 0s 2ms/step - loss: 1.6128
16/16 [==============================] - 0s 877us/step - loss: 1.6134
16/16 [==============================] - 0s 847us/step - loss: 1.6141

Testing for epoch 38 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 847us/step - loss: 0.3678
16/16 [==============================] - 0s 793us/step - loss: 0.8486
16/16 [==============================] - 0s 839us/step - loss: 1.2889
16/16 [==============================] - 0s 898us/step - loss: 1.4911
16/16 [==============================] - 0s 2ms/step - loss: 1.5547
16/16 [==============================] - 0s 1ms/step - loss: 1.5678
16/16 [==============================] - 0s 2ms/step - loss: 1.5708
16/16 [==============================] - 0s 2ms/step - loss: 1.5719
16/16 [==============================] - 0s 2ms/step - loss: 1.5725
16/16 [==============================] - 0s 944us/step - loss: 1.5733
Epoch 39 of 60

Testing for epoch 39 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 829us/step - loss: 0.3676
16/16 [==============================] - 0s 2ms/step - loss: 0.8484
16/16 [==============================] - 0s 2ms/step - loss: 1.2921
16/16 [==============================] - 0s 2ms/step - loss: 1.4923
16/16 [==============================] - 0s 908us/step - loss: 1.5556
16/16 [==============================] - 0s 952us/step - loss: 1.5685
16/16 [==============================] - 0s 1ms/step - loss: 1.5714
16/16 [==============================] - 0s 862us/step - loss: 1.5725
16/16 [==============================] - 0s 811us/step - loss: 1.5731
16/16 [==============================] - 0s 1ms/step - loss: 1.5739

Testing for epoch 39 index 2:
32/32 [==============================] - 0s 568us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.3635
16/16 [==============================] - 0s 2ms/step - loss: 0.8481
16/16 [==============================] - 0s 2ms/step - loss: 1.2943
16/16 [==============================] - 0s 2ms/step - loss: 1.4972
16/16 [==============================] - 0s 921us/step - loss: 1.5612
16/16 [==============================] - 0s 1ms/step - loss: 1.5742
16/16 [==============================] - 0s 2ms/step - loss: 1.5772
16/16 [==============================] - 0s 873us/step - loss: 1.5782
16/16 [==============================] - 0s 2ms/step - loss: 1.5789
16/16 [==============================] - 0s 815us/step - loss: 1.5796
Epoch 40 of 60

Testing for epoch 40 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 799us/step - loss: 0.3622
16/16 [==============================] - 0s 2ms/step - loss: 0.8582
16/16 [==============================] - 0s 2ms/step - loss: 1.3106
16/16 [==============================] - 0s 2ms/step - loss: 1.5171
16/16 [==============================] - 0s 830us/step - loss: 1.5820
16/16 [==============================] - 0s 2ms/step - loss: 1.5952
16/16 [==============================] - 0s 1ms/step - loss: 1.5981
16/16 [==============================] - 0s 2ms/step - loss: 1.5991
16/16 [==============================] - 0s 817us/step - loss: 1.5997
16/16 [==============================] - 0s 769us/step - loss: 1.6004

Testing for epoch 40 index 2:
32/32 [==============================] - 0s 785us/step
16/16 [==============================] - 0s 804us/step - loss: 0.3578
16/16 [==============================] - 0s 2ms/step - loss: 0.8585
16/16 [==============================] - 0s 2ms/step - loss: 1.3090
16/16 [==============================] - 0s 869us/step - loss: 1.5148
16/16 [==============================] - 0s 826us/step - loss: 1.5799
16/16 [==============================] - 0s 2ms/step - loss: 1.5931
16/16 [==============================] - 0s 2ms/step - loss: 1.5960
16/16 [==============================] - 0s 887us/step - loss: 1.5971
16/16 [==============================] - 0s 2ms/step - loss: 1.5977
16/16 [==============================] - 0s 929us/step - loss: 1.5985
Epoch 41 of 60

Testing for epoch 41 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.3466
16/16 [==============================] - 0s 2ms/step - loss: 0.8702
16/16 [==============================] - 0s 868us/step - loss: 1.3373
16/16 [==============================] - 0s 2ms/step - loss: 1.5541
16/16 [==============================] - 0s 2ms/step - loss: 1.6203
16/16 [==============================] - 0s 874us/step - loss: 1.6339
16/16 [==============================] - 0s 2ms/step - loss: 1.6369
16/16 [==============================] - 0s 1ms/step - loss: 1.6380
16/16 [==============================] - 0s 2ms/step - loss: 1.6386
16/16 [==============================] - 0s 891us/step - loss: 1.6393

Testing for epoch 41 index 2:
32/32 [==============================] - 0s 571us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.3596
16/16 [==============================] - 0s 2ms/step - loss: 0.8626
16/16 [==============================] - 0s 2ms/step - loss: 1.3030
16/16 [==============================] - 0s 839us/step - loss: 1.5093
16/16 [==============================] - 0s 834us/step - loss: 1.5721
16/16 [==============================] - 0s 773us/step - loss: 1.5851
16/16 [==============================] - 0s 805us/step - loss: 1.5879
16/16 [==============================] - 0s 2ms/step - loss: 1.5889
16/16 [==============================] - 0s 1ms/step - loss: 1.5896
16/16 [==============================] - 0s 2ms/step - loss: 1.5904
Epoch 42 of 60

Testing for epoch 42 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.3466
16/16 [==============================] - 0s 1ms/step - loss: 0.8730
16/16 [==============================] - 0s 2ms/step - loss: 1.3386
16/16 [==============================] - 0s 904us/step - loss: 1.5564
16/16 [==============================] - 0s 842us/step - loss: 1.6225
16/16 [==============================] - 0s 797us/step - loss: 1.6360
16/16 [==============================] - 0s 790us/step - loss: 1.6390
16/16 [==============================] - 0s 776us/step - loss: 1.6400
16/16 [==============================] - 0s 802us/step - loss: 1.6406
16/16 [==============================] - 0s 797us/step - loss: 1.6414

Testing for epoch 42 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 812us/step - loss: 0.3347
16/16 [==============================] - 0s 793us/step - loss: 0.8792
16/16 [==============================] - 0s 811us/step - loss: 1.3648
16/16 [==============================] - 0s 820us/step - loss: 1.5920
16/16 [==============================] - 0s 837us/step - loss: 1.6609
16/16 [==============================] - 0s 2ms/step - loss: 1.6751
16/16 [==============================] - 0s 2ms/step - loss: 1.6781
16/16 [==============================] - 0s 823us/step - loss: 1.6792
16/16 [==============================] - 0s 759us/step - loss: 1.6798
16/16 [==============================] - 0s 807us/step - loss: 1.6806
Epoch 43 of 60

Testing for epoch 43 index 1:
32/32 [==============================] - 0s 680us/step
16/16 [==============================] - 0s 784us/step - loss: 0.3423
16/16 [==============================] - 0s 783us/step - loss: 0.8698
16/16 [==============================] - 0s 917us/step - loss: 1.3426
16/16 [==============================] - 0s 942us/step - loss: 1.5630
16/16 [==============================] - 0s 948us/step - loss: 1.6294
16/16 [==============================] - 0s 2ms/step - loss: 1.6429
16/16 [==============================] - 0s 2ms/step - loss: 1.6458
16/16 [==============================] - 0s 1ms/step - loss: 1.6469
16/16 [==============================] - 0s 938us/step - loss: 1.6475
16/16 [==============================] - 0s 1ms/step - loss: 1.6483

Testing for epoch 43 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.3489
16/16 [==============================] - 0s 1ms/step - loss: 0.8556
16/16 [==============================] - 0s 780us/step - loss: 1.3105
16/16 [==============================] - 0s 828us/step - loss: 1.5222
16/16 [==============================] - 0s 931us/step - loss: 1.5859
16/16 [==============================] - 0s 2ms/step - loss: 1.5988
16/16 [==============================] - 0s 1ms/step - loss: 1.6016
16/16 [==============================] - 0s 2ms/step - loss: 1.6026
16/16 [==============================] - 0s 850us/step - loss: 1.6033
16/16 [==============================] - 0s 2ms/step - loss: 1.6041
Epoch 44 of 60

Testing for epoch 44 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.3334
16/16 [==============================] - 0s 1ms/step - loss: 0.8738
16/16 [==============================] - 0s 1ms/step - loss: 1.3626
16/16 [==============================] - 0s 882us/step - loss: 1.5900
16/16 [==============================] - 0s 859us/step - loss: 1.6580
16/16 [==============================] - 0s 2ms/step - loss: 1.6717
16/16 [==============================] - 0s 2ms/step - loss: 1.6746
16/16 [==============================] - 0s 2ms/step - loss: 1.6757
16/16 [==============================] - 0s 2ms/step - loss: 1.6763
16/16 [==============================] - 0s 1ms/step - loss: 1.6771

Testing for epoch 44 index 2:
32/32 [==============================] - 0s 553us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.3280
16/16 [==============================] - 0s 915us/step - loss: 0.8719
16/16 [==============================] - 0s 2ms/step - loss: 1.3668
16/16 [==============================] - 0s 756us/step - loss: 1.5971
16/16 [==============================] - 0s 791us/step - loss: 1.6658
16/16 [==============================] - 0s 781us/step - loss: 1.6796
16/16 [==============================] - 0s 809us/step - loss: 1.6825
16/16 [==============================] - 0s 804us/step - loss: 1.6835
16/16 [==============================] - 0s 1ms/step - loss: 1.6842
16/16 [==============================] - 0s 1ms/step - loss: 1.6850
Epoch 45 of 60

Testing for epoch 45 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 805us/step - loss: 0.3312
16/16 [==============================] - 0s 2ms/step - loss: 0.8689
16/16 [==============================] - 0s 778us/step - loss: 1.3585
16/16 [==============================] - 0s 781us/step - loss: 1.5852
16/16 [==============================] - 0s 793us/step - loss: 1.6522
16/16 [==============================] - 0s 777us/step - loss: 1.6655
16/16 [==============================] - 0s 1ms/step - loss: 1.6683
16/16 [==============================] - 0s 792us/step - loss: 1.6693
16/16 [==============================] - 0s 778us/step - loss: 1.6700
16/16 [==============================] - 0s 1ms/step - loss: 1.6708

Testing for epoch 45 index 2:
32/32 [==============================] - 0s 617us/step
16/16 [==============================] - 0s 803us/step - loss: 0.3327
16/16 [==============================] - 0s 2ms/step - loss: 0.8664
16/16 [==============================] - 0s 2ms/step - loss: 1.3547
16/16 [==============================] - 0s 845us/step - loss: 1.5807
16/16 [==============================] - 0s 766us/step - loss: 1.6474
16/16 [==============================] - 0s 2ms/step - loss: 1.6606
16/16 [==============================] - 0s 2ms/step - loss: 1.6634
16/16 [==============================] - 0s 2ms/step - loss: 1.6644
16/16 [==============================] - 0s 903us/step - loss: 1.6650
16/16 [==============================] - 0s 2ms/step - loss: 1.6659
Epoch 46 of 60

Testing for epoch 46 index 1:
32/32 [==============================] - 0s 780us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.3185
16/16 [==============================] - 0s 2ms/step - loss: 0.8798
16/16 [==============================] - 0s 1ms/step - loss: 1.3925
16/16 [==============================] - 0s 2ms/step - loss: 1.6304
16/16 [==============================] - 0s 760us/step - loss: 1.7001
16/16 [==============================] - 0s 2ms/step - loss: 1.7138
16/16 [==============================] - 0s 2ms/step - loss: 1.7166
16/16 [==============================] - 0s 810us/step - loss: 1.7176
16/16 [==============================] - 0s 788us/step - loss: 1.7183
16/16 [==============================] - 0s 1ms/step - loss: 1.7191

Testing for epoch 46 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 843us/step - loss: 0.3095
16/16 [==============================] - 0s 2ms/step - loss: 0.8859
16/16 [==============================] - 0s 835us/step - loss: 1.4168
16/16 [==============================] - 0s 802us/step - loss: 1.6631
16/16 [==============================] - 0s 1ms/step - loss: 1.7351
16/16 [==============================] - 0s 882us/step - loss: 1.7492
16/16 [==============================] - 0s 912us/step - loss: 1.7521
16/16 [==============================] - 0s 862us/step - loss: 1.7531
16/16 [==============================] - 0s 803us/step - loss: 1.7538
16/16 [==============================] - 0s 2ms/step - loss: 1.7545
Epoch 47 of 60

Testing for epoch 47 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.3166
16/16 [==============================] - 0s 2ms/step - loss: 0.8807
16/16 [==============================] - 0s 2ms/step - loss: 1.4012
16/16 [==============================] - 0s 2ms/step - loss: 1.6415
16/16 [==============================] - 0s 2ms/step - loss: 1.7109
16/16 [==============================] - 0s 2ms/step - loss: 1.7244
16/16 [==============================] - 0s 902us/step - loss: 1.7272
16/16 [==============================] - 0s 1ms/step - loss: 1.7282
16/16 [==============================] - 0s 1ms/step - loss: 1.7288
16/16 [==============================] - 0s 2ms/step - loss: 1.7296

Testing for epoch 47 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.3071
16/16 [==============================] - 0s 2ms/step - loss: 0.8856
16/16 [==============================] - 0s 1ms/step - loss: 1.4225
16/16 [==============================] - 0s 941us/step - loss: 1.6700
16/16 [==============================] - 0s 2ms/step - loss: 1.7412
16/16 [==============================] - 0s 815us/step - loss: 1.7550
16/16 [==============================] - 0s 769us/step - loss: 1.7578
16/16 [==============================] - 0s 809us/step - loss: 1.7588
16/16 [==============================] - 0s 932us/step - loss: 1.7595
16/16 [==============================] - 0s 2ms/step - loss: 1.7603
Epoch 48 of 60

Testing for epoch 48 index 1:
32/32 [==============================] - 0s 573us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.3016
16/16 [==============================] - 0s 2ms/step - loss: 0.8889
16/16 [==============================] - 0s 1ms/step - loss: 1.4374
16/16 [==============================] - 0s 1ms/step - loss: 1.6892
16/16 [==============================] - 0s 786us/step - loss: 1.7611
16/16 [==============================] - 0s 787us/step - loss: 1.7748
16/16 [==============================] - 0s 901us/step - loss: 1.7776
16/16 [==============================] - 0s 978us/step - loss: 1.7786
16/16 [==============================] - 0s 2ms/step - loss: 1.7792
16/16 [==============================] - 0s 817us/step - loss: 1.7800

Testing for epoch 48 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.3078
16/16 [==============================] - 0s 2ms/step - loss: 0.8793
16/16 [==============================] - 0s 2ms/step - loss: 1.4145
16/16 [==============================] - 0s 2ms/step - loss: 1.6595
16/16 [==============================] - 0s 837us/step - loss: 1.7291
16/16 [==============================] - 0s 1ms/step - loss: 1.7423
16/16 [==============================] - 0s 889us/step - loss: 1.7449
16/16 [==============================] - 0s 833us/step - loss: 1.7459
16/16 [==============================] - 0s 777us/step - loss: 1.7466
16/16 [==============================] - 0s 2ms/step - loss: 1.7474
Epoch 49 of 60

Testing for epoch 49 index 1:
32/32 [==============================] - 0s 578us/step
16/16 [==============================] - 0s 902us/step - loss: 0.3141
16/16 [==============================] - 0s 2ms/step - loss: 0.8736
16/16 [==============================] - 0s 2ms/step - loss: 1.3976
16/16 [==============================] - 0s 2ms/step - loss: 1.6358
16/16 [==============================] - 0s 880us/step - loss: 1.7026
16/16 [==============================] - 0s 955us/step - loss: 1.7151
16/16 [==============================] - 0s 1ms/step - loss: 1.7176
16/16 [==============================] - 0s 1ms/step - loss: 1.7186
16/16 [==============================] - 0s 802us/step - loss: 1.7192
16/16 [==============================] - 0s 2ms/step - loss: 1.7201

Testing for epoch 49 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.2951
16/16 [==============================] - 0s 833us/step - loss: 0.8939
16/16 [==============================] - 0s 823us/step - loss: 1.4599
16/16 [==============================] - 0s 2ms/step - loss: 1.7171
16/16 [==============================] - 0s 2ms/step - loss: 1.7890
16/16 [==============================] - 0s 2ms/step - loss: 1.8024
16/16 [==============================] - 0s 2ms/step - loss: 1.8051
16/16 [==============================] - 0s 921us/step - loss: 1.8060
16/16 [==============================] - 0s 863us/step - loss: 1.8067
16/16 [==============================] - 0s 787us/step - loss: 1.8075
Epoch 50 of 60

Testing for epoch 50 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 793us/step - loss: 0.3033
16/16 [==============================] - 0s 1ms/step - loss: 0.8913
16/16 [==============================] - 0s 815us/step - loss: 1.4487
16/16 [==============================] - 0s 786us/step - loss: 1.7005
16/16 [==============================] - 0s 770us/step - loss: 1.7700
16/16 [==============================] - 0s 807us/step - loss: 1.7828
16/16 [==============================] - 0s 954us/step - loss: 1.7853
16/16 [==============================] - 0s 1ms/step - loss: 1.7862
16/16 [==============================] - 0s 790us/step - loss: 1.7868
16/16 [==============================] - 0s 769us/step - loss: 1.7876

Testing for epoch 50 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 862us/step - loss: 0.2983
16/16 [==============================] - 0s 2ms/step - loss: 0.8872
16/16 [==============================] - 0s 794us/step - loss: 1.4445
16/16 [==============================] - 0s 1ms/step - loss: 1.6957
16/16 [==============================] - 0s 981us/step - loss: 1.7645
16/16 [==============================] - 0s 792us/step - loss: 1.7771
16/16 [==============================] - 0s 872us/step - loss: 1.7796
16/16 [==============================] - 0s 774us/step - loss: 1.7805
16/16 [==============================] - 0s 2ms/step - loss: 1.7811
16/16 [==============================] - 0s 1ms/step - loss: 1.7820
Epoch 51 of 60

Testing for epoch 51 index 1:
32/32 [==============================] - 0s 580us/step
16/16 [==============================] - 0s 809us/step - loss: 0.2901
16/16 [==============================] - 0s 2ms/step - loss: 0.8941
16/16 [==============================] - 0s 821us/step - loss: 1.4669
16/16 [==============================] - 0s 810us/step - loss: 1.7233
16/16 [==============================] - 0s 2ms/step - loss: 1.7926
16/16 [==============================] - 0s 2ms/step - loss: 1.8051
16/16 [==============================] - 0s 1ms/step - loss: 1.8075
16/16 [==============================] - 0s 793us/step - loss: 1.8084
16/16 [==============================] - 0s 818us/step - loss: 1.8091
16/16 [==============================] - 0s 788us/step - loss: 1.8099

Testing for epoch 51 index 2:
32/32 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.2951
16/16 [==============================] - 0s 1ms/step - loss: 0.8865
16/16 [==============================] - 0s 1ms/step - loss: 1.4489
16/16 [==============================] - 0s 2ms/step - loss: 1.6998
16/16 [==============================] - 0s 947us/step - loss: 1.7671
16/16 [==============================] - 0s 1ms/step - loss: 1.7791
16/16 [==============================] - 0s 797us/step - loss: 1.7814
16/16 [==============================] - 0s 2ms/step - loss: 1.7823
16/16 [==============================] - 0s 2ms/step - loss: 1.7830
16/16 [==============================] - 0s 997us/step - loss: 1.7839
Epoch 52 of 60

Testing for epoch 52 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 793us/step - loss: 0.2874
16/16 [==============================] - 0s 920us/step - loss: 0.8992
16/16 [==============================] - 0s 2ms/step - loss: 1.4836
16/16 [==============================] - 0s 1ms/step - loss: 1.7430
16/16 [==============================] - 0s 2ms/step - loss: 1.8119
16/16 [==============================] - 0s 842us/step - loss: 1.8240
16/16 [==============================] - 0s 2ms/step - loss: 1.8263
16/16 [==============================] - 0s 2ms/step - loss: 1.8272
16/16 [==============================] - 0s 849us/step - loss: 1.8278
16/16 [==============================] - 0s 810us/step - loss: 1.8287

Testing for epoch 52 index 2:
32/32 [==============================] - 0s 663us/step
16/16 [==============================] - 0s 798us/step - loss: 0.2935
16/16 [==============================] - 0s 2ms/step - loss: 0.8916
16/16 [==============================] - 0s 2ms/step - loss: 1.4652
16/16 [==============================] - 0s 810us/step - loss: 1.7180
16/16 [==============================] - 0s 2ms/step - loss: 1.7850
16/16 [==============================] - 0s 1ms/step - loss: 1.7965
16/16 [==============================] - 0s 2ms/step - loss: 1.7987
16/16 [==============================] - 0s 2ms/step - loss: 1.7996
16/16 [==============================] - 0s 2ms/step - loss: 1.8002
16/16 [==============================] - 0s 916us/step - loss: 1.8011
Epoch 53 of 60

Testing for epoch 53 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 814us/step - loss: 0.2903
16/16 [==============================] - 0s 2ms/step - loss: 0.8924
16/16 [==============================] - 0s 1ms/step - loss: 1.4727
16/16 [==============================] - 0s 2ms/step - loss: 1.7236
16/16 [==============================] - 0s 2ms/step - loss: 1.7899
16/16 [==============================] - 0s 2ms/step - loss: 1.8009
16/16 [==============================] - 0s 1ms/step - loss: 1.8031
16/16 [==============================] - 0s 840us/step - loss: 1.8039
16/16 [==============================] - 0s 2ms/step - loss: 1.8046
16/16 [==============================] - 0s 2ms/step - loss: 1.8054

Testing for epoch 53 index 2:
32/32 [==============================] - 0s 626us/step
16/16 [==============================] - 0s 774us/step - loss: 0.2955
16/16 [==============================] - 0s 2ms/step - loss: 0.8898
16/16 [==============================] - 0s 1ms/step - loss: 1.4673
16/16 [==============================] - 0s 2ms/step - loss: 1.7113
16/16 [==============================] - 0s 2ms/step - loss: 1.7764
16/16 [==============================] - 0s 2ms/step - loss: 1.7869
16/16 [==============================] - 0s 944us/step - loss: 1.7890
16/16 [==============================] - 0s 2ms/step - loss: 1.7898
16/16 [==============================] - 0s 892us/step - loss: 1.7905
16/16 [==============================] - 0s 2ms/step - loss: 1.7913
Epoch 54 of 60

Testing for epoch 54 index 1:
32/32 [==============================] - 0s 980us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.2967
16/16 [==============================] - 0s 992us/step - loss: 0.8879
16/16 [==============================] - 0s 1ms/step - loss: 1.4623
16/16 [==============================] - 0s 770us/step - loss: 1.7019
16/16 [==============================] - 0s 786us/step - loss: 1.7649
16/16 [==============================] - 0s 803us/step - loss: 1.7749
16/16 [==============================] - 0s 2ms/step - loss: 1.7769
16/16 [==============================] - 0s 2ms/step - loss: 1.7777
16/16 [==============================] - 0s 982us/step - loss: 1.7784
16/16 [==============================] - 0s 2ms/step - loss: 1.7793

Testing for epoch 54 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.2942
16/16 [==============================] - 0s 925us/step - loss: 0.8801
16/16 [==============================] - 0s 846us/step - loss: 1.4515
16/16 [==============================] - 0s 787us/step - loss: 1.6891
16/16 [==============================] - 0s 2ms/step - loss: 1.7511
16/16 [==============================] - 0s 832us/step - loss: 1.7609
16/16 [==============================] - 0s 2ms/step - loss: 1.7628
16/16 [==============================] - 0s 859us/step - loss: 1.7636
16/16 [==============================] - 0s 800us/step - loss: 1.7643
16/16 [==============================] - 0s 774us/step - loss: 1.7652
Epoch 55 of 60

Testing for epoch 55 index 1:
32/32 [==============================] - 0s 898us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.2849
16/16 [==============================] - 0s 851us/step - loss: 0.9010
16/16 [==============================] - 0s 2ms/step - loss: 1.5057
16/16 [==============================] - 0s 2ms/step - loss: 1.7561
16/16 [==============================] - 0s 2ms/step - loss: 1.8207
16/16 [==============================] - 0s 2ms/step - loss: 1.8308
16/16 [==============================] - 0s 857us/step - loss: 1.8328
16/16 [==============================] - 0s 2ms/step - loss: 1.8336
16/16 [==============================] - 0s 1ms/step - loss: 1.8342
16/16 [==============================] - 0s 2ms/step - loss: 1.8350

Testing for epoch 55 index 2:
32/32 [==============================] - 0s 567us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.2748
16/16 [==============================] - 0s 802us/step - loss: 0.9142
16/16 [==============================] - 0s 2ms/step - loss: 1.5455
16/16 [==============================] - 0s 833us/step - loss: 1.8067
16/16 [==============================] - 0s 2ms/step - loss: 1.8736
16/16 [==============================] - 0s 1ms/step - loss: 1.8841
16/16 [==============================] - 0s 2ms/step - loss: 1.8861
16/16 [==============================] - 0s 2ms/step - loss: 1.8869
16/16 [==============================] - 0s 2ms/step - loss: 1.8875
16/16 [==============================] - 0s 2ms/step - loss: 1.8883
Epoch 56 of 60

Testing for epoch 56 index 1:
32/32 [==============================] - 0s 562us/step
16/16 [==============================] - 0s 810us/step - loss: 0.2756
16/16 [==============================] - 0s 1ms/step - loss: 0.9080
16/16 [==============================] - 0s 771us/step - loss: 1.5313
16/16 [==============================] - 0s 2ms/step - loss: 1.7872
16/16 [==============================] - 0s 2ms/step - loss: 1.8517
16/16 [==============================] - 0s 866us/step - loss: 1.8617
16/16 [==============================] - 0s 793us/step - loss: 1.8636
16/16 [==============================] - 0s 2ms/step - loss: 1.8644
16/16 [==============================] - 0s 2ms/step - loss: 1.8650
16/16 [==============================] - 0s 1000us/step - loss: 1.8659

Testing for epoch 56 index 2:
32/32 [==============================] - 0s 585us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.2767
16/16 [==============================] - 0s 2ms/step - loss: 0.9042
16/16 [==============================] - 0s 991us/step - loss: 1.5266
16/16 [==============================] - 0s 2ms/step - loss: 1.7809
16/16 [==============================] - 0s 781us/step - loss: 1.8447
16/16 [==============================] - 0s 1ms/step - loss: 1.8545
16/16 [==============================] - 0s 2ms/step - loss: 1.8563
16/16 [==============================] - 0s 812us/step - loss: 1.8571
16/16 [==============================] - 0s 2ms/step - loss: 1.8577
16/16 [==============================] - 0s 2ms/step - loss: 1.8586
Epoch 57 of 60

Testing for epoch 57 index 1:
32/32 [==============================] - 0s 566us/step
16/16 [==============================] - 0s 962us/step - loss: 0.2789
16/16 [==============================] - 0s 823us/step - loss: 0.9041
16/16 [==============================] - 0s 2ms/step - loss: 1.5242
16/16 [==============================] - 0s 2ms/step - loss: 1.7751
16/16 [==============================] - 0s 1ms/step - loss: 1.8372
16/16 [==============================] - 0s 2ms/step - loss: 1.8466
16/16 [==============================] - 0s 1ms/step - loss: 1.8484
16/16 [==============================] - 0s 817us/step - loss: 1.8491
16/16 [==============================] - 0s 799us/step - loss: 1.8497
16/16 [==============================] - 0s 805us/step - loss: 1.8506

Testing for epoch 57 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 789us/step - loss: 0.2721
16/16 [==============================] - 0s 836us/step - loss: 0.9176
16/16 [==============================] - 0s 1ms/step - loss: 1.5615
16/16 [==============================] - 0s 799us/step - loss: 1.8203
16/16 [==============================] - 0s 2ms/step - loss: 1.8840
16/16 [==============================] - 0s 796us/step - loss: 1.8936
16/16 [==============================] - 0s 789us/step - loss: 1.8954
16/16 [==============================] - 0s 2ms/step - loss: 1.8961
16/16 [==============================] - 0s 798us/step - loss: 1.8967
16/16 [==============================] - 0s 2ms/step - loss: 1.8976
Epoch 58 of 60

Testing for epoch 58 index 1:
32/32 [==============================] - 0s 971us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.2852
16/16 [==============================] - 0s 881us/step - loss: 0.9020
16/16 [==============================] - 0s 2ms/step - loss: 1.5168
16/16 [==============================] - 0s 922us/step - loss: 1.7593
16/16 [==============================] - 0s 828us/step - loss: 1.8184
16/16 [==============================] - 0s 771us/step - loss: 1.8271
16/16 [==============================] - 0s 815us/step - loss: 1.8288
16/16 [==============================] - 0s 958us/step - loss: 1.8295
16/16 [==============================] - 0s 787us/step - loss: 1.8301
16/16 [==============================] - 0s 788us/step - loss: 1.8310

Testing for epoch 58 index 2:
32/32 [==============================] - 0s 967us/step
16/16 [==============================] - 0s 876us/step - loss: 0.2818
16/16 [==============================] - 0s 2ms/step - loss: 0.9145
16/16 [==============================] - 0s 860us/step - loss: 1.5509
16/16 [==============================] - 0s 797us/step - loss: 1.7973
16/16 [==============================] - 0s 780us/step - loss: 1.8577
16/16 [==============================] - 0s 782us/step - loss: 1.8665
16/16 [==============================] - 0s 1ms/step - loss: 1.8682
16/16 [==============================] - 0s 951us/step - loss: 1.8689
16/16 [==============================] - 0s 764us/step - loss: 1.8695
16/16 [==============================] - 0s 777us/step - loss: 1.8704
Epoch 59 of 60

Testing for epoch 59 index 1:
32/32 [==============================] - 0s 591us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.2787
16/16 [==============================] - 0s 2ms/step - loss: 0.9060
16/16 [==============================] - 0s 2ms/step - loss: 1.5380
16/16 [==============================] - 0s 892us/step - loss: 1.7782
16/16 [==============================] - 0s 864us/step - loss: 1.8366
16/16 [==============================] - 0s 2ms/step - loss: 1.8450
16/16 [==============================] - 0s 824us/step - loss: 1.8465
16/16 [==============================] - 0s 2ms/step - loss: 1.8472
16/16 [==============================] - 0s 2ms/step - loss: 1.8478
16/16 [==============================] - 0s 1ms/step - loss: 1.8488

Testing for epoch 59 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 783us/step - loss: 0.2702
16/16 [==============================] - 0s 2ms/step - loss: 0.9158
16/16 [==============================] - 0s 930us/step - loss: 1.5716
16/16 [==============================] - 0s 2ms/step - loss: 1.8165
16/16 [==============================] - 0s 2ms/step - loss: 1.8763
16/16 [==============================] - 0s 2ms/step - loss: 1.8847
16/16 [==============================] - 0s 893us/step - loss: 1.8862
16/16 [==============================] - 0s 2ms/step - loss: 1.8869
16/16 [==============================] - 0s 2ms/step - loss: 1.8876
16/16 [==============================] - 0s 2ms/step - loss: 1.8885
Epoch 60 of 60

Testing for epoch 60 index 1:
32/32 [==============================] - 0s 564us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.2713
16/16 [==============================] - 0s 874us/step - loss: 0.9090
16/16 [==============================] - 0s 2ms/step - loss: 1.5573
16/16 [==============================] - 0s 843us/step - loss: 1.7950
16/16 [==============================] - 0s 800us/step - loss: 1.8527
16/16 [==============================] - 0s 784us/step - loss: 1.8605
16/16 [==============================] - 0s 803us/step - loss: 1.8620
16/16 [==============================] - 0s 2ms/step - loss: 1.8627
16/16 [==============================] - 0s 930us/step - loss: 1.8633
16/16 [==============================] - 0s 772us/step - loss: 1.8642

Testing for epoch 60 index 2:
32/32 [==============================] - 0s 569us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.2695
16/16 [==============================] - 0s 2ms/step - loss: 0.9206
16/16 [==============================] - 0s 830us/step - loss: 1.5858
16/16 [==============================] - 0s 880us/step - loss: 1.8277
16/16 [==============================] - 0s 820us/step - loss: 1.8862
16/16 [==============================] - 0s 820us/step - loss: 1.8940
16/16 [==============================] - 0s 784us/step - loss: 1.8955
16/16 [==============================] - 0s 2ms/step - loss: 1.8961
16/16 [==============================] - 0s 2ms/step - loss: 1.8968
16/16 [==============================] - 0s 2ms/step - loss: 1.8977
32/32 [==============================] - 0s 2ms/step</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>MO_GAAL(contamination=0.05, k=10, lr_d=0.01, lr_g=0.0001, momentum=0.9,
    stop_epochs=20)</code></pre>
</div>
</div>
<div id="8470cdf5-ed04-472f-8e2a-86cd122a764d" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>outlier_MO_GAAL_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="589f41b0-20f1-4b63-a57c-215940c30c02" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_MO_GAAL_one)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"MO-GAAL (Liu et al., 2019)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-98-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.947
Precision: 0.478
Recall: 0.431
F1 Score: 0.454</code></pre>
</div>
</div>
<div id="df653162-ca0c-4c2e-87dd-ff2d97877ece" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.947
Precision(TP / TP + FP): 0.478
Recall(TP / TP + FN): 0.431
F1 Score(2*precision*recall/precision+recall): 0.454</code></pre>
</div>
</div>
<div id="def7ce92-ebc5-4c04-bfc5-66660164a9f2" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 0s 548us/step</code></pre>
</div>
</div>
<div id="b5a1b56b-682b-4412-ace9-8f50b4fbc874" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>0.5756523895121799</code></pre>
</div>
</div>
<div id="623bb1a9-7c7a-4811-b8a9-fccd4d66adf5" class="cell" data-scrolled="true" data-execution_count="101">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.000000</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.920000</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.920000</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997366</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.969</td>
<td>0.700000</td>
<td>0.686275</td>
<td>0.693069</td>
<td>0.959214</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.923</td>
<td>0.370000</td>
<td>0.725490</td>
<td>0.490066</td>
<td>0.864150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.999</td>
<td>1.000000</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999959</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.993</td>
<td>0.940000</td>
<td>0.921569</td>
<td>0.930693</td>
<td>0.997397</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.973</td>
<td>0.740000</td>
<td>0.725490</td>
<td>0.732673</td>
<td>0.990206</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.987</td>
<td>0.880000</td>
<td>0.862745</td>
<td>0.871287</td>
<td>0.995826</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.972</td>
<td>0.925926</td>
<td>0.490196</td>
<td>0.641026</td>
<td>0.863644</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.907</td>
<td>0.080000</td>
<td>0.078431</td>
<td>0.079208</td>
<td>0.541705</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SO-GAAL (Liu et al., 2019)</td>
<td>0.946</td>
<td>0.468085</td>
<td>0.431373</td>
<td>0.448980</td>
<td>0.575208</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MO-GAAL (Liu et al., 2019)</td>
<td>0.947</td>
<td>0.478261</td>
<td>0.431373</td>
<td>0.453608</td>
<td>0.575652</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="lscp_linear" class="level2">
<h2 class="anchored" data-anchor-id="lscp_linear">LSCP_Linear</h2>
<div id="490d9a99-89c9-4989-bccc-a8e8320e0710" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>detectors <span class="op">=</span> [KNN(), LOF(), OCSVM()]</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LSCP(detectors,contamination<span class="op">=</span><span class="fl">0.05</span>, random_state<span class="op">=</span><span class="dv">77</span>)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/pyod/models/lscp.py:382: UserWarning: The number of histogram bins is greater than the number of classifiers, reducing n_bins to n_clf.
  warnings.warn(
/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/scipy/stats/_stats_py.py:4068: PearsonRConstantInputWarning: An input array is constant; the correlation coefficient is not defined.
  warnings.warn(PearsonRConstantInputWarning())
/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/scipy/stats/_stats_py.py:4068: PearsonRConstantInputWarning: An input array is constant; the correlation coefficient is not defined.
  warnings.warn(PearsonRConstantInputWarning())</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>LSCP(contamination=0.05,
   detector_list=[KNN(algorithm='auto', contamination=0.1, leaf_size=30, method='largest',
  metric='minkowski', metric_params=None, n_jobs=1, n_neighbors=5, p=2,
  radius=1.0), LOF(algorithm='auto', contamination=0.1, leaf_size=30, metric='minkowski',
  metric_params=None, n_jobs=1, n_neighbors=20, novelty=True, p=2), OCSVM(cache_size=200, coef0=0.0, contamination=0.1, degree=3, gamma='auto',
   kernel='rbf', max_iter=-1, nu=0.5, shrinking=True, tol=0.001,
   verbose=False)],
   local_max_features=1.0, local_region_size=30, n_bins=3,
   random_state=RandomState(MT19937) at 0x7FD69813D940)</code></pre>
</div>
</div>
<div id="a5f80516-ce9a-4669-83cd-d82627a1daee" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>outlier_LSCP_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="72fa2d02-bce1-4329-a26d-e3bf98516ca9" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_linear,outlier_LSCP_one)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"LSCP (Zhao et al., 2019)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-105-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.985
Precision: 0.860
Recall: 0.843
F1 Score: 0.851</code></pre>
</div>
</div>
<div id="c00b1e0b-62b6-4547-a29c-aaa511c8e0b4" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.985
Precision(TP / TP + FP): 0.860
Recall(TP / TP + FN): 0.843
F1 Score(2*precision*recall/precision+recall): 0.851</code></pre>
</div>
</div>
<div id="a5079c9e-f1e3-4043-816d-9320a95426d7" class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_linear,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="2eaad0ad-5067-4eaf-8495-2a9611d2a9b2" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>0.9985330275418913</code></pre>
</div>
</div>
<div id="26c932e2-523c-497c-9d68-95442e0bd141" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>tab_linear <span class="op">=</span> pd.concat([tab_linear,</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_linear</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.000000</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.920000</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.920000</td>
<td>0.901961</td>
<td>0.910891</td>
<td>0.997366</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.969</td>
<td>0.700000</td>
<td>0.686275</td>
<td>0.693069</td>
<td>0.959214</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.923</td>
<td>0.370000</td>
<td>0.725490</td>
<td>0.490066</td>
<td>0.864150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.999</td>
<td>1.000000</td>
<td>0.980392</td>
<td>0.990099</td>
<td>0.999959</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.993</td>
<td>0.940000</td>
<td>0.921569</td>
<td>0.930693</td>
<td>0.997397</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.973</td>
<td>0.740000</td>
<td>0.725490</td>
<td>0.732673</td>
<td>0.990206</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.987</td>
<td>0.880000</td>
<td>0.862745</td>
<td>0.871287</td>
<td>0.995826</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.972</td>
<td>0.925926</td>
<td>0.490196</td>
<td>0.641026</td>
<td>0.863644</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.907</td>
<td>0.080000</td>
<td>0.078431</td>
<td>0.079208</td>
<td>0.541705</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SO-GAAL (Liu et al., 2019)</td>
<td>0.946</td>
<td>0.468085</td>
<td>0.431373</td>
<td>0.448980</td>
<td>0.575208</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MO-GAAL (Liu et al., 2019)</td>
<td>0.947</td>
<td>0.478261</td>
<td>0.431373</td>
<td>0.453608</td>
<td>0.575652</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LSCP (Zhao et al., 2019)</td>
<td>0.985</td>
<td>0.860000</td>
<td>0.843137</td>
<td>0.851485</td>
<td>0.998533</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="tab_linear" class="level2">
<h2 class="anchored" data-anchor-id="tab_linear">tab_linear</h2>
<div id="3321bc2c-aa1f-40d9-8bba-0b6ebb4939ec" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="bu">round</span>(tab_linear,<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.999</td>
<td>1.000</td>
<td>0.980</td>
<td>0.990</td>
<td>1.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.991</td>
<td>0.920</td>
<td>0.902</td>
<td>0.911</td>
<td>0.998</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.991</td>
<td>0.920</td>
<td>0.902</td>
<td>0.911</td>
<td>0.997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.969</td>
<td>0.700</td>
<td>0.686</td>
<td>0.693</td>
<td>0.959</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.923</td>
<td>0.370</td>
<td>0.725</td>
<td>0.490</td>
<td>0.864</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.999</td>
<td>1.000</td>
<td>0.980</td>
<td>0.990</td>
<td>1.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.993</td>
<td>0.940</td>
<td>0.922</td>
<td>0.931</td>
<td>0.997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.973</td>
<td>0.740</td>
<td>0.725</td>
<td>0.733</td>
<td>0.990</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.987</td>
<td>0.880</td>
<td>0.863</td>
<td>0.871</td>
<td>0.996</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.972</td>
<td>0.926</td>
<td>0.490</td>
<td>0.641</td>
<td>0.864</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.907</td>
<td>0.080</td>
<td>0.078</td>
<td>0.079</td>
<td>0.542</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SO-GAAL (Liu et al., 2019)</td>
<td>0.946</td>
<td>0.468</td>
<td>0.431</td>
<td>0.449</td>
<td>0.575</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MO-GAAL (Liu et al., 2019)</td>
<td>0.947</td>
<td>0.478</td>
<td>0.431</td>
<td>0.454</td>
<td>0.576</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LSCP (Zhao et al., 2019)</td>
<td>0.985</td>
<td>0.860</td>
<td>0.843</td>
<td>0.851</td>
<td>0.999</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="orbit" class="level1">
<h1>Orbit</h1>
<div id="6898ee27-f374-4340-b1d0-00bcbaa30927" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># np.random.seed(1212)</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="co"># epsilon = np.around(np.random.normal(size=1000),15)</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="co"># signal = np.random.choice(np.concatenate((np.random.uniform(-7, -5, 25).round(15), np.random.uniform(5, 7, 25).round(15), np.repeat(0, 950))), 1000)</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="co"># eta = signal + epsilon</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="co"># np.random.seed(777)</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pi=np.pi</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="co"># n=1000</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ang=np.linspace(-pi,pi-2*pi/n,n)</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a><span class="co"># r=5+np.cos(np.linspace(0,12*pi,n))</span></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="co"># vx=r*np.cos(ang)</span></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="co"># vy=r*np.sin(ang)</span></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a><span class="co"># f1=10*np.sin(np.linspace(0,6*pi,n))</span></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a><span class="co"># f = f1 + eta</span></span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a><span class="co"># _df = pd.DataFrame({'x' : vx, 'y' : vy, 'f' : f})</span></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a><span class="co"># outlier_true_orbit = signal.copy()</span></span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a><span class="co"># outlier_true_orbit = list(map(lambda x: 1 if x!=0 else 0,outlier_true_orbit))</span></span></code></pre></div>
</div>
<div id="6b0a7762-d5ff-4513-9576-49ea0d946f02" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">"Accuracy"</span>,<span class="st">"Precision"</span>,<span class="st">"Recall"</span>,<span class="st">"F1"</span>,<span class="st">"AUC"</span>])</span></code></pre></div>
</div>
<div id="6ea0ad1b-b09d-4b26-ae12-922e1d9797e3" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">777</span>)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>epsilon <span class="op">=</span> np.around(np.random.normal(size<span class="op">=</span><span class="dv">1000</span>),<span class="dv">15</span>)</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>signal <span class="op">=</span> np.random.choice(np.concatenate((np.random.uniform(<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">25</span>).<span class="bu">round</span>(<span class="dv">15</span>), np.random.uniform(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">25</span>).<span class="bu">round</span>(<span class="dv">15</span>), np.repeat(<span class="dv">0</span>, <span class="dv">950</span>))), <span class="dv">1000</span>)</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>eta <span class="op">=</span> signal <span class="op">+</span> epsilon</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>pi<span class="op">=</span>np.pi</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>n<span class="op">=</span><span class="dv">1000</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>ang<span class="op">=</span>np.linspace(<span class="op">-</span>pi,pi<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span>n,n)</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>r<span class="op">=</span><span class="dv">5</span><span class="op">+</span>np.cos(np.linspace(<span class="dv">0</span>,<span class="dv">12</span><span class="op">*</span>pi,n))</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>vx<span class="op">=</span>r<span class="op">*</span>np.cos(ang)</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>vy<span class="op">=</span>r<span class="op">*</span>np.sin(ang)</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>f1<span class="op">=</span><span class="dv">10</span><span class="op">*</span>np.sin(np.linspace(<span class="dv">0</span>,<span class="dv">6</span><span class="op">*</span>pi,n))</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> f1 <span class="op">+</span> eta</span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a>_df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span> : vx, <span class="st">'y'</span> : vy, <span class="st">'f'</span> : f})</span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a>outlier_true_orbit <span class="op">=</span> signal.copy()</span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>outlier_true_orbit <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x<span class="op">!=</span><span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>,outlier_true_orbit))</span></code></pre></div>
</div>
<section id="gode_orbit" class="level2">
<h2 class="anchored" data-anchor-id="gode_orbit">GODE_Orbit</h2>
<div id="40b3915e-c1a8-4f0e-9c03-d6feb3dc2eca" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>_Orbit <span class="op">=</span> Orbit(_df)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>_Orbit.get_distance()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 1000/1000 [00:01&lt;00:00, 595.48it/s]</code></pre>
</div>
</div>
<div id="537e1cfa-5fbc-4d99-942e-9f0e29a3981f" class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>_Orbit.get_weightmatrix(theta<span class="op">=</span>(_Orbit.D[_Orbit.D<span class="op">&gt;</span><span class="dv">0</span>].mean()),kappa<span class="op">=</span><span class="dv">2500</span>) </span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>_Orbit.fit(sd<span class="op">=</span><span class="dv">15</span>,ref<span class="op">=</span><span class="dv">20</span>)</span></code></pre></div>
</div>
<div id="168491e4-70d2-44c1-a4f6-77a1aec6815a" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>outlier_GODE_one_old <span class="op">=</span> (_Orbit.df[<span class="st">'Residual'</span>]<span class="op">**</span><span class="dv">2</span>).tolist()</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>sorted_data <span class="op">=</span> <span class="bu">sorted</span>(outlier_GODE_one_old,reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(sorted_data) <span class="op">*</span> <span class="fl">0.05</span>)</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>five_percent <span class="op">=</span> sorted_data[index]</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>outlier_GODE_one <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="op">&gt;</span> five_percent <span class="cf">else</span> <span class="dv">0</span>,outlier_GODE_one_old))</span></code></pre></div>
</div>
<div id="38a14f9f-d041-4a80-842c-46490e047be3" class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_GODE_one)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"GODE"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-117-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.961
Precision: 0.600
Recall: 0.612
F1 Score: 0.606</code></pre>
</div>
</div>
<div id="af7e9585-2505-40ca-9d80-30b45a5b4017" class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.961
Precision(TP / TP + FP): 0.600
Recall(TP / TP + FN): 0.612
F1 Score(2*precision*recall/precision+recall): 0.606</code></pre>
</div>
</div>
<div id="92f9298a-f51e-4ef8-bf62-13041c769df0" class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,outlier_GODE_one_old)</span></code></pre></div>
</div>
<div id="399f32c4-21a5-495d-85d8-a7a1e67192a1" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">
<pre><code>0.893023455438958</code></pre>
</div>
</div>
<div id="037e0e53-1b28-49e4-bfdb-e985ddf138fa" class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.6</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="lof_orbit" class="level2">
<h2 class="anchored" data-anchor-id="lof_orbit">LOF_Orbit</h2>
<div id="0022d54b-87db-4ef4-b56b-7778237b18d2" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LOF(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'f'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<pre><code>LOF(algorithm='auto', contamination=0.05, leaf_size=30, metric='minkowski',
  metric_params=None, n_jobs=1, n_neighbors=20, novelty=True, p=2)</code></pre>
</div>
</div>
<div id="bcac7f99-db7c-4efa-9291-9b49418be27a" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>outlier_LOF_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="95e72aa4-ad57-4b5d-8138-97877f54ae92" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,clf.fit_predict(_df))</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"LOF (Breunig et al., 2000)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/utils/deprecation.py:86: FutureWarning: Function fit_predict is deprecated
  warnings.warn(msg, category=FutureWarning)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-124-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.921
Precision: 0.200
Recall: 0.204
F1 Score: 0.202</code></pre>
</div>
</div>
<div id="7e53622a-67cb-468d-a6cf-e55e4ee1ac64" class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.921
Precision(TP / TP + FP): 0.200
Recall(TP / TP + FN): 0.204
F1 Score(2*precision*recall/precision+recall): 0.202</code></pre>
</div>
</div>
<div id="279a88b2-1518-4977-8d13-c4cc92d0b4df" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="2a86c7d0-2940-4aa9-9a53-58349becad79" class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">
<pre><code>0.6641236936414945</code></pre>
</div>
</div>
<div id="ae5db946-538f-4bd9-9e92-7e99037807a9" class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="127">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.6</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.2</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="knn_orbit" class="level2">
<h2 class="anchored" data-anchor-id="knn_orbit">KNN_Orbit</h2>
<div id="5ed36d8e-43cb-4ccb-80ff-f61307a1c03e" class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> KNN(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'f'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">
<pre><code>KNN(algorithm='auto', contamination=0.05, leaf_size=30, method='largest',
  metric='minkowski', metric_params=None, n_jobs=1, n_neighbors=5, p=2,
  radius=1.0)</code></pre>
</div>
</div>
<div id="d678ea39-1c1c-4818-97db-9730898abe7b" class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>outlier_KNN_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="dc94b6a1-bf0b-407b-ad34-daf90cd22dbc" class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_KNN_one)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"kNN (Ramaswamy et al., 2000)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-131-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.947
Precision: 0.460
Recall: 0.469
F1 Score: 0.465</code></pre>
</div>
</div>
<div id="2d3a1740-b058-46cd-b97f-ce6a5bc0efef" class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.947
Precision(TP / TP + FP): 0.460
Recall(TP / TP + FN): 0.469
F1 Score(2*precision*recall/precision+recall): 0.465</code></pre>
</div>
</div>
<div id="fcfb2437-9be8-4874-8715-18a2d145d7e8" class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="cba3647d-c748-42a8-9d3e-1fca43847ca7" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="133">
<pre><code>0.8479903002210347</code></pre>
</div>
</div>
<div id="4840c93c-56de-48bb-9a89-b613015537de" class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.60</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.20</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.46</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.847990</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="cblof_orbit" class="level2">
<h2 class="anchored" data-anchor-id="cblof_orbit">CBLOF_Orbit</h2>
<div id="91a22ff2-4368-4f0f-aa3a-416fc7164c0b" class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> CBLOF(contamination<span class="op">=</span><span class="fl">0.05</span>,random_state<span class="op">=</span><span class="dv">77</span>)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'f'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/cluster/_kmeans.py:1412: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="135">
<pre><code>CBLOF(alpha=0.9, beta=5, check_estimator=False, clustering_estimator=None,
   contamination=0.05, n_clusters=8, n_jobs=None, random_state=77,
   use_weights=False)</code></pre>
</div>
</div>
<div id="244d1c64-42a9-4299-aa4e-daff3b455d06" class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>outlier_CBLOF_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="1ca1d626-3c93-4e54-b769-82f6218819a8" class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_CBLOF_one)</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"CBLOF (He et al., 2003)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-138-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.911
Precision: 0.100
Recall: 0.102
F1 Score: 0.101</code></pre>
</div>
</div>
<div id="7cdc3d9f-04a2-4d99-9ed5-96a0b05847e3" class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.911
Precision(TP / TP + FP): 0.100
Recall(TP / TP + FN): 0.102
F1 Score(2*precision*recall/precision+recall): 0.101</code></pre>
</div>
</div>
<div id="6a8d5c8b-904b-4721-8ae9-38785fdc7591" class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="619f150f-ead0-41d8-a72a-2b12f870ded2" class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">
<pre><code>0.533402004334857</code></pre>
</div>
</div>
<div id="51091ede-f6dd-4a06-9f08-9056f3bc17e2" class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.60</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.20</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.46</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.847990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.911</td>
<td>0.10</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.533402</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="ocsvm_orbit" class="level2">
<h2 class="anchored" data-anchor-id="ocsvm_orbit">OCSVM_Orbit</h2>
<div id="c6b80dfb-8542-4b12-8278-120d0f33b70a" class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> OCSVM(nu<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<pre><code>OCSVM(cache_size=200, coef0=0.0, contamination=0.1, degree=3, gamma='auto',
   kernel='rbf', max_iter=-1, nu=0.05, shrinking=True, tol=0.001,
   verbose=False)</code></pre>
</div>
</div>
<div id="85a96b00-f424-42f0-b59a-4160807caad9" class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>outlier_OSVM_one <span class="op">=</span> <span class="bu">list</span>(clf.predict(_df))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/base.py:457: UserWarning: X has feature names, but OneClassSVM was fitted without feature names
  warnings.warn(</code></pre>
</div>
</div>
<div id="63f64b57-9b88-4fce-9d73-c4bb6e122d25" class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_OSVM_one)</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"OCSVM (Sch ̈olkopf et al., 2001)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-145-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.893
Precision: 0.210
Recall: 0.429
F1 Score: 0.282</code></pre>
</div>
</div>
<div id="d04a8860-d7af-4426-b7db-2f6ed0a34e21" class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.893
Precision(TP / TP + FP): 0.210
Recall(TP / TP + FN): 0.429
F1 Score(2*precision*recall/precision+recall): 0.282</code></pre>
</div>
</div>
<div id="014a3989-72cb-4e46-a4ff-8485c13e19be" class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/base.py:457: UserWarning: X has feature names, but OneClassSVM was fitted without feature names
  warnings.warn(</code></pre>
</div>
</div>
<div id="1519bfe3-6a98-4fb4-b5c2-27e4b0231069" class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">
<pre><code>0.7887508315629091</code></pre>
</div>
</div>
<div id="7f937a84-f52c-42e3-a5da-92a72caa0b7c" class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="148">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.60</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.20</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.46</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.847990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.911</td>
<td>0.10</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.533402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.893</td>
<td>0.21</td>
<td>0.428571</td>
<td>0.281879</td>
<td>0.788751</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="mcd_orbit" class="level2">
<h2 class="anchored" data-anchor-id="mcd_orbit">MCD_Orbit</h2>
<div id="d4ccfab6-aebd-4447-ac81-d5c02eacb338" class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> MCD(contamination<span class="op">=</span><span class="fl">0.05</span> , random_state <span class="op">=</span> <span class="dv">77</span>)</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>,<span class="st">'y'</span>,<span class="st">'f'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="149">
<pre><code>MCD(assume_centered=False, contamination=0.05, random_state=77,
  store_precision=True, support_fraction=None)</code></pre>
</div>
</div>
<div id="397cb6ae-bcae-45a6-9a18-3a9f81ed5caf" class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>outlier_MCD_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="67e6a6bb-e3e6-426c-9ed9-00a901e8791b" class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_MCD_one)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"MCD (Hardin and Rocke, 2004)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-152-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.911
Precision: 0.100
Recall: 0.102
F1 Score: 0.101</code></pre>
</div>
</div>
<div id="d139e6e7-5622-47d7-945f-358e3edebcb4" class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.911
Precision(TP / TP + FP): 0.100
Recall(TP / TP + FN): 0.102
F1 Score(2*precision*recall/precision+recall): 0.101</code></pre>
</div>
</div>
<div id="947c580f-cd5b-40fd-82cd-2a310bd206a2" class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="c4d4e257-642b-4897-82bd-f872409cf231" class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="154">
<pre><code>0.45400115882315073</code></pre>
</div>
</div>
<div id="6607c254-66a1-4b83-a7e7-c780844c657f" class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="155">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.60</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.20</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.46</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.847990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.911</td>
<td>0.10</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.533402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.893</td>
<td>0.21</td>
<td>0.428571</td>
<td>0.281879</td>
<td>0.788751</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.911</td>
<td>0.10</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.454001</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="feature-bagging_orbit" class="level2">
<h2 class="anchored" data-anchor-id="feature-bagging_orbit">Feature Bagging_Orbit</h2>
<div id="e4d99e6d-82c0-4add-95f7-b0eab4912a05" class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> FeatureBagging(contamination<span class="op">=</span><span class="fl">0.05</span>, random_state<span class="op">=</span><span class="dv">77</span>)</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'f'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="156">
<pre><code>FeatureBagging(base_estimator=None, bootstrap_features=False,
        check_detector=True, check_estimator=False, combination='average',
        contamination=0.05, estimator_params={}, max_features=1.0,
        n_estimators=10, n_jobs=1, random_state=77, verbose=0)</code></pre>
</div>
</div>
<div id="0c8b5f0e-f21d-4291-abeb-e5574374e6d4" class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>outlier_FeatureBagging_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="13cefed9-3bc0-4653-9f83-178a7ccb9d21" class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_FeatureBagging_one)</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"Feature Bagging (Lazarevic and Kumar, 2005)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-159-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.921
Precision: 0.200
Recall: 0.204
F1 Score: 0.202</code></pre>
</div>
</div>
<div id="e5117ce9-2e61-415e-b187-644d887cd1b6" class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.921
Precision(TP / TP + FP): 0.200
Recall(TP / TP + FN): 0.204
F1 Score(2*precision*recall/precision+recall): 0.202</code></pre>
</div>
</div>
<div id="73bd7797-82dc-4208-89c3-30e8804661ce" class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="a43b7a8a-2998-4f03-a9e7-16349d97c8f7" class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">
<pre><code>0.6779973819180669</code></pre>
</div>
</div>
<div id="3bcf1946-fe26-4f4e-a363-c27753259a8c" class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="162">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.60</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.20</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.46</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.847990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.911</td>
<td>0.10</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.533402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.893</td>
<td>0.21</td>
<td>0.428571</td>
<td>0.281879</td>
<td>0.788751</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.911</td>
<td>0.10</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.454001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.921</td>
<td>0.20</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.677997</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="abod_orbit" class="level2">
<h2 class="anchored" data-anchor-id="abod_orbit">ABOD_Orbit</h2>
<div id="f2452c35-5230-4e02-a753-5cca631680cf" class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> ABOD(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'f'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="163">
<pre><code>ABOD(contamination=0.05, method='fast', n_neighbors=5)</code></pre>
</div>
</div>
<div id="0b4db9de-c9d3-47ba-8ef8-71d67bec10cf" class="cell" data-execution_count="164">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>outlier_ABOD_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="4633efd6-ffca-40d5-b304-a10c7651f2e4" class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_ABOD_one)</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"ABOD (Kriegel et al., 2008)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-166-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.951
Precision: 0.500
Recall: 0.510
F1 Score: 0.505</code></pre>
</div>
</div>
<div id="649c6cd2-35c6-4a85-80b1-c032c62da780" class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.951
Precision(TP / TP + FP): 0.500
Recall(TP / TP + FN): 0.510
F1 Score(2*precision*recall/precision+recall): 0.505</code></pre>
</div>
</div>
<div id="fe2ad4b6-55f7-422b-a496-0498a65cce51" class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="d43952b0-ec1a-4f56-a7db-c62af0207167" class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="168">
<pre><code>0.8639241185433164</code></pre>
</div>
</div>
<div id="28b0b2f8-62ad-4cfb-adb2-4042d7ef372a" class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="169">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.60</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.20</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.46</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.847990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.911</td>
<td>0.10</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.533402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.893</td>
<td>0.21</td>
<td>0.428571</td>
<td>0.281879</td>
<td>0.788751</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.911</td>
<td>0.10</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.454001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.921</td>
<td>0.20</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.677997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.951</td>
<td>0.50</td>
<td>0.510204</td>
<td>0.505051</td>
<td>0.863924</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="iforest_orbit" class="level2">
<h2 class="anchored" data-anchor-id="iforest_orbit">IForest_Orbit</h2>
<div id="b1cd1abe-d73a-4965-9463-de0aca8ceaae" class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> IForest(contamination<span class="op">=</span><span class="fl">0.05</span>,random_state<span class="op">=</span><span class="dv">77</span>)</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'f'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">
<pre><code>IForest(behaviour='old', bootstrap=False, contamination=0.05,
    max_features=1.0, max_samples='auto', n_estimators=100, n_jobs=1,
    random_state=77, verbose=0)</code></pre>
</div>
</div>
<div id="30fae4d6-1547-4d79-8cc6-ed83343c05cb" class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>outlier_IForest_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="77a8dcf4-d73b-4eb4-9012-de1b38acdd67" class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_IForest_one)</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"Isolation Forest (Liu et al., 2008)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-173-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.925
Precision: 0.240
Recall: 0.245
F1 Score: 0.242</code></pre>
</div>
</div>
<div id="a733efd0-6390-449c-a8fb-eaf90d243ef1" class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.925
Precision(TP / TP + FP): 0.240
Recall(TP / TP + FN): 0.245
F1 Score(2*precision*recall/precision+recall): 0.242</code></pre>
</div>
</div>
<div id="6375720c-5fed-4e97-a2a4-163cbafa39ff" class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/base.py:457: UserWarning: X has feature names, but IsolationForest was fitted without feature names
  warnings.warn(</code></pre>
</div>
</div>
<div id="75c5881b-8f56-49b8-9081-23a4cf749a31" class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="175">
<pre><code>0.6180175540247645</code></pre>
</div>
</div>
<div id="78d700c0-de70-4e4f-a148-7ed366213016" class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="176">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.60</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.20</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.46</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.847990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.911</td>
<td>0.10</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.533402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.893</td>
<td>0.21</td>
<td>0.428571</td>
<td>0.281879</td>
<td>0.788751</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.911</td>
<td>0.10</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.454001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.921</td>
<td>0.20</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.677997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.951</td>
<td>0.50</td>
<td>0.510204</td>
<td>0.505051</td>
<td>0.863924</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.925</td>
<td>0.24</td>
<td>0.244898</td>
<td>0.242424</td>
<td>0.618018</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="hbos_orbit" class="level2">
<h2 class="anchored" data-anchor-id="hbos_orbit">HBOS_Orbit</h2>
<div id="bc35c538-7716-47a6-8679-77a48d06fd3c" class="cell" data-execution_count="177">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> HBOS(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'f'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="177">
<pre><code>HBOS(alpha=0.1, contamination=0.05, n_bins=10, tol=0.5)</code></pre>
</div>
</div>
<div id="836770e9-cb58-4e13-b10b-23eedf713092" class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>outlier_HBOS_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="ccfb9011-3a9a-4d7e-8946-aadd8cd31c2a" class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_HBOS_one)</span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"HBOS (Goldstein and Dengel, 2012)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-180-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.921
Precision: 0.105
Recall: 0.082
F1 Score: 0.092</code></pre>
</div>
</div>
<div id="01d3f32c-5a57-42e2-8d26-9b9e4bdc83e0" class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.921
Precision(TP / TP + FP): 0.105
Recall(TP / TP + FN): 0.082
F1 Score(2*precision*recall/precision+recall): 0.092</code></pre>
</div>
</div>
<div id="e44aac5d-edfe-421f-abc0-b5407d8bb0b3" class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="c36b4394-7ec2-42ce-90fc-217844bb5f03" class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="182">
<pre><code>0.5297431275349256</code></pre>
</div>
</div>
<div id="07c033fb-d0fd-4b87-a37e-a1f8f7d298dd" class="cell" data-execution_count="183">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="183">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.600000</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.200000</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.460000</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.847990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.911</td>
<td>0.100000</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.533402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.893</td>
<td>0.210000</td>
<td>0.428571</td>
<td>0.281879</td>
<td>0.788751</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.911</td>
<td>0.100000</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.454001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.921</td>
<td>0.200000</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.677997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.951</td>
<td>0.500000</td>
<td>0.510204</td>
<td>0.505051</td>
<td>0.863924</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.925</td>
<td>0.240000</td>
<td>0.244898</td>
<td>0.242424</td>
<td>0.618018</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.921</td>
<td>0.105263</td>
<td>0.081633</td>
<td>0.091954</td>
<td>0.529743</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="sos_orbit" class="level2">
<h2 class="anchored" data-anchor-id="sos_orbit">SOS_Orbit</h2>
<div id="f954daf4-352a-4611-acba-cee8deb3cb62" class="cell" data-execution_count="184">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SOS(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'f'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="184">
<pre><code>SOS(contamination=0.05, eps=1e-05, metric='euclidean', perplexity=4.5)</code></pre>
</div>
</div>
<div id="807f5d73-7638-4647-b374-8351872a9994" class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>outlier_SOS_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="f21d05fd-90c0-4b3e-b938-fd4e22512095" class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_SOS_one)</span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"SOS (Janssens et al., 2012)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-187-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.941
Precision: 0.400
Recall: 0.408
F1 Score: 0.404</code></pre>
</div>
</div>
<div id="74146b7e-4a8f-4f06-848d-8c03ddeb66d1" class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.941
Precision(TP / TP + FP): 0.400
Recall(TP / TP + FN): 0.408
F1 Score(2*precision*recall/precision+recall): 0.404</code></pre>
</div>
</div>
<div id="713afef6-4035-4742-b776-37f1b347b712" class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="d1ca2db1-ed3b-4862-bc29-16690dfd8c98" class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="189">
<pre><code>0.8442241249812228</code></pre>
</div>
</div>
<div id="3d071f1d-bc28-4107-9888-903703b3ebd9" class="cell" data-execution_count="190">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="190">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.600000</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.200000</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.460000</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.847990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.911</td>
<td>0.100000</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.533402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.893</td>
<td>0.210000</td>
<td>0.428571</td>
<td>0.281879</td>
<td>0.788751</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.911</td>
<td>0.100000</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.454001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.921</td>
<td>0.200000</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.677997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.951</td>
<td>0.500000</td>
<td>0.510204</td>
<td>0.505051</td>
<td>0.863924</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.925</td>
<td>0.240000</td>
<td>0.244898</td>
<td>0.242424</td>
<td>0.618018</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.921</td>
<td>0.105263</td>
<td>0.081633</td>
<td>0.091954</td>
<td>0.529743</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.941</td>
<td>0.400000</td>
<td>0.408163</td>
<td>0.404040</td>
<td>0.844224</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="so_gaal_orbit" class="level2">
<h2 class="anchored" data-anchor-id="so_gaal_orbit">SO_GAAL_Orbit</h2>
<div id="8d3cb704-96d7-4c8f-a7cb-994f91ca95a9" class="cell" data-scrolled="true" data-execution_count="191">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SO_GAAL(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'f'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/keras/src/optimizers/legacy/gradient_descent.py:114: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super().__init__(name, **kwargs)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1 of 60

Testing for epoch 1 index 1:

Testing for epoch 1 index 2:
Epoch 2 of 60

Testing for epoch 2 index 1:

Testing for epoch 2 index 2:
Epoch 3 of 60

Testing for epoch 3 index 1:

Testing for epoch 3 index 2:
Epoch 4 of 60

Testing for epoch 4 index 1:

Testing for epoch 4 index 2:
Epoch 5 of 60

Testing for epoch 5 index 1:

Testing for epoch 5 index 2:
Epoch 6 of 60

Testing for epoch 6 index 1:

Testing for epoch 6 index 2:
Epoch 7 of 60

Testing for epoch 7 index 1:

Testing for epoch 7 index 2:
Epoch 8 of 60

Testing for epoch 8 index 1:

Testing for epoch 8 index 2:
Epoch 9 of 60

Testing for epoch 9 index 1:

Testing for epoch 9 index 2:
Epoch 10 of 60

Testing for epoch 10 index 1:

Testing for epoch 10 index 2:
Epoch 11 of 60

Testing for epoch 11 index 1:

Testing for epoch 11 index 2:
Epoch 12 of 60

Testing for epoch 12 index 1:

Testing for epoch 12 index 2:
Epoch 13 of 60

Testing for epoch 13 index 1:

Testing for epoch 13 index 2:
Epoch 14 of 60

Testing for epoch 14 index 1:

Testing for epoch 14 index 2:
Epoch 15 of 60

Testing for epoch 15 index 1:

Testing for epoch 15 index 2:
Epoch 16 of 60

Testing for epoch 16 index 1:

Testing for epoch 16 index 2:
Epoch 17 of 60

Testing for epoch 17 index 1:

Testing for epoch 17 index 2:
Epoch 18 of 60

Testing for epoch 18 index 1:

Testing for epoch 18 index 2:
Epoch 19 of 60

Testing for epoch 19 index 1:

Testing for epoch 19 index 2:
Epoch 20 of 60

Testing for epoch 20 index 1:

Testing for epoch 20 index 2:
Epoch 21 of 60

Testing for epoch 21 index 1:

Testing for epoch 21 index 2:
Epoch 22 of 60

Testing for epoch 22 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.2682

Testing for epoch 22 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.2809
Epoch 23 of 60

Testing for epoch 23 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.2533

Testing for epoch 23 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.2402
Epoch 24 of 60

Testing for epoch 24 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.2311

Testing for epoch 24 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.2195
Epoch 25 of 60

Testing for epoch 25 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.2273

Testing for epoch 25 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.2363
Epoch 26 of 60

Testing for epoch 26 index 1:
16/16 [==============================] - 0s 825us/step - loss: 1.2320

Testing for epoch 26 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.2487
Epoch 27 of 60

Testing for epoch 27 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.2435

Testing for epoch 27 index 2:
16/16 [==============================] - 0s 826us/step - loss: 1.2753
Epoch 28 of 60

Testing for epoch 28 index 1:
16/16 [==============================] - 0s 781us/step - loss: 1.2691

Testing for epoch 28 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.2997
Epoch 29 of 60

Testing for epoch 29 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.3105

Testing for epoch 29 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.3315
Epoch 30 of 60

Testing for epoch 30 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.3413

Testing for epoch 30 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.3642
Epoch 31 of 60

Testing for epoch 31 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.3953

Testing for epoch 31 index 2:
16/16 [==============================] - 0s 790us/step - loss: 1.4018
Epoch 32 of 60

Testing for epoch 32 index 1:
16/16 [==============================] - 0s 802us/step - loss: 1.4309

Testing for epoch 32 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.4460
Epoch 33 of 60

Testing for epoch 33 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.4762

Testing for epoch 33 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.5035
Epoch 34 of 60

Testing for epoch 34 index 1:
16/16 [==============================] - 0s 834us/step - loss: 1.5015

Testing for epoch 34 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.5210
Epoch 35 of 60

Testing for epoch 35 index 1:
16/16 [==============================] - 0s 937us/step - loss: 1.5350

Testing for epoch 35 index 2:
16/16 [==============================] - 0s 789us/step - loss: 1.5497
Epoch 36 of 60

Testing for epoch 36 index 1:
16/16 [==============================] - 0s 790us/step - loss: 1.5742

Testing for epoch 36 index 2:
16/16 [==============================] - 0s 842us/step - loss: 1.5749
Epoch 37 of 60

Testing for epoch 37 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.5844

Testing for epoch 37 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.5945
Epoch 38 of 60

Testing for epoch 38 index 1:
16/16 [==============================] - 0s 926us/step - loss: 1.6030

Testing for epoch 38 index 2:
16/16 [==============================] - 0s 866us/step - loss: 1.6226
Epoch 39 of 60

Testing for epoch 39 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.6200

Testing for epoch 39 index 2:
16/16 [==============================] - 0s 801us/step - loss: 1.6314
Epoch 40 of 60

Testing for epoch 40 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.6379

Testing for epoch 40 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.6526
Epoch 41 of 60

Testing for epoch 41 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.6465

Testing for epoch 41 index 2:
16/16 [==============================] - 0s 811us/step - loss: 1.6509
Epoch 42 of 60

Testing for epoch 42 index 1:
16/16 [==============================] - 0s 800us/step - loss: 1.6508

Testing for epoch 42 index 2:
16/16 [==============================] - 0s 799us/step - loss: 1.6638
Epoch 43 of 60

Testing for epoch 43 index 1:
16/16 [==============================] - 0s 953us/step - loss: 1.6715

Testing for epoch 43 index 2:
16/16 [==============================] - 0s 780us/step - loss: 1.6817
Epoch 44 of 60

Testing for epoch 44 index 1:
16/16 [==============================] - 0s 799us/step - loss: 1.6805

Testing for epoch 44 index 2:
16/16 [==============================] - 0s 783us/step - loss: 1.6850
Epoch 45 of 60

Testing for epoch 45 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.7113

Testing for epoch 45 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.7162
Epoch 46 of 60

Testing for epoch 46 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.7183

Testing for epoch 46 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.7208
Epoch 47 of 60

Testing for epoch 47 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.7249

Testing for epoch 47 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 1.7667
Epoch 48 of 60

Testing for epoch 48 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.7558

Testing for epoch 48 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.7659
Epoch 49 of 60

Testing for epoch 49 index 1:
16/16 [==============================] - 0s 863us/step - loss: 1.7905

Testing for epoch 49 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.8042
Epoch 50 of 60

Testing for epoch 50 index 1:
16/16 [==============================] - 0s 818us/step - loss: 1.8058

Testing for epoch 50 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.8257
Epoch 51 of 60

Testing for epoch 51 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.8315

Testing for epoch 51 index 2:
16/16 [==============================] - 0s 930us/step - loss: 1.8521
Epoch 52 of 60

Testing for epoch 52 index 1:
16/16 [==============================] - 0s 814us/step - loss: 1.8571

Testing for epoch 52 index 2:
16/16 [==============================] - 0s 815us/step - loss: 1.8628
Epoch 53 of 60

Testing for epoch 53 index 1:
16/16 [==============================] - 0s 829us/step - loss: 1.8641

Testing for epoch 53 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.8893
Epoch 54 of 60

Testing for epoch 54 index 1:
16/16 [==============================] - 0s 896us/step - loss: 1.8914

Testing for epoch 54 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.9188
Epoch 55 of 60

Testing for epoch 55 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.9080

Testing for epoch 55 index 2:
16/16 [==============================] - 0s 820us/step - loss: 1.9341
Epoch 56 of 60

Testing for epoch 56 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.9327

Testing for epoch 56 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.9627
Epoch 57 of 60

Testing for epoch 57 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.9587

Testing for epoch 57 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.9495
Epoch 58 of 60

Testing for epoch 58 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 1.9537

Testing for epoch 58 index 2:
16/16 [==============================] - 0s 878us/step - loss: 1.9898
Epoch 59 of 60

Testing for epoch 59 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.9983

Testing for epoch 59 index 2:
16/16 [==============================] - 0s 960us/step - loss: 2.0003
Epoch 60 of 60

Testing for epoch 60 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.0136

Testing for epoch 60 index 2:
16/16 [==============================] - 0s 811us/step - loss: 2.0044
32/32 [==============================] - 0s 1ms/step</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="191">
<pre><code>SO_GAAL(contamination=0.05, lr_d=0.01, lr_g=0.0001, momentum=0.9,
    stop_epochs=20)</code></pre>
</div>
</div>
<div id="c2015e85-65b0-43e7-8a53-41039613f2dd" class="cell" data-execution_count="192">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>outlier_SO_GAAL_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="60848c92-e781-45fa-a3b9-4298e5623245" class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_SO_GAAL_one)</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"SO-GAAL (Liu et al., 2019)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-194-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.951
Precision: 0.000
Recall: 0.000
F1 Score: 0.000</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))</code></pre>
</div>
</div>
<div id="8f16bf00-40d4-4b30-9a78-e144cca4c9e8" class="cell" data-execution_count="194">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.951
Precision(TP / TP + FP): nan
Recall(TP / TP + FN): 0.000
F1 Score(2*precision*recall/precision+recall): nan</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_3852735/4166638268.py:3: RuntimeWarning: invalid value encountered in long_scalars
  print('Precision(TP / TP + FP): %.3f' % round(_conf.conf_matrix[1][1]/(_conf.conf_matrix[0][1] + _conf.conf_matrix[1][1]),3))
/tmp/ipykernel_3852735/4166638268.py:5: RuntimeWarning: invalid value encountered in long_scalars
  print('F1 Score(2*precision*recall/precision+recall): %.3f' % round((2*(_conf.conf_matrix[1][1]/(_conf.conf_matrix[0][1] + _conf.conf_matrix[1][1]))*(_conf.conf_matrix[1][1]/(_conf.conf_matrix[1][0] + _conf.conf_matrix[1][1]))) / (_conf.conf_matrix[1][1]/(_conf.conf_matrix[0][1] + _conf.conf_matrix[1][1]) + _conf.conf_matrix[1][1]/(_conf.conf_matrix[1][0] + _conf.conf_matrix[1][1])),3))</code></pre>
</div>
</div>
<div id="6de6bd05-d217-43ef-a0de-debd193e24ac" class="cell" data-execution_count="195">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 0s 568us/step</code></pre>
</div>
</div>
<div id="6daec4c6-3c81-44d8-9e6b-c64d96ee34b9" class="cell" data-execution_count="196">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="196">
<pre><code>0.46434472842764857</code></pre>
</div>
</div>
<div id="59b6ba7f-b992-49ef-8f95-7ed7f917810d" class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="197">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.600000</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.200000</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.460000</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.847990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.911</td>
<td>0.100000</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.533402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.893</td>
<td>0.210000</td>
<td>0.428571</td>
<td>0.281879</td>
<td>0.788751</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.911</td>
<td>0.100000</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.454001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.921</td>
<td>0.200000</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.677997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.951</td>
<td>0.500000</td>
<td>0.510204</td>
<td>0.505051</td>
<td>0.863924</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.925</td>
<td>0.240000</td>
<td>0.244898</td>
<td>0.242424</td>
<td>0.618018</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.921</td>
<td>0.105263</td>
<td>0.081633</td>
<td>0.091954</td>
<td>0.529743</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.941</td>
<td>0.400000</td>
<td>0.408163</td>
<td>0.404040</td>
<td>0.844224</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SO-GAAL (Liu et al., 2019)</td>
<td>0.951</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.464345</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="mo_gaal_orbit" class="level2">
<h2 class="anchored" data-anchor-id="mo_gaal_orbit">MO_GAAL_Orbit</h2>
<div id="ba39060c-cb20-4621-8f15-093ca5405d08" class="cell" data-scrolled="true" data-execution_count="198">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> MO_GAAL(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'f'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/keras/src/optimizers/legacy/gradient_descent.py:114: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super().__init__(name, **kwargs)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1 of 60

Testing for epoch 1 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 1 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 2 of 60

Testing for epoch 2 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 2 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 3 of 60

Testing for epoch 3 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 3 index 2:
32/32 [==============================] - 0s 581us/step
Epoch 4 of 60

Testing for epoch 4 index 1:
32/32 [==============================] - 0s 583us/step

Testing for epoch 4 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 5 of 60

Testing for epoch 5 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 5 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 6 of 60

Testing for epoch 6 index 1:
32/32 [==============================] - 0s 561us/step

Testing for epoch 6 index 2:
32/32 [==============================] - 0s 601us/step
Epoch 7 of 60

Testing for epoch 7 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 7 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 8 of 60

Testing for epoch 8 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 8 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 9 of 60

Testing for epoch 9 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 9 index 2:
32/32 [==============================] - 0s 807us/step
Epoch 10 of 60

Testing for epoch 10 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 10 index 2:
32/32 [==============================] - 0s 575us/step
Epoch 11 of 60

Testing for epoch 11 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 11 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 12 of 60

Testing for epoch 12 index 1:
32/32 [==============================] - 0s 564us/step

Testing for epoch 12 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 13 of 60

Testing for epoch 13 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 13 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 14 of 60

Testing for epoch 14 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 14 index 2:
32/32 [==============================] - 0s 575us/step
Epoch 15 of 60

Testing for epoch 15 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 15 index 2:
32/32 [==============================] - 0s 565us/step
Epoch 16 of 60

Testing for epoch 16 index 1:
32/32 [==============================] - 0s 562us/step

Testing for epoch 16 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 17 of 60

Testing for epoch 17 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 17 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 18 of 60

Testing for epoch 18 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 18 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 19 of 60

Testing for epoch 19 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 19 index 2:
32/32 [==============================] - 0s 1ms/step
Epoch 20 of 60

Testing for epoch 20 index 1:
32/32 [==============================] - 0s 581us/step

Testing for epoch 20 index 2:
32/32 [==============================] - 0s 595us/step
Epoch 21 of 60

Testing for epoch 21 index 1:
32/32 [==============================] - 0s 1ms/step

Testing for epoch 21 index 2:
32/32 [==============================] - 0s 615us/step
16/16 [==============================] - 0s 976us/step - loss: 0.6211
16/16 [==============================] - 0s 864us/step - loss: 1.0813
16/16 [==============================] - 0s 847us/step - loss: 1.1397
16/16 [==============================] - 0s 1ms/step - loss: 1.1436
16/16 [==============================] - 0s 1ms/step - loss: 1.1446
16/16 [==============================] - 0s 979us/step - loss: 1.1448
16/16 [==============================] - 0s 2ms/step - loss: 1.1448
16/16 [==============================] - 0s 2ms/step - loss: 1.1447
16/16 [==============================] - 0s 2ms/step - loss: 1.1446
16/16 [==============================] - 0s 2ms/step - loss: 1.1446
Epoch 22 of 60

Testing for epoch 22 index 1:
32/32 [==============================] - 0s 888us/step
16/16 [==============================] - 0s 936us/step - loss: 0.6128
16/16 [==============================] - 0s 2ms/step - loss: 1.1006
16/16 [==============================] - 0s 2ms/step - loss: 1.1618
16/16 [==============================] - 0s 967us/step - loss: 1.1658
16/16 [==============================] - 0s 865us/step - loss: 1.1669
16/16 [==============================] - 0s 2ms/step - loss: 1.1671
16/16 [==============================] - 0s 1ms/step - loss: 1.1671
16/16 [==============================] - 0s 1ms/step - loss: 1.1670
16/16 [==============================] - 0s 2ms/step - loss: 1.1669
16/16 [==============================] - 0s 2ms/step - loss: 1.1669

Testing for epoch 22 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.6131
16/16 [==============================] - 0s 907us/step - loss: 1.1060
16/16 [==============================] - 0s 947us/step - loss: 1.1673
16/16 [==============================] - 0s 2ms/step - loss: 1.1713
16/16 [==============================] - 0s 916us/step - loss: 1.1723
16/16 [==============================] - 0s 983us/step - loss: 1.1725
16/16 [==============================] - 0s 2ms/step - loss: 1.1725
16/16 [==============================] - 0s 886us/step - loss: 1.1724
16/16 [==============================] - 0s 861us/step - loss: 1.1723
16/16 [==============================] - 0s 841us/step - loss: 1.1723
Epoch 23 of 60

Testing for epoch 23 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.6029
16/16 [==============================] - 0s 2ms/step - loss: 1.1322
16/16 [==============================] - 0s 897us/step - loss: 1.2002
16/16 [==============================] - 0s 1ms/step - loss: 1.2044
16/16 [==============================] - 0s 2ms/step - loss: 1.2055
16/16 [==============================] - 0s 1ms/step - loss: 1.2057
16/16 [==============================] - 0s 2ms/step - loss: 1.2057
16/16 [==============================] - 0s 2ms/step - loss: 1.2056
16/16 [==============================] - 0s 948us/step - loss: 1.2055
16/16 [==============================] - 0s 892us/step - loss: 1.2055

Testing for epoch 23 index 2:
32/32 [==============================] - 0s 826us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.6025
16/16 [==============================] - 0s 869us/step - loss: 1.1440
16/16 [==============================] - 0s 2ms/step - loss: 1.2117
16/16 [==============================] - 0s 854us/step - loss: 1.2159
16/16 [==============================] - 0s 2ms/step - loss: 1.2169
16/16 [==============================] - 0s 875us/step - loss: 1.2171
16/16 [==============================] - 0s 1ms/step - loss: 1.2171
16/16 [==============================] - 0s 2ms/step - loss: 1.2170
16/16 [==============================] - 0s 863us/step - loss: 1.2170
16/16 [==============================] - 0s 867us/step - loss: 1.2170
Epoch 24 of 60

Testing for epoch 24 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.5927
16/16 [==============================] - 0s 2ms/step - loss: 1.1665
16/16 [==============================] - 0s 998us/step - loss: 1.2374
16/16 [==============================] - 0s 823us/step - loss: 1.2419
16/16 [==============================] - 0s 934us/step - loss: 1.2430
16/16 [==============================] - 0s 829us/step - loss: 1.2432
16/16 [==============================] - 0s 2ms/step - loss: 1.2432
16/16 [==============================] - 0s 2ms/step - loss: 1.2431
16/16 [==============================] - 0s 2ms/step - loss: 1.2431
16/16 [==============================] - 0s 2ms/step - loss: 1.2431

Testing for epoch 24 index 2:
32/32 [==============================] - 0s 729us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.5934
16/16 [==============================] - 0s 1ms/step - loss: 1.1691
16/16 [==============================] - 0s 871us/step - loss: 1.2400
16/16 [==============================] - 0s 2ms/step - loss: 1.2445
16/16 [==============================] - 0s 2ms/step - loss: 1.2456
16/16 [==============================] - 0s 852us/step - loss: 1.2458
16/16 [==============================] - 0s 821us/step - loss: 1.2457
16/16 [==============================] - 0s 888us/step - loss: 1.2457
16/16 [==============================] - 0s 2ms/step - loss: 1.2456
16/16 [==============================] - 0s 848us/step - loss: 1.2456
Epoch 25 of 60

Testing for epoch 25 index 1:
32/32 [==============================] - 0s 614us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.5848
16/16 [==============================] - 0s 1ms/step - loss: 1.1934
16/16 [==============================] - 0s 2ms/step - loss: 1.2693
16/16 [==============================] - 0s 2ms/step - loss: 1.2739
16/16 [==============================] - 0s 1ms/step - loss: 1.2751
16/16 [==============================] - 0s 2ms/step - loss: 1.2753
16/16 [==============================] - 0s 2ms/step - loss: 1.2752
16/16 [==============================] - 0s 1ms/step - loss: 1.2751
16/16 [==============================] - 0s 874us/step - loss: 1.2750
16/16 [==============================] - 0s 822us/step - loss: 1.2750

Testing for epoch 25 index 2:
32/32 [==============================] - 0s 982us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.5871
16/16 [==============================] - 0s 2ms/step - loss: 1.2078
16/16 [==============================] - 0s 2ms/step - loss: 1.2829
16/16 [==============================] - 0s 2ms/step - loss: 1.2877
16/16 [==============================] - 0s 2ms/step - loss: 1.2888
16/16 [==============================] - 0s 2ms/step - loss: 1.2890
16/16 [==============================] - 0s 2ms/step - loss: 1.2890
16/16 [==============================] - 0s 2ms/step - loss: 1.2888
16/16 [==============================] - 0s 2ms/step - loss: 1.2888
16/16 [==============================] - 0s 888us/step - loss: 1.2888
Epoch 26 of 60

Testing for epoch 26 index 1:
32/32 [==============================] - 0s 606us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.5805
16/16 [==============================] - 0s 822us/step - loss: 1.2290
16/16 [==============================] - 0s 815us/step - loss: 1.3099
16/16 [==============================] - 0s 2ms/step - loss: 1.3149
16/16 [==============================] - 0s 790us/step - loss: 1.3161
16/16 [==============================] - 0s 815us/step - loss: 1.3163
16/16 [==============================] - 0s 2ms/step - loss: 1.3163
16/16 [==============================] - 0s 814us/step - loss: 1.3162
16/16 [==============================] - 0s 869us/step - loss: 1.3161
16/16 [==============================] - 0s 852us/step - loss: 1.3161

Testing for epoch 26 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.5851
16/16 [==============================] - 0s 1ms/step - loss: 1.2332
16/16 [==============================] - 0s 2ms/step - loss: 1.3115
16/16 [==============================] - 0s 824us/step - loss: 1.3164
16/16 [==============================] - 0s 1ms/step - loss: 1.3176
16/16 [==============================] - 0s 986us/step - loss: 1.3178
16/16 [==============================] - 0s 790us/step - loss: 1.3178
16/16 [==============================] - 0s 2ms/step - loss: 1.3177
16/16 [==============================] - 0s 2ms/step - loss: 1.3176
16/16 [==============================] - 0s 2ms/step - loss: 1.3176
Epoch 27 of 60

Testing for epoch 27 index 1:
32/32 [==============================] - 0s 574us/step
16/16 [==============================] - 0s 802us/step - loss: 0.5827
16/16 [==============================] - 0s 792us/step - loss: 1.2418
16/16 [==============================] - 0s 2ms/step - loss: 1.3207
16/16 [==============================] - 0s 774us/step - loss: 1.3257
16/16 [==============================] - 0s 807us/step - loss: 1.3269
16/16 [==============================] - 0s 791us/step - loss: 1.3271
16/16 [==============================] - 0s 964us/step - loss: 1.3270
16/16 [==============================] - 0s 2ms/step - loss: 1.3270
16/16 [==============================] - 0s 821us/step - loss: 1.3269
16/16 [==============================] - 0s 802us/step - loss: 1.3269

Testing for epoch 27 index 2:
32/32 [==============================] - 0s 580us/step
16/16 [==============================] - 0s 812us/step - loss: 0.5894
16/16 [==============================] - 0s 782us/step - loss: 1.2669
16/16 [==============================] - 0s 794us/step - loss: 1.3451
16/16 [==============================] - 0s 2ms/step - loss: 1.3501
16/16 [==============================] - 0s 843us/step - loss: 1.3513
16/16 [==============================] - 0s 792us/step - loss: 1.3515
16/16 [==============================] - 0s 773us/step - loss: 1.3515
16/16 [==============================] - 0s 802us/step - loss: 1.3514
16/16 [==============================] - 0s 2ms/step - loss: 1.3513
16/16 [==============================] - 0s 1ms/step - loss: 1.3513
Epoch 28 of 60

Testing for epoch 28 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 799us/step - loss: 0.5895
16/16 [==============================] - 0s 774us/step - loss: 1.2747
16/16 [==============================] - 0s 1ms/step - loss: 1.3543
16/16 [==============================] - 0s 861us/step - loss: 1.3594
16/16 [==============================] - 0s 2ms/step - loss: 1.3606
16/16 [==============================] - 0s 801us/step - loss: 1.3607
16/16 [==============================] - 0s 803us/step - loss: 1.3607
16/16 [==============================] - 0s 779us/step - loss: 1.3606
16/16 [==============================] - 0s 786us/step - loss: 1.3606
16/16 [==============================] - 0s 2ms/step - loss: 1.3605

Testing for epoch 28 index 2:
32/32 [==============================] - 0s 584us/step
16/16 [==============================] - 0s 820us/step - loss: 0.6016
16/16 [==============================] - 0s 2ms/step - loss: 1.2951
16/16 [==============================] - 0s 2ms/step - loss: 1.3737
16/16 [==============================] - 0s 2ms/step - loss: 1.3786
16/16 [==============================] - 0s 849us/step - loss: 1.3798
16/16 [==============================] - 0s 1ms/step - loss: 1.3800
16/16 [==============================] - 0s 853us/step - loss: 1.3799
16/16 [==============================] - 0s 980us/step - loss: 1.3798
16/16 [==============================] - 0s 2ms/step - loss: 1.3798
16/16 [==============================] - 0s 880us/step - loss: 1.3797
Epoch 29 of 60

Testing for epoch 29 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.6046
16/16 [==============================] - 0s 2ms/step - loss: 1.2864
16/16 [==============================] - 0s 1ms/step - loss: 1.3632
16/16 [==============================] - 0s 1ms/step - loss: 1.3680
16/16 [==============================] - 0s 804us/step - loss: 1.3690
16/16 [==============================] - 0s 2ms/step - loss: 1.3692
16/16 [==============================] - 0s 810us/step - loss: 1.3692
16/16 [==============================] - 0s 848us/step - loss: 1.3691
16/16 [==============================] - 0s 859us/step - loss: 1.3690
16/16 [==============================] - 0s 1ms/step - loss: 1.3690

Testing for epoch 29 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.6195
16/16 [==============================] - 0s 2ms/step - loss: 1.3102
16/16 [==============================] - 0s 2ms/step - loss: 1.3850
16/16 [==============================] - 0s 2ms/step - loss: 1.3898
16/16 [==============================] - 0s 2ms/step - loss: 1.3909
16/16 [==============================] - 0s 890us/step - loss: 1.3910
16/16 [==============================] - 0s 1ms/step - loss: 1.3910
16/16 [==============================] - 0s 789us/step - loss: 1.3909
16/16 [==============================] - 0s 783us/step - loss: 1.3908
16/16 [==============================] - 0s 773us/step - loss: 1.3908
Epoch 30 of 60

Testing for epoch 30 index 1:
32/32 [==============================] - 0s 608us/step
16/16 [==============================] - 0s 810us/step - loss: 0.6259
16/16 [==============================] - 0s 782us/step - loss: 1.3218
16/16 [==============================] - 0s 819us/step - loss: 1.3959
16/16 [==============================] - 0s 941us/step - loss: 1.4007
16/16 [==============================] - 0s 1ms/step - loss: 1.4018
16/16 [==============================] - 0s 2ms/step - loss: 1.4020
16/16 [==============================] - 0s 2ms/step - loss: 1.4020
16/16 [==============================] - 0s 2ms/step - loss: 1.4019
16/16 [==============================] - 0s 2ms/step - loss: 1.4018
16/16 [==============================] - 0s 2ms/step - loss: 1.4018

Testing for epoch 30 index 2:
32/32 [==============================] - 0s 568us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.6424
16/16 [==============================] - 0s 790us/step - loss: 1.3256
16/16 [==============================] - 0s 804us/step - loss: 1.3954
16/16 [==============================] - 0s 783us/step - loss: 1.4000
16/16 [==============================] - 0s 789us/step - loss: 1.4011
16/16 [==============================] - 0s 794us/step - loss: 1.4012
16/16 [==============================] - 0s 799us/step - loss: 1.4012
16/16 [==============================] - 0s 1ms/step - loss: 1.4011
16/16 [==============================] - 0s 2ms/step - loss: 1.4010
16/16 [==============================] - 0s 974us/step - loss: 1.4010
Epoch 31 of 60

Testing for epoch 31 index 1:
32/32 [==============================] - 0s 977us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.6505
16/16 [==============================] - 0s 2ms/step - loss: 1.3458
16/16 [==============================] - 0s 2ms/step - loss: 1.4158
16/16 [==============================] - 0s 2ms/step - loss: 1.4204
16/16 [==============================] - 0s 2ms/step - loss: 1.4214
16/16 [==============================] - 0s 2ms/step - loss: 1.4216
16/16 [==============================] - 0s 2ms/step - loss: 1.4216
16/16 [==============================] - 0s 2ms/step - loss: 1.4215
16/16 [==============================] - 0s 2ms/step - loss: 1.4214
16/16 [==============================] - 0s 878us/step - loss: 1.4214

Testing for epoch 31 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.6688
16/16 [==============================] - 0s 2ms/step - loss: 1.3557
16/16 [==============================] - 0s 1ms/step - loss: 1.4234
16/16 [==============================] - 0s 1ms/step - loss: 1.4278
16/16 [==============================] - 0s 2ms/step - loss: 1.4288
16/16 [==============================] - 0s 2ms/step - loss: 1.4289
16/16 [==============================] - 0s 2ms/step - loss: 1.4289
16/16 [==============================] - 0s 825us/step - loss: 1.4288
16/16 [==============================] - 0s 2ms/step - loss: 1.4287
16/16 [==============================] - 0s 2ms/step - loss: 1.4287
Epoch 32 of 60

Testing for epoch 32 index 1:
32/32 [==============================] - 0s 564us/step
16/16 [==============================] - 0s 807us/step - loss: 0.6780
16/16 [==============================] - 0s 814us/step - loss: 1.3703
16/16 [==============================] - 0s 2ms/step - loss: 1.4374
16/16 [==============================] - 0s 2ms/step - loss: 1.4417
16/16 [==============================] - 0s 865us/step - loss: 1.4426
16/16 [==============================] - 0s 813us/step - loss: 1.4428
16/16 [==============================] - 0s 800us/step - loss: 1.4427
16/16 [==============================] - 0s 807us/step - loss: 1.4426
16/16 [==============================] - 0s 828us/step - loss: 1.4425
16/16 [==============================] - 0s 852us/step - loss: 1.4425

Testing for epoch 32 index 2:
32/32 [==============================] - 0s 591us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.6965
16/16 [==============================] - 0s 2ms/step - loss: 1.3779
16/16 [==============================] - 0s 2ms/step - loss: 1.4427
16/16 [==============================] - 0s 844us/step - loss: 1.4469
16/16 [==============================] - 0s 813us/step - loss: 1.4479
16/16 [==============================] - 0s 801us/step - loss: 1.4480
16/16 [==============================] - 0s 1ms/step - loss: 1.4480
16/16 [==============================] - 0s 2ms/step - loss: 1.4478
16/16 [==============================] - 0s 814us/step - loss: 1.4477
16/16 [==============================] - 0s 804us/step - loss: 1.4477
Epoch 33 of 60

Testing for epoch 33 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.7056
16/16 [==============================] - 0s 1ms/step - loss: 1.3908
16/16 [==============================] - 0s 989us/step - loss: 1.4549
16/16 [==============================] - 0s 2ms/step - loss: 1.4591
16/16 [==============================] - 0s 791us/step - loss: 1.4600
16/16 [==============================] - 0s 2ms/step - loss: 1.4602
16/16 [==============================] - 0s 1ms/step - loss: 1.4601
16/16 [==============================] - 0s 2ms/step - loss: 1.4600
16/16 [==============================] - 0s 2ms/step - loss: 1.4599
16/16 [==============================] - 0s 834us/step - loss: 1.4599

Testing for epoch 33 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.7234
16/16 [==============================] - 0s 1ms/step - loss: 1.3958
16/16 [==============================] - 0s 2ms/step - loss: 1.4578
16/16 [==============================] - 0s 2ms/step - loss: 1.4617
16/16 [==============================] - 0s 880us/step - loss: 1.4626
16/16 [==============================] - 0s 848us/step - loss: 1.4628
16/16 [==============================] - 0s 2ms/step - loss: 1.4627
16/16 [==============================] - 0s 782us/step - loss: 1.4626
16/16 [==============================] - 0s 758us/step - loss: 1.4625
16/16 [==============================] - 0s 814us/step - loss: 1.4625
Epoch 34 of 60

Testing for epoch 34 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.7344
16/16 [==============================] - 0s 841us/step - loss: 1.4243
16/16 [==============================] - 0s 805us/step - loss: 1.4870
16/16 [==============================] - 0s 2ms/step - loss: 1.4910
16/16 [==============================] - 0s 1ms/step - loss: 1.4919
16/16 [==============================] - 0s 1ms/step - loss: 1.4921
16/16 [==============================] - 0s 969us/step - loss: 1.4920
16/16 [==============================] - 0s 801us/step - loss: 1.4919
16/16 [==============================] - 0s 809us/step - loss: 1.4918
16/16 [==============================] - 0s 796us/step - loss: 1.4918

Testing for epoch 34 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 822us/step - loss: 0.7494
16/16 [==============================] - 0s 1ms/step - loss: 1.4233
16/16 [==============================] - 0s 846us/step - loss: 1.4838
16/16 [==============================] - 0s 1ms/step - loss: 1.4875
16/16 [==============================] - 0s 2ms/step - loss: 1.4883
16/16 [==============================] - 0s 2ms/step - loss: 1.4885
16/16 [==============================] - 0s 1ms/step - loss: 1.4884
16/16 [==============================] - 0s 2ms/step - loss: 1.4883
16/16 [==============================] - 0s 1ms/step - loss: 1.4882
16/16 [==============================] - 0s 2ms/step - loss: 1.4882
Epoch 35 of 60

Testing for epoch 35 index 1:
32/32 [==============================] - 0s 617us/step
16/16 [==============================] - 0s 780us/step - loss: 0.7594
16/16 [==============================] - 0s 785us/step - loss: 1.4475
16/16 [==============================] - 0s 786us/step - loss: 1.5084
16/16 [==============================] - 0s 790us/step - loss: 1.5122
16/16 [==============================] - 0s 2ms/step - loss: 1.5131
16/16 [==============================] - 0s 1ms/step - loss: 1.5132
16/16 [==============================] - 0s 2ms/step - loss: 1.5132
16/16 [==============================] - 0s 805us/step - loss: 1.5131
16/16 [==============================] - 0s 861us/step - loss: 1.5130
16/16 [==============================] - 0s 816us/step - loss: 1.5130

Testing for epoch 35 index 2:
32/32 [==============================] - 0s 574us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.7732
16/16 [==============================] - 0s 953us/step - loss: 1.4459
16/16 [==============================] - 0s 2ms/step - loss: 1.5047
16/16 [==============================] - 0s 1ms/step - loss: 1.5082
16/16 [==============================] - 0s 2ms/step - loss: 1.5090
16/16 [==============================] - 0s 2ms/step - loss: 1.5092
16/16 [==============================] - 0s 1ms/step - loss: 1.5091
16/16 [==============================] - 0s 2ms/step - loss: 1.5090
16/16 [==============================] - 0s 2ms/step - loss: 1.5089
16/16 [==============================] - 0s 2ms/step - loss: 1.5089
Epoch 36 of 60

Testing for epoch 36 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.7800
16/16 [==============================] - 0s 2ms/step - loss: 1.4588
16/16 [==============================] - 0s 2ms/step - loss: 1.5175
16/16 [==============================] - 0s 1ms/step - loss: 1.5209
16/16 [==============================] - 0s 832us/step - loss: 1.5218
16/16 [==============================] - 0s 2ms/step - loss: 1.5219
16/16 [==============================] - 0s 2ms/step - loss: 1.5219
16/16 [==============================] - 0s 869us/step - loss: 1.5217
16/16 [==============================] - 0s 875us/step - loss: 1.5216
16/16 [==============================] - 0s 791us/step - loss: 1.5216

Testing for epoch 36 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.7930
16/16 [==============================] - 0s 861us/step - loss: 1.4608
16/16 [==============================] - 0s 2ms/step - loss: 1.5175
16/16 [==============================] - 0s 932us/step - loss: 1.5209
16/16 [==============================] - 0s 827us/step - loss: 1.5217
16/16 [==============================] - 0s 2ms/step - loss: 1.5218
16/16 [==============================] - 0s 2ms/step - loss: 1.5218
16/16 [==============================] - 0s 2ms/step - loss: 1.5216
16/16 [==============================] - 0s 845us/step - loss: 1.5215
16/16 [==============================] - 0s 797us/step - loss: 1.5215
Epoch 37 of 60

Testing for epoch 37 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.8025
16/16 [==============================] - 0s 1ms/step - loss: 1.4900
16/16 [==============================] - 0s 815us/step - loss: 1.5481
16/16 [==============================] - 0s 2ms/step - loss: 1.5516
16/16 [==============================] - 0s 1ms/step - loss: 1.5524
16/16 [==============================] - 0s 802us/step - loss: 1.5526
16/16 [==============================] - 0s 2ms/step - loss: 1.5526
16/16 [==============================] - 0s 825us/step - loss: 1.5524
16/16 [==============================] - 0s 794us/step - loss: 1.5524
16/16 [==============================] - 0s 2ms/step - loss: 1.5523

Testing for epoch 37 index 2:
32/32 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.8189
16/16 [==============================] - 0s 1ms/step - loss: 1.5094
16/16 [==============================] - 0s 987us/step - loss: 1.5667
16/16 [==============================] - 0s 863us/step - loss: 1.5701
16/16 [==============================] - 0s 2ms/step - loss: 1.5710
16/16 [==============================] - 0s 2ms/step - loss: 1.5712
16/16 [==============================] - 0s 2ms/step - loss: 1.5711
16/16 [==============================] - 0s 2ms/step - loss: 1.5710
16/16 [==============================] - 0s 2ms/step - loss: 1.5709
16/16 [==============================] - 0s 938us/step - loss: 1.5709
Epoch 38 of 60

Testing for epoch 38 index 1:
32/32 [==============================] - 0s 745us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.8213
16/16 [==============================] - 0s 784us/step - loss: 1.5145
16/16 [==============================] - 0s 802us/step - loss: 1.5717
16/16 [==============================] - 0s 941us/step - loss: 1.5751
16/16 [==============================] - 0s 784us/step - loss: 1.5759
16/16 [==============================] - 0s 2ms/step - loss: 1.5761
16/16 [==============================] - 0s 823us/step - loss: 1.5760
16/16 [==============================] - 0s 956us/step - loss: 1.5759
16/16 [==============================] - 0s 2ms/step - loss: 1.5758
16/16 [==============================] - 0s 1ms/step - loss: 1.5758

Testing for epoch 38 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 840us/step - loss: 0.8398
16/16 [==============================] - 0s 813us/step - loss: 1.5413
16/16 [==============================] - 0s 2ms/step - loss: 1.5982
16/16 [==============================] - 0s 1ms/step - loss: 1.6017
16/16 [==============================] - 0s 2ms/step - loss: 1.6026
16/16 [==============================] - 0s 2ms/step - loss: 1.6027
16/16 [==============================] - 0s 2ms/step - loss: 1.6027
16/16 [==============================] - 0s 936us/step - loss: 1.6025
16/16 [==============================] - 0s 887us/step - loss: 1.6024
16/16 [==============================] - 0s 2ms/step - loss: 1.6024
Epoch 39 of 60

Testing for epoch 39 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 856us/step - loss: 0.8385
16/16 [==============================] - 0s 936us/step - loss: 1.5376
16/16 [==============================] - 0s 2ms/step - loss: 1.5940
16/16 [==============================] - 0s 2ms/step - loss: 1.5974
16/16 [==============================] - 0s 1ms/step - loss: 1.5982
16/16 [==============================] - 0s 2ms/step - loss: 1.5984
16/16 [==============================] - 0s 837us/step - loss: 1.5983
16/16 [==============================] - 0s 2ms/step - loss: 1.5982
16/16 [==============================] - 0s 1ms/step - loss: 1.5981
16/16 [==============================] - 0s 868us/step - loss: 1.5981

Testing for epoch 39 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.8519
16/16 [==============================] - 0s 923us/step - loss: 1.5491
16/16 [==============================] - 0s 2ms/step - loss: 1.6051
16/16 [==============================] - 0s 1ms/step - loss: 1.6085
16/16 [==============================] - 0s 2ms/step - loss: 1.6094
16/16 [==============================] - 0s 2ms/step - loss: 1.6095
16/16 [==============================] - 0s 2ms/step - loss: 1.6095
16/16 [==============================] - 0s 2ms/step - loss: 1.6093
16/16 [==============================] - 0s 879us/step - loss: 1.6093
16/16 [==============================] - 0s 832us/step - loss: 1.6092
Epoch 40 of 60

Testing for epoch 40 index 1:
32/32 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.8560
16/16 [==============================] - 0s 2ms/step - loss: 1.5641
16/16 [==============================] - 0s 849us/step - loss: 1.6209
16/16 [==============================] - 0s 886us/step - loss: 1.6243
16/16 [==============================] - 0s 2ms/step - loss: 1.6252
16/16 [==============================] - 0s 2ms/step - loss: 1.6253
16/16 [==============================] - 0s 872us/step - loss: 1.6253
16/16 [==============================] - 0s 1ms/step - loss: 1.6252
16/16 [==============================] - 0s 1ms/step - loss: 1.6251
16/16 [==============================] - 0s 2ms/step - loss: 1.6251

Testing for epoch 40 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 821us/step - loss: 0.8741
16/16 [==============================] - 0s 940us/step - loss: 1.5890
16/16 [==============================] - 0s 1ms/step - loss: 1.6459
16/16 [==============================] - 0s 1ms/step - loss: 1.6493
16/16 [==============================] - 0s 2ms/step - loss: 1.6501
16/16 [==============================] - 0s 914us/step - loss: 1.6503
16/16 [==============================] - 0s 810us/step - loss: 1.6502
16/16 [==============================] - 0s 811us/step - loss: 1.6501
16/16 [==============================] - 0s 2ms/step - loss: 1.6500
16/16 [==============================] - 0s 809us/step - loss: 1.6500
Epoch 41 of 60

Testing for epoch 41 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 799us/step - loss: 0.8705
16/16 [==============================] - 0s 2ms/step - loss: 1.5800
16/16 [==============================] - 0s 2ms/step - loss: 1.6359
16/16 [==============================] - 0s 824us/step - loss: 1.6392
16/16 [==============================] - 0s 2ms/step - loss: 1.6400
16/16 [==============================] - 0s 900us/step - loss: 1.6402
16/16 [==============================] - 0s 2ms/step - loss: 1.6401
16/16 [==============================] - 0s 800us/step - loss: 1.6400
16/16 [==============================] - 0s 759us/step - loss: 1.6399
16/16 [==============================] - 0s 774us/step - loss: 1.6399

Testing for epoch 41 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.8865
16/16 [==============================] - 0s 844us/step - loss: 1.5977
16/16 [==============================] - 0s 813us/step - loss: 1.6532
16/16 [==============================] - 0s 2ms/step - loss: 1.6564
16/16 [==============================] - 0s 811us/step - loss: 1.6572
16/16 [==============================] - 0s 782us/step - loss: 1.6573
16/16 [==============================] - 0s 772us/step - loss: 1.6573
16/16 [==============================] - 0s 1ms/step - loss: 1.6572
16/16 [==============================] - 0s 786us/step - loss: 1.6571
16/16 [==============================] - 0s 783us/step - loss: 1.6570
Epoch 42 of 60

Testing for epoch 42 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.8909
16/16 [==============================] - 0s 1ms/step - loss: 1.6130
16/16 [==============================] - 0s 1ms/step - loss: 1.6692
16/16 [==============================] - 0s 1ms/step - loss: 1.6724
16/16 [==============================] - 0s 811us/step - loss: 1.6733
16/16 [==============================] - 0s 2ms/step - loss: 1.6734
16/16 [==============================] - 0s 800us/step - loss: 1.6734
16/16 [==============================] - 0s 2ms/step - loss: 1.6733
16/16 [==============================] - 0s 805us/step - loss: 1.6732
16/16 [==============================] - 0s 760us/step - loss: 1.6732

Testing for epoch 42 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.9051
16/16 [==============================] - 0s 842us/step - loss: 1.6254
16/16 [==============================] - 0s 785us/step - loss: 1.6811
16/16 [==============================] - 0s 796us/step - loss: 1.6842
16/16 [==============================] - 0s 1ms/step - loss: 1.6851
16/16 [==============================] - 0s 2ms/step - loss: 1.6852
16/16 [==============================] - 0s 787us/step - loss: 1.6852
16/16 [==============================] - 0s 761us/step - loss: 1.6850
16/16 [==============================] - 0s 780us/step - loss: 1.6849
16/16 [==============================] - 0s 799us/step - loss: 1.6849
Epoch 43 of 60

Testing for epoch 43 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 828us/step - loss: 0.9117
16/16 [==============================] - 0s 951us/step - loss: 1.6455
16/16 [==============================] - 0s 2ms/step - loss: 1.7019
16/16 [==============================] - 0s 803us/step - loss: 1.7050
16/16 [==============================] - 0s 2ms/step - loss: 1.7059
16/16 [==============================] - 0s 2ms/step - loss: 1.7060
16/16 [==============================] - 0s 965us/step - loss: 1.7060
16/16 [==============================] - 0s 757us/step - loss: 1.7058
16/16 [==============================] - 0s 776us/step - loss: 1.7057
16/16 [==============================] - 0s 758us/step - loss: 1.7057

Testing for epoch 43 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 802us/step - loss: 0.9275
16/16 [==============================] - 0s 2ms/step - loss: 1.6609
16/16 [==============================] - 0s 843us/step - loss: 1.7168
16/16 [==============================] - 0s 785us/step - loss: 1.7199
16/16 [==============================] - 0s 800us/step - loss: 1.7208
16/16 [==============================] - 0s 1ms/step - loss: 1.7209
16/16 [==============================] - 0s 2ms/step - loss: 1.7209
16/16 [==============================] - 0s 855us/step - loss: 1.7208
16/16 [==============================] - 0s 812us/step - loss: 1.7207
16/16 [==============================] - 0s 803us/step - loss: 1.7207
Epoch 44 of 60

Testing for epoch 44 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 809us/step - loss: 0.9290
16/16 [==============================] - 0s 775us/step - loss: 1.6631
16/16 [==============================] - 0s 759us/step - loss: 1.7187
16/16 [==============================] - 0s 814us/step - loss: 1.7217
16/16 [==============================] - 0s 807us/step - loss: 1.7225
16/16 [==============================] - 0s 796us/step - loss: 1.7227
16/16 [==============================] - 0s 2ms/step - loss: 1.7226
16/16 [==============================] - 0s 1ms/step - loss: 1.7225
16/16 [==============================] - 0s 811us/step - loss: 1.7224
16/16 [==============================] - 0s 1ms/step - loss: 1.7224

Testing for epoch 44 index 2:
32/32 [==============================] - 0s 584us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.9455
16/16 [==============================] - 0s 1ms/step - loss: 1.6770
16/16 [==============================] - 0s 812us/step - loss: 1.7319
16/16 [==============================] - 0s 800us/step - loss: 1.7349
16/16 [==============================] - 0s 2ms/step - loss: 1.7358
16/16 [==============================] - 0s 2ms/step - loss: 1.7359
16/16 [==============================] - 0s 887us/step - loss: 1.7359
16/16 [==============================] - 0s 2ms/step - loss: 1.7358
16/16 [==============================] - 0s 2ms/step - loss: 1.7357
16/16 [==============================] - 0s 2ms/step - loss: 1.7357
Epoch 45 of 60

Testing for epoch 45 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 870us/step - loss: 0.9540
16/16 [==============================] - 0s 1ms/step - loss: 1.6976
16/16 [==============================] - 0s 2ms/step - loss: 1.7538
16/16 [==============================] - 0s 2ms/step - loss: 1.7569
16/16 [==============================] - 0s 2ms/step - loss: 1.7578
16/16 [==============================] - 0s 2ms/step - loss: 1.7580
16/16 [==============================] - 0s 2ms/step - loss: 1.7579
16/16 [==============================] - 0s 2ms/step - loss: 1.7578
16/16 [==============================] - 0s 2ms/step - loss: 1.7577
16/16 [==============================] - 0s 2ms/step - loss: 1.7577

Testing for epoch 45 index 2:
32/32 [==============================] - 0s 564us/step
16/16 [==============================] - 0s 787us/step - loss: 0.9649
16/16 [==============================] - 0s 790us/step - loss: 1.6943
16/16 [==============================] - 0s 2ms/step - loss: 1.7489
16/16 [==============================] - 0s 809us/step - loss: 1.7519
16/16 [==============================] - 0s 2ms/step - loss: 1.7527
16/16 [==============================] - 0s 2ms/step - loss: 1.7528
16/16 [==============================] - 0s 2ms/step - loss: 1.7528
16/16 [==============================] - 0s 2ms/step - loss: 1.7526
16/16 [==============================] - 0s 943us/step - loss: 1.7525
16/16 [==============================] - 0s 2ms/step - loss: 1.7525
Epoch 46 of 60

Testing for epoch 46 index 1:
32/32 [==============================] - 0s 876us/step
16/16 [==============================] - 0s 788us/step - loss: 0.9785
16/16 [==============================] - 0s 773us/step - loss: 1.7240
16/16 [==============================] - 0s 1ms/step - loss: 1.7800
16/16 [==============================] - 0s 2ms/step - loss: 1.7831
16/16 [==============================] - 0s 2ms/step - loss: 1.7839
16/16 [==============================] - 0s 859us/step - loss: 1.7840
16/16 [==============================] - 0s 773us/step - loss: 1.7840
16/16 [==============================] - 0s 2ms/step - loss: 1.7839
16/16 [==============================] - 0s 799us/step - loss: 1.7838
16/16 [==============================] - 0s 787us/step - loss: 1.7837

Testing for epoch 46 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.9940
16/16 [==============================] - 0s 2ms/step - loss: 1.7282
16/16 [==============================] - 0s 2ms/step - loss: 1.7828
16/16 [==============================] - 0s 982us/step - loss: 1.7858
16/16 [==============================] - 0s 894us/step - loss: 1.7866
16/16 [==============================] - 0s 809us/step - loss: 1.7867
16/16 [==============================] - 0s 2ms/step - loss: 1.7867
16/16 [==============================] - 0s 876us/step - loss: 1.7865
16/16 [==============================] - 0s 1ms/step - loss: 1.7864
16/16 [==============================] - 0s 2ms/step - loss: 1.7864
Epoch 47 of 60

Testing for epoch 47 index 1:
32/32 [==============================] - 0s 745us/step
16/16 [==============================] - 0s 2ms/step - loss: 1.0030
16/16 [==============================] - 0s 811us/step - loss: 1.7424
16/16 [==============================] - 0s 1ms/step - loss: 1.7977
16/16 [==============================] - 0s 2ms/step - loss: 1.8007
16/16 [==============================] - 0s 1ms/step - loss: 1.8015
16/16 [==============================] - 0s 827us/step - loss: 1.8017
16/16 [==============================] - 0s 2ms/step - loss: 1.8016
16/16 [==============================] - 0s 808us/step - loss: 1.8015
16/16 [==============================] - 0s 776us/step - loss: 1.8014
16/16 [==============================] - 0s 2ms/step - loss: 1.8014

Testing for epoch 47 index 2:
32/32 [==============================] - 0s 581us/step
16/16 [==============================] - 0s 784us/step - loss: 1.0184
16/16 [==============================] - 0s 2ms/step - loss: 1.7455
16/16 [==============================] - 0s 842us/step - loss: 1.7992
16/16 [==============================] - 0s 2ms/step - loss: 1.8021
16/16 [==============================] - 0s 827us/step - loss: 1.8028
16/16 [==============================] - 0s 2ms/step - loss: 1.8030
16/16 [==============================] - 0s 796us/step - loss: 1.8029
16/16 [==============================] - 0s 2ms/step - loss: 1.8028
16/16 [==============================] - 0s 2ms/step - loss: 1.8027
16/16 [==============================] - 0s 843us/step - loss: 1.8026
Epoch 48 of 60

Testing for epoch 48 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 791us/step - loss: 1.0233
16/16 [==============================] - 0s 788us/step - loss: 1.7481
16/16 [==============================] - 0s 772us/step - loss: 1.8019
16/16 [==============================] - 0s 2ms/step - loss: 1.8047
16/16 [==============================] - 0s 2ms/step - loss: 1.8055
16/16 [==============================] - 0s 2ms/step - loss: 1.8056
16/16 [==============================] - 0s 2ms/step - loss: 1.8056
16/16 [==============================] - 0s 2ms/step - loss: 1.8054
16/16 [==============================] - 0s 873us/step - loss: 1.8053
16/16 [==============================] - 0s 2ms/step - loss: 1.8053

Testing for epoch 48 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 843us/step - loss: 1.0415
16/16 [==============================] - 0s 879us/step - loss: 1.7551
16/16 [==============================] - 0s 1ms/step - loss: 1.8074
16/16 [==============================] - 0s 2ms/step - loss: 1.8102
16/16 [==============================] - 0s 1ms/step - loss: 1.8109
16/16 [==============================] - 0s 2ms/step - loss: 1.8110
16/16 [==============================] - 0s 2ms/step - loss: 1.8110
16/16 [==============================] - 0s 1ms/step - loss: 1.8108
16/16 [==============================] - 0s 2ms/step - loss: 1.8107
16/16 [==============================] - 0s 2ms/step - loss: 1.8107
Epoch 49 of 60

Testing for epoch 49 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 794us/step - loss: 1.0581
16/16 [==============================] - 0s 1ms/step - loss: 1.7845
16/16 [==============================] - 0s 864us/step - loss: 1.8379
16/16 [==============================] - 0s 913us/step - loss: 1.8407
16/16 [==============================] - 0s 2ms/step - loss: 1.8415
16/16 [==============================] - 0s 830us/step - loss: 1.8416
16/16 [==============================] - 0s 2ms/step - loss: 1.8416
16/16 [==============================] - 0s 950us/step - loss: 1.8414
16/16 [==============================] - 0s 1ms/step - loss: 1.8413
16/16 [==============================] - 0s 2ms/step - loss: 1.8413

Testing for epoch 49 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 972us/step - loss: 1.0727
16/16 [==============================] - 0s 2ms/step - loss: 1.7840
16/16 [==============================] - 0s 955us/step - loss: 1.8360
16/16 [==============================] - 0s 792us/step - loss: 1.8388
16/16 [==============================] - 0s 2ms/step - loss: 1.8395
16/16 [==============================] - 0s 2ms/step - loss: 1.8397
16/16 [==============================] - 0s 2ms/step - loss: 1.8396
16/16 [==============================] - 0s 894us/step - loss: 1.8395
16/16 [==============================] - 0s 2ms/step - loss: 1.8394
16/16 [==============================] - 0s 2ms/step - loss: 1.8394
Epoch 50 of 60

Testing for epoch 50 index 1:
32/32 [==============================] - 0s 612us/step
16/16 [==============================] - 0s 814us/step - loss: 1.0911
16/16 [==============================] - 0s 799us/step - loss: 1.8158
16/16 [==============================] - 0s 792us/step - loss: 1.8689
16/16 [==============================] - 0s 832us/step - loss: 1.8717
16/16 [==============================] - 0s 2ms/step - loss: 1.8724
16/16 [==============================] - 0s 2ms/step - loss: 1.8725
16/16 [==============================] - 0s 805us/step - loss: 1.8725
16/16 [==============================] - 0s 2ms/step - loss: 1.8724
16/16 [==============================] - 0s 2ms/step - loss: 1.8723
16/16 [==============================] - 0s 2ms/step - loss: 1.8722

Testing for epoch 50 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 852us/step - loss: 1.1092
16/16 [==============================] - 0s 2ms/step - loss: 1.8231
16/16 [==============================] - 0s 788us/step - loss: 1.8750
16/16 [==============================] - 0s 805us/step - loss: 1.8778
16/16 [==============================] - 0s 2ms/step - loss: 1.8785
16/16 [==============================] - 0s 884us/step - loss: 1.8786
16/16 [==============================] - 0s 2ms/step - loss: 1.8786
16/16 [==============================] - 0s 2ms/step - loss: 1.8785
16/16 [==============================] - 0s 853us/step - loss: 1.8784
16/16 [==============================] - 0s 805us/step - loss: 1.8784
Epoch 51 of 60

Testing for epoch 51 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 848us/step - loss: 1.1099
16/16 [==============================] - 0s 2ms/step - loss: 1.8169
16/16 [==============================] - 0s 2ms/step - loss: 1.8684
16/16 [==============================] - 0s 2ms/step - loss: 1.8711
16/16 [==============================] - 0s 894us/step - loss: 1.8718
16/16 [==============================] - 0s 1ms/step - loss: 1.8720
16/16 [==============================] - 0s 1ms/step - loss: 1.8719
16/16 [==============================] - 0s 1ms/step - loss: 1.8718
16/16 [==============================] - 0s 1ms/step - loss: 1.8718
16/16 [==============================] - 0s 2ms/step - loss: 1.8717

Testing for epoch 51 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 1.1318
16/16 [==============================] - 0s 939us/step - loss: 1.8340
16/16 [==============================] - 0s 2ms/step - loss: 1.8847
16/16 [==============================] - 0s 904us/step - loss: 1.8874
16/16 [==============================] - 0s 854us/step - loss: 1.8880
16/16 [==============================] - 0s 894us/step - loss: 1.8882
16/16 [==============================] - 0s 2ms/step - loss: 1.8882
16/16 [==============================] - 0s 981us/step - loss: 1.8880
16/16 [==============================] - 0s 2ms/step - loss: 1.8879
16/16 [==============================] - 0s 951us/step - loss: 1.8879
Epoch 52 of 60

Testing for epoch 52 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 933us/step - loss: 1.1444
16/16 [==============================] - 0s 1ms/step - loss: 1.8546
16/16 [==============================] - 0s 2ms/step - loss: 1.9062
16/16 [==============================] - 0s 2ms/step - loss: 1.9089
16/16 [==============================] - 0s 2ms/step - loss: 1.9096
16/16 [==============================] - 0s 2ms/step - loss: 1.9097
16/16 [==============================] - 0s 2ms/step - loss: 1.9097
16/16 [==============================] - 0s 935us/step - loss: 1.9096
16/16 [==============================] - 0s 2ms/step - loss: 1.9095
16/16 [==============================] - 0s 2ms/step - loss: 1.9095

Testing for epoch 52 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 1.1574
16/16 [==============================] - 0s 912us/step - loss: 1.8545
16/16 [==============================] - 0s 1ms/step - loss: 1.9046
16/16 [==============================] - 0s 2ms/step - loss: 1.9072
16/16 [==============================] - 0s 779us/step - loss: 1.9078
16/16 [==============================] - 0s 782us/step - loss: 1.9079
16/16 [==============================] - 0s 1ms/step - loss: 1.9079
16/16 [==============================] - 0s 994us/step - loss: 1.9077
16/16 [==============================] - 0s 2ms/step - loss: 1.9076
16/16 [==============================] - 0s 2ms/step - loss: 1.9076
Epoch 53 of 60

Testing for epoch 53 index 1:
32/32 [==============================] - 0s 920us/step
16/16 [==============================] - 0s 2ms/step - loss: 1.1652
16/16 [==============================] - 0s 2ms/step - loss: 1.8650
16/16 [==============================] - 0s 2ms/step - loss: 1.9154
16/16 [==============================] - 0s 2ms/step - loss: 1.9180
16/16 [==============================] - 0s 919us/step - loss: 1.9186
16/16 [==============================] - 0s 1ms/step - loss: 1.9187
16/16 [==============================] - 0s 935us/step - loss: 1.9187
16/16 [==============================] - 0s 2ms/step - loss: 1.9185
16/16 [==============================] - 0s 897us/step - loss: 1.9184
16/16 [==============================] - 0s 836us/step - loss: 1.9184

Testing for epoch 53 index 2:
32/32 [==============================] - 0s 647us/step
16/16 [==============================] - 0s 812us/step - loss: 1.1824
16/16 [==============================] - 0s 769us/step - loss: 1.8743
16/16 [==============================] - 0s 2ms/step - loss: 1.9238
16/16 [==============================] - 0s 796us/step - loss: 1.9264
16/16 [==============================] - 0s 2ms/step - loss: 1.9270
16/16 [==============================] - 0s 812us/step - loss: 1.9272
16/16 [==============================] - 0s 813us/step - loss: 1.9271
16/16 [==============================] - 0s 1ms/step - loss: 1.9270
16/16 [==============================] - 0s 856us/step - loss: 1.9269
16/16 [==============================] - 0s 810us/step - loss: 1.9268
Epoch 54 of 60

Testing for epoch 54 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 844us/step - loss: 1.1988
16/16 [==============================] - 0s 1ms/step - loss: 1.9035
16/16 [==============================] - 0s 932us/step - loss: 1.9535
16/16 [==============================] - 0s 787us/step - loss: 1.9561
16/16 [==============================] - 0s 792us/step - loss: 1.9568
16/16 [==============================] - 0s 794us/step - loss: 1.9570
16/16 [==============================] - 0s 1ms/step - loss: 1.9569
16/16 [==============================] - 0s 814us/step - loss: 1.9568
16/16 [==============================] - 0s 1ms/step - loss: 1.9567
16/16 [==============================] - 0s 2ms/step - loss: 1.9567

Testing for epoch 54 index 2:
32/32 [==============================] - 0s 553us/step
16/16 [==============================] - 0s 2ms/step - loss: 1.2127
16/16 [==============================] - 0s 822us/step - loss: 1.9062
16/16 [==============================] - 0s 811us/step - loss: 1.9551
16/16 [==============================] - 0s 2ms/step - loss: 1.9577
16/16 [==============================] - 0s 803us/step - loss: 1.9584
16/16 [==============================] - 0s 798us/step - loss: 1.9585
16/16 [==============================] - 0s 773us/step - loss: 1.9585
16/16 [==============================] - 0s 796us/step - loss: 1.9584
16/16 [==============================] - 0s 806us/step - loss: 1.9583
16/16 [==============================] - 0s 808us/step - loss: 1.9583
Epoch 55 of 60

Testing for epoch 55 index 1:
32/32 [==============================] - 0s 636us/step
16/16 [==============================] - 0s 897us/step - loss: 1.2206
16/16 [==============================] - 0s 805us/step - loss: 1.9180
16/16 [==============================] - 0s 787us/step - loss: 1.9664
16/16 [==============================] - 0s 1ms/step - loss: 1.9689
16/16 [==============================] - 0s 2ms/step - loss: 1.9695
16/16 [==============================] - 0s 800us/step - loss: 1.9697
16/16 [==============================] - 0s 1ms/step - loss: 1.9696
16/16 [==============================] - 0s 2ms/step - loss: 1.9695
16/16 [==============================] - 0s 913us/step - loss: 1.9694
16/16 [==============================] - 0s 2ms/step - loss: 1.9694

Testing for epoch 55 index 2:
32/32 [==============================] - 0s 563us/step
16/16 [==============================] - 0s 809us/step - loss: 1.2428
16/16 [==============================] - 0s 839us/step - loss: 1.9369
16/16 [==============================] - 0s 818us/step - loss: 1.9851
16/16 [==============================] - 0s 1ms/step - loss: 1.9876
16/16 [==============================] - 0s 2ms/step - loss: 1.9883
16/16 [==============================] - 0s 2ms/step - loss: 1.9884
16/16 [==============================] - 0s 1ms/step - loss: 1.9884
16/16 [==============================] - 0s 1ms/step - loss: 1.9883
16/16 [==============================] - 0s 2ms/step - loss: 1.9882
16/16 [==============================] - 0s 1ms/step - loss: 1.9882
Epoch 56 of 60

Testing for epoch 56 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 1.2530
16/16 [==============================] - 0s 2ms/step - loss: 1.9526
16/16 [==============================] - 0s 1ms/step - loss: 2.0011
16/16 [==============================] - 0s 892us/step - loss: 2.0036
16/16 [==============================] - 0s 805us/step - loss: 2.0042
16/16 [==============================] - 0s 782us/step - loss: 2.0044
16/16 [==============================] - 0s 788us/step - loss: 2.0043
16/16 [==============================] - 0s 2ms/step - loss: 2.0042
16/16 [==============================] - 0s 2ms/step - loss: 2.0041
16/16 [==============================] - 0s 854us/step - loss: 2.0040

Testing for epoch 56 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 1.2613
16/16 [==============================] - 0s 2ms/step - loss: 1.9478
16/16 [==============================] - 0s 2ms/step - loss: 1.9951
16/16 [==============================] - 0s 2ms/step - loss: 1.9976
16/16 [==============================] - 0s 882us/step - loss: 1.9982
16/16 [==============================] - 0s 1ms/step - loss: 1.9984
16/16 [==============================] - 0s 1ms/step - loss: 1.9984
16/16 [==============================] - 0s 793us/step - loss: 1.9982
16/16 [==============================] - 0s 2ms/step - loss: 1.9981
16/16 [==============================] - 0s 821us/step - loss: 1.9981
Epoch 57 of 60

Testing for epoch 57 index 1:
32/32 [==============================] - 0s 621us/step
16/16 [==============================] - 0s 1ms/step - loss: 1.2723
16/16 [==============================] - 0s 2ms/step - loss: 1.9662
16/16 [==============================] - 0s 2ms/step - loss: 2.0142
16/16 [==============================] - 0s 1ms/step - loss: 2.0167
16/16 [==============================] - 0s 821us/step - loss: 2.0173
16/16 [==============================] - 0s 789us/step - loss: 2.0175
16/16 [==============================] - 0s 2ms/step - loss: 2.0174
16/16 [==============================] - 0s 803us/step - loss: 2.0173
16/16 [==============================] - 0s 2ms/step - loss: 2.0172
16/16 [==============================] - 0s 2ms/step - loss: 2.0172

Testing for epoch 57 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 835us/step - loss: 1.2890
16/16 [==============================] - 0s 2ms/step - loss: 1.9763
16/16 [==============================] - 0s 2ms/step - loss: 2.0236
16/16 [==============================] - 0s 2ms/step - loss: 2.0261
16/16 [==============================] - 0s 1ms/step - loss: 2.0267
16/16 [==============================] - 0s 910us/step - loss: 2.0268
16/16 [==============================] - 0s 885us/step - loss: 2.0268
16/16 [==============================] - 0s 2ms/step - loss: 2.0267
16/16 [==============================] - 0s 974us/step - loss: 2.0266
16/16 [==============================] - 0s 864us/step - loss: 2.0266
Epoch 58 of 60

Testing for epoch 58 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 802us/step - loss: 1.2869
16/16 [==============================] - 0s 1ms/step - loss: 1.9705
16/16 [==============================] - 0s 2ms/step - loss: 2.0173
16/16 [==============================] - 0s 2ms/step - loss: 2.0197
16/16 [==============================] - 0s 2ms/step - loss: 2.0203
16/16 [==============================] - 0s 1ms/step - loss: 2.0204
16/16 [==============================] - 0s 2ms/step - loss: 2.0203
16/16 [==============================] - 0s 2ms/step - loss: 2.0202
16/16 [==============================] - 0s 2ms/step - loss: 2.0201
16/16 [==============================] - 0s 833us/step - loss: 2.0201

Testing for epoch 58 index 2:
32/32 [==============================] - 0s 584us/step
16/16 [==============================] - 0s 791us/step - loss: 1.3158
16/16 [==============================] - 0s 818us/step - loss: 2.0032
16/16 [==============================] - 0s 785us/step - loss: 2.0502
16/16 [==============================] - 0s 1ms/step - loss: 2.0527
16/16 [==============================] - 0s 1ms/step - loss: 2.0533
16/16 [==============================] - 0s 847us/step - loss: 2.0535
16/16 [==============================] - 0s 790us/step - loss: 2.0535
16/16 [==============================] - 0s 2ms/step - loss: 2.0534
16/16 [==============================] - 0s 831us/step - loss: 2.0533
16/16 [==============================] - 0s 2ms/step - loss: 2.0533
Epoch 59 of 60

Testing for epoch 59 index 1:
32/32 [==============================] - 0s 591us/step
16/16 [==============================] - 0s 803us/step - loss: 1.3201
16/16 [==============================] - 0s 811us/step - loss: 2.0086
16/16 [==============================] - 0s 783us/step - loss: 2.0555
16/16 [==============================] - 0s 792us/step - loss: 2.0580
16/16 [==============================] - 0s 2ms/step - loss: 2.0585
16/16 [==============================] - 0s 828us/step - loss: 2.0587
16/16 [==============================] - 0s 2ms/step - loss: 2.0586
16/16 [==============================] - 0s 2ms/step - loss: 2.0585
16/16 [==============================] - 0s 803us/step - loss: 2.0584
16/16 [==============================] - 0s 778us/step - loss: 2.0584

Testing for epoch 59 index 2:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 853us/step - loss: 1.3376
16/16 [==============================] - 0s 2ms/step - loss: 2.0187
16/16 [==============================] - 0s 891us/step - loss: 2.0651
16/16 [==============================] - 0s 2ms/step - loss: 2.0675
16/16 [==============================] - 0s 2ms/step - loss: 2.0681
16/16 [==============================] - 0s 2ms/step - loss: 2.0683
16/16 [==============================] - 0s 1ms/step - loss: 2.0682
16/16 [==============================] - 0s 2ms/step - loss: 2.0681
16/16 [==============================] - 0s 2ms/step - loss: 2.0680
16/16 [==============================] - 0s 2ms/step - loss: 2.0680
Epoch 60 of 60

Testing for epoch 60 index 1:
32/32 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 1.3388
16/16 [==============================] - 0s 830us/step - loss: 2.0171
16/16 [==============================] - 0s 1ms/step - loss: 2.0632
16/16 [==============================] - 0s 788us/step - loss: 2.0656
16/16 [==============================] - 0s 847us/step - loss: 2.0662
16/16 [==============================] - 0s 1ms/step - loss: 2.0663
16/16 [==============================] - 0s 2ms/step - loss: 2.0662
16/16 [==============================] - 0s 948us/step - loss: 2.0661
16/16 [==============================] - 0s 2ms/step - loss: 2.0660
16/16 [==============================] - 0s 2ms/step - loss: 2.0660

Testing for epoch 60 index 2:
32/32 [==============================] - 0s 585us/step
16/16 [==============================] - 0s 791us/step - loss: 1.3679
16/16 [==============================] - 0s 2ms/step - loss: 2.0481
16/16 [==============================] - 0s 791us/step - loss: 2.0943
16/16 [==============================] - 0s 785us/step - loss: 2.0968
16/16 [==============================] - 0s 784us/step - loss: 2.0974
16/16 [==============================] - 0s 788us/step - loss: 2.0976
16/16 [==============================] - 0s 823us/step - loss: 2.0975
16/16 [==============================] - 0s 786us/step - loss: 2.0974
16/16 [==============================] - 0s 803us/step - loss: 2.0973
16/16 [==============================] - 0s 812us/step - loss: 2.0973
32/32 [==============================] - 0s 572us/step</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="198">
<pre><code>MO_GAAL(contamination=0.05, k=10, lr_d=0.01, lr_g=0.0001, momentum=0.9,
    stop_epochs=20)</code></pre>
</div>
</div>
<div id="c07b384c-29fa-4369-9703-6206289d9a4e" class="cell" data-execution_count="199">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>outlier_MO_GAAL_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="046a05e0-fabf-45c0-9e88-8eadf69c0c16" class="cell" data-execution_count="200">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_MO_GAAL_one)</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"MO-GAAL (Liu et al., 2019)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-201-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.951
Precision: 0.000
Recall: 0.000
F1 Score: 0.000</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))</code></pre>
</div>
</div>
<div id="e2573364-6b2e-4684-8ebd-89d03fb7898d" class="cell" data-execution_count="201">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.951
Precision(TP / TP + FP): nan
Recall(TP / TP + FN): 0.000
F1 Score(2*precision*recall/precision+recall): nan</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_3852735/4166638268.py:3: RuntimeWarning: invalid value encountered in long_scalars
  print('Precision(TP / TP + FP): %.3f' % round(_conf.conf_matrix[1][1]/(_conf.conf_matrix[0][1] + _conf.conf_matrix[1][1]),3))
/tmp/ipykernel_3852735/4166638268.py:5: RuntimeWarning: invalid value encountered in long_scalars
  print('F1 Score(2*precision*recall/precision+recall): %.3f' % round((2*(_conf.conf_matrix[1][1]/(_conf.conf_matrix[0][1] + _conf.conf_matrix[1][1]))*(_conf.conf_matrix[1][1]/(_conf.conf_matrix[1][0] + _conf.conf_matrix[1][1]))) / (_conf.conf_matrix[1][1]/(_conf.conf_matrix[0][1] + _conf.conf_matrix[1][1]) + _conf.conf_matrix[1][1]/(_conf.conf_matrix[1][0] + _conf.conf_matrix[1][1])),3))</code></pre>
</div>
</div>
<div id="13788bd9-2de5-4a1a-87ff-f3fbea6ee1b5" class="cell" data-execution_count="202">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 0s 557us/step</code></pre>
</div>
</div>
<div id="05581aed-1058-4685-a156-38243a181ee1" class="cell" data-execution_count="203">
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="203">
<pre><code>0.5095924805253332</code></pre>
</div>
</div>
<div id="b70b6511-013c-4f4a-95b2-f4e5805291bc" class="cell" data-execution_count="204">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="204">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.600000</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.200000</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.460000</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.847990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.911</td>
<td>0.100000</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.533402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.893</td>
<td>0.210000</td>
<td>0.428571</td>
<td>0.281879</td>
<td>0.788751</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.911</td>
<td>0.100000</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.454001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.921</td>
<td>0.200000</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.677997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.951</td>
<td>0.500000</td>
<td>0.510204</td>
<td>0.505051</td>
<td>0.863924</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.925</td>
<td>0.240000</td>
<td>0.244898</td>
<td>0.242424</td>
<td>0.618018</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.921</td>
<td>0.105263</td>
<td>0.081633</td>
<td>0.091954</td>
<td>0.529743</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.941</td>
<td>0.400000</td>
<td>0.408163</td>
<td>0.404040</td>
<td>0.844224</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SO-GAAL (Liu et al., 2019)</td>
<td>0.951</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.464345</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MO-GAAL (Liu et al., 2019)</td>
<td>0.951</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.509592</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="lscp_orbit" class="level2">
<h2 class="anchored" data-anchor-id="lscp_orbit">LSCP_Orbit</h2>
<div id="c9f5ffed-6fd7-4633-8f24-1a15ae9c1273" class="cell" data-execution_count="205">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>detectors <span class="op">=</span> [KNN(), LOF(), OCSVM()]</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LSCP(detectors,contamination<span class="op">=</span><span class="fl">0.05</span>, random_state<span class="op">=</span><span class="dv">77</span>)</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'f'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/pyod/models/lscp.py:382: UserWarning: The number of histogram bins is greater than the number of classifiers, reducing n_bins to n_clf.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="205">
<pre><code>LSCP(contamination=0.05,
   detector_list=[KNN(algorithm='auto', contamination=0.1, leaf_size=30, method='largest',
  metric='minkowski', metric_params=None, n_jobs=1, n_neighbors=5, p=2,
  radius=1.0), LOF(algorithm='auto', contamination=0.1, leaf_size=30, metric='minkowski',
  metric_params=None, n_jobs=1, n_neighbors=20, novelty=True, p=2), OCSVM(cache_size=200, coef0=0.0, contamination=0.1, degree=3, gamma='auto',
   kernel='rbf', max_iter=-1, nu=0.5, shrinking=True, tol=0.001,
   verbose=False)],
   local_max_features=1.0, local_region_size=30, n_bins=3,
   random_state=RandomState(MT19937) at 0x7FD5F8280640)</code></pre>
</div>
</div>
<div id="8d2df78b-cef0-449d-8ce6-ee8c8551e9cc" class="cell" data-execution_count="206">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>outlier_LSCP_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="f6cd7ee7-a99f-41a9-ae2a-ffafdd1dde0a" class="cell" data-execution_count="207">
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_orbit,outlier_LSCP_one)</span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"LSCP (Zhao et al., 2019)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-208-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.947
Precision: 0.460
Recall: 0.469
F1 Score: 0.465</code></pre>
</div>
</div>
<div id="3b738509-d699-48e0-acb4-8ce62ca6074b" class="cell" data-execution_count="208">
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 0.947
Precision(TP / TP + FP): 0.460
Recall(TP / TP + FN): 0.469
F1 Score(2*precision*recall/precision+recall): 0.465</code></pre>
</div>
</div>
<div id="87686db7-831e-41dc-af20-0e680e89f65c" class="cell" data-execution_count="209">
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_orbit,clf.decision_function(_df))</span></code></pre></div>
</div>
<div id="c04e852f-fe24-4b75-8c9f-b43296cdf44d" class="cell" data-execution_count="210">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="210">
<pre><code>0.849288611343591</code></pre>
</div>
</div>
<div id="258cf372-de13-4b44-b6ec-0f72fa1ce72f" class="cell" data-scrolled="true" data-execution_count="211">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>tab_orbit <span class="op">=</span> pd.concat([tab_orbit,</span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_orbit</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="211">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.600000</td>
<td>0.612245</td>
<td>0.606061</td>
<td>0.893023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.200000</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.664124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.460000</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.847990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.911</td>
<td>0.100000</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.533402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.893</td>
<td>0.210000</td>
<td>0.428571</td>
<td>0.281879</td>
<td>0.788751</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.911</td>
<td>0.100000</td>
<td>0.102041</td>
<td>0.101010</td>
<td>0.454001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.921</td>
<td>0.200000</td>
<td>0.204082</td>
<td>0.202020</td>
<td>0.677997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.951</td>
<td>0.500000</td>
<td>0.510204</td>
<td>0.505051</td>
<td>0.863924</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.925</td>
<td>0.240000</td>
<td>0.244898</td>
<td>0.242424</td>
<td>0.618018</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.921</td>
<td>0.105263</td>
<td>0.081633</td>
<td>0.091954</td>
<td>0.529743</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.941</td>
<td>0.400000</td>
<td>0.408163</td>
<td>0.404040</td>
<td>0.844224</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SO-GAAL (Liu et al., 2019)</td>
<td>0.951</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.464345</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MO-GAAL (Liu et al., 2019)</td>
<td>0.951</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.509592</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LSCP (Zhao et al., 2019)</td>
<td>0.947</td>
<td>0.460000</td>
<td>0.469388</td>
<td>0.464646</td>
<td>0.849289</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="tab_orbit" class="level2">
<h2 class="anchored" data-anchor-id="tab_orbit">tab_orbit</h2>
<div id="2f61b874-6441-48d9-8c21-1c51c361cafb" class="cell" data-execution_count="212">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="bu">round</span>(tab_orbit,<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="212">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.961</td>
<td>0.600</td>
<td>0.612</td>
<td>0.606</td>
<td>0.893</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.921</td>
<td>0.200</td>
<td>0.204</td>
<td>0.202</td>
<td>0.664</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.947</td>
<td>0.460</td>
<td>0.469</td>
<td>0.465</td>
<td>0.848</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.911</td>
<td>0.100</td>
<td>0.102</td>
<td>0.101</td>
<td>0.533</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.893</td>
<td>0.210</td>
<td>0.429</td>
<td>0.282</td>
<td>0.789</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.911</td>
<td>0.100</td>
<td>0.102</td>
<td>0.101</td>
<td>0.454</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.921</td>
<td>0.200</td>
<td>0.204</td>
<td>0.202</td>
<td>0.678</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.951</td>
<td>0.500</td>
<td>0.510</td>
<td>0.505</td>
<td>0.864</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.925</td>
<td>0.240</td>
<td>0.245</td>
<td>0.242</td>
<td>0.618</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.921</td>
<td>0.105</td>
<td>0.082</td>
<td>0.092</td>
<td>0.530</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.941</td>
<td>0.400</td>
<td>0.408</td>
<td>0.404</td>
<td>0.844</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SO-GAAL (Liu et al., 2019)</td>
<td>0.951</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.464</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MO-GAAL (Liu et al., 2019)</td>
<td>0.951</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.510</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LSCP (Zhao et al., 2019)</td>
<td>0.947</td>
<td>0.460</td>
<td>0.469</td>
<td>0.465</td>
<td>0.849</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="bunny" class="level1">
<h1>Bunny</h1>
<div id="be2a32ae-d258-45fb-85c9-ef843c436b32" class="cell" data-execution_count="213">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> graphs.Bunny()</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> G.N</span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> filters.Heat(G, tau<span class="op">=</span><span class="dv">75</span>) </span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a>n<span class="op">=</span><span class="dv">2503</span></span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1212</span>)</span>
<span id="cb353-6"><a href="#cb353-6" aria-hidden="true" tabindex="-1"></a>normal <span class="op">=</span> np.around(np.random.normal(size<span class="op">=</span>n),<span class="dv">15</span>)</span>
<span id="cb353-7"><a href="#cb353-7" aria-hidden="true" tabindex="-1"></a>unif <span class="op">=</span> np.concatenate([np.random.uniform(low<span class="op">=</span><span class="dv">3</span>,high<span class="op">=</span><span class="dv">7</span>,size<span class="op">=</span><span class="dv">60</span>), np.random.uniform(low<span class="op">=-</span><span class="dv">7</span>,high<span class="op">=-</span><span class="dv">3</span>,size<span class="op">=</span><span class="dv">60</span>),np.zeros(n<span class="op">-</span><span class="dv">120</span>)])<span class="op">;</span> np.random.shuffle(unif)</span>
<span id="cb353-8"><a href="#cb353-8" aria-hidden="true" tabindex="-1"></a>noise <span class="op">=</span> normal <span class="op">+</span> unif</span>
<span id="cb353-9"><a href="#cb353-9" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> np.zeros(n)</span>
<span id="cb353-10"><a href="#cb353-10" aria-hidden="true" tabindex="-1"></a>f[<span class="dv">1000</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">3234</span></span>
<span id="cb353-11"><a href="#cb353-11" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> g.<span class="bu">filter</span>(f, method<span class="op">=</span><span class="st">'chebyshev'</span>) </span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-11-27 13:28:42,553:[WARNING](pygsp.graphs.graph.lmax): The largest eigenvalue G.lmax is not available, we need to estimate it. Explicitly call G.estimate_lmax() or G.compute_fourier_basis() once beforehand to suppress the warning.</code></pre>
</div>
</div>
<div id="e3da3266-b141-4706-8c7d-2d361efc733a" class="cell" data-execution_count="214">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>G.coords.shape</span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>_W <span class="op">=</span> G.W.toarray()</span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>_x <span class="op">=</span> G.coords[:,<span class="dv">0</span>]</span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a>_y <span class="op">=</span> G.coords[:,<span class="dv">1</span>]</span>
<span id="cb355-5"><a href="#cb355-5" aria-hidden="true" tabindex="-1"></a>_z <span class="op">=</span> <span class="op">-</span>G.coords[:,<span class="dv">2</span>]</span>
<span id="cb355-6"><a href="#cb355-6" aria-hidden="true" tabindex="-1"></a>_df1 <span class="op">=</span> {<span class="st">'W'</span>:_W,<span class="st">'x'</span>:_x,<span class="st">'y'</span>:_y,<span class="st">'z'</span>:_z, <span class="st">'fnoise'</span>:f<span class="op">+</span>noise,<span class="st">'f'</span> : f, <span class="st">'noise'</span>: noise,<span class="st">'unif'</span>:unif}</span>
<span id="cb355-7"><a href="#cb355-7" aria-hidden="true" tabindex="-1"></a>_df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: _df1[<span class="st">'x'</span>],<span class="st">'y'</span>:_df1[<span class="st">'y'</span>],<span class="st">'z'</span>:_df1[<span class="st">'z'</span>],<span class="st">'fnoise'</span>:_df1[<span class="st">'fnoise'</span>],<span class="st">'f'</span>:_df1[<span class="st">'f'</span>],<span class="st">'noise'</span>:_df1[<span class="st">'noise'</span>]})</span>
<span id="cb355-8"><a href="#cb355-8" aria-hidden="true" tabindex="-1"></a>unif <span class="op">=</span> _df1[<span class="st">'unif'</span>]</span>
<span id="cb355-9"><a href="#cb355-9" aria-hidden="true" tabindex="-1"></a>outlier_true_bunny <span class="op">=</span> unif.copy()</span>
<span id="cb355-10"><a href="#cb355-10" aria-hidden="true" tabindex="-1"></a>outlier_true_bunny <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="op">!=</span><span class="dv">0</span>  <span class="cf">else</span> <span class="dv">0</span>,outlier_true_bunny))</span>
<span id="cb355-11"><a href="#cb355-11" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(_df)[:,:<span class="dv">4</span>]</span></code></pre></div>
</div>
<section id="gode_bunny" class="level2">
<h2 class="anchored" data-anchor-id="gode_bunny">GODE_Bunny</h2>
<div id="1098fada-ebe7-40ab-a0e2-793e022e5d42" class="cell" data-execution_count="215">
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>_W <span class="op">=</span> _df1[<span class="st">'W'</span>]</span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a>_BUNNY <span class="op">=</span> BUNNY(_df)</span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a>_BUNNY.fit(sd<span class="op">=</span><span class="dv">20</span>,ref<span class="op">=</span><span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="0bd9455d-3e0c-44a5-9ee9-9bcc6fc6c758" class="cell" data-execution_count="216">
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a>outlier_GODE_one_old <span class="op">=</span> (_BUNNY.df[<span class="st">'Residual'</span>]<span class="op">**</span><span class="dv">2</span>).tolist()</span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a>sorted_data <span class="op">=</span> <span class="bu">sorted</span>(outlier_GODE_one_old,reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(sorted_data) <span class="op">*</span> <span class="fl">0.05</span>)</span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a>five_percent <span class="op">=</span> sorted_data[index]</span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a>outlier_GODE_one <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="op">&gt;</span> five_percent <span class="cf">else</span> <span class="dv">0</span>,outlier_GODE_one_old))</span></code></pre></div>
</div>
<div id="8107c027-d997-41e9-a0f2-ae82a0d8da8f" class="cell" data-execution_count="217">
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_GODE_one)</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"GODE"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-218-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.988
Precision: 0.864
Recall: 0.900
F1 Score: 0.882</code></pre>
</div>
</div>
<div id="12e5aa20-6dfe-4987-afed-de2f476c9106" class="cell" data-execution_count="218">
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb360-4"><a href="#cb360-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb360-5"><a href="#cb360-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.474
Precision(TP / TP + FP): 0.864
Recall(TP / TP + FN): 0.900
F1 Score(2*precision*recall/precision+recall): 0.882</code></pre>
</div>
</div>
<div id="8eec5356-5ca8-4a92-844c-8c62c428b4f4" class="cell" data-execution_count="219">
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,outlier_GODE_one_old)</span></code></pre></div>
</div>
<div id="aa0c1268-78c7-4781-be92-8017e95161c8" class="cell" data-execution_count="220">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="220">
<pre><code>0.9962267449993005</code></pre>
</div>
</div>
<div id="c193350d-4592-41e0-97c1-f44d64f60d23" class="cell" data-execution_count="221">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="221">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864</td>
<td>0.9</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="lof_bunny" class="level2">
<h2 class="anchored" data-anchor-id="lof_bunny">LOF_Bunny</h2>
<div id="07840ef3-6c42-49ec-b27a-063cd3c928bf" class="cell" data-execution_count="222">
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LOF(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="222">
<pre><code>LOF(algorithm='auto', contamination=0.05, leaf_size=30, metric='minkowski',
  metric_params=None, n_jobs=1, n_neighbors=20, novelty=True, p=2)</code></pre>
</div>
</div>
<div id="283b06fd-aa3c-4869-8139-34ce7521b398" class="cell" data-execution_count="223">
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>outlier_LOF_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="d7b94d69-13b6-406c-a3c4-45e7bd0794f4" class="cell" data-execution_count="224">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,clf.fit_predict(X))</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"LOF (Breunig et al., 2000)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/utils/deprecation.py:86: FutureWarning: Function fit_predict is deprecated
  warnings.warn(msg, category=FutureWarning)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-225-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.943
Precision: 0.413
Recall: 0.433
F1 Score: 0.423</code></pre>
</div>
</div>
<div id="52fa54fc-1dcc-4879-944a-e61191b833e9" class="cell" data-execution_count="225">
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.361
Precision(TP / TP + FP): 0.413
Recall(TP / TP + FN): 0.433
F1 Score(2*precision*recall/precision+recall): 0.423</code></pre>
</div>
</div>
<div id="c866ba3f-aed8-43f1-8c5e-c23374d155ff" class="cell" data-execution_count="226">
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(X))</span></code></pre></div>
</div>
<div id="53b2dba7-fe09-442d-afdb-ffe02bcc3e9a" class="cell" data-execution_count="227">
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="227">
<pre><code>0.8191110644845433</code></pre>
</div>
</div>
<div id="3c3b6c17-003b-4408-9741-8a131e1b7695" class="cell" data-execution_count="228">
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="228">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="knn_bunny" class="level2">
<h2 class="anchored" data-anchor-id="knn_bunny">KNN_Bunny</h2>
<div id="3d3329e1-8399-4e9c-8f14-a33b64ca9f70" class="cell" data-execution_count="229">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> KNN(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="229">
<pre><code>KNN(algorithm='auto', contamination=0.05, leaf_size=30, method='largest',
  metric='minkowski', metric_params=None, n_jobs=1, n_neighbors=5, p=2,
  radius=1.0)</code></pre>
</div>
</div>
<div id="b4eb3e27-51c4-4936-9f3f-04fbf962e85b" class="cell" data-execution_count="230">
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>outlier_KNN_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="1574b9ed-44d4-40fa-88de-51f01083e892" class="cell" data-execution_count="231">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_KNN_one)</span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"kNN (Ramaswamy et al., 2000)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-232-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.987
Precision: 0.849
Recall: 0.892
F1 Score: 0.870</code></pre>
</div>
</div>
<div id="f661a33a-af1b-44c0-bbd4-1a6366f9cf4f" class="cell" data-execution_count="232">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.471
Precision(TP / TP + FP): 0.849
Recall(TP / TP + FN): 0.892
F1 Score(2*precision*recall/precision+recall): 0.870</code></pre>
</div>
</div>
<div id="6650b7e2-e7ed-4859-ba8b-1fba8c75fe51" class="cell" data-execution_count="233">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]]))</span></code></pre></div>
</div>
<div id="3dbbd02c-3b76-4427-b32d-b32299f83f27" class="cell" data-execution_count="234">
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="234">
<pre><code>0.984438382990628</code></pre>
</div>
</div>
<div id="4998a394-135e-4b65-8c9f-a75e16c2295c" class="cell" data-execution_count="235">
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="235">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987215</td>
<td>0.849206</td>
<td>0.891667</td>
<td>0.869919</td>
<td>0.984438</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="cblof_bunny" class="level2">
<h2 class="anchored" data-anchor-id="cblof_bunny">CBLOF_Bunny</h2>
<div id="af3ec7ed-bde8-4312-8477-a6c532643125" class="cell" data-execution_count="236">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> CBLOF(contamination<span class="op">=</span><span class="fl">0.05</span>,random_state<span class="op">=</span><span class="dv">77</span>)</span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/cluster/_kmeans.py:1412: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="236">
<pre><code>CBLOF(alpha=0.9, beta=5, check_estimator=False, clustering_estimator=None,
   contamination=0.05, n_clusters=8, n_jobs=None, random_state=77,
   use_weights=False)</code></pre>
</div>
</div>
<div id="4dea87c9-d98d-492b-b24c-dfd0f594bd94" class="cell" data-execution_count="237">
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>outlier_CBLOF_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="41e7470e-2988-40b0-8911-37e6d3518480" class="cell" data-execution_count="238">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_CBLOF_one)</span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"CBLOF (He et al., 2003)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-239-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.981
Precision: 0.786
Recall: 0.825
F1 Score: 0.805</code></pre>
</div>
</div>
<div id="8de0615d-2c85-489c-b518-a5c910b95957" class="cell" data-execution_count="239">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.455
Precision(TP / TP + FP): 0.786
Recall(TP / TP + FN): 0.825
F1 Score(2*precision*recall/precision+recall): 0.805</code></pre>
</div>
</div>
<div id="2bec7503-b177-4f65-b439-47ceeec9c602" class="cell" data-execution_count="240">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]]))</span></code></pre></div>
</div>
<div id="d9a13bea-594a-497e-af05-64d45967c55e" class="cell" data-execution_count="241">
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="241">
<pre><code>0.9705448314449574</code></pre>
</div>
</div>
<div id="46678de7-df09-4fc2-a448-1b85d77a9cdf" class="cell" data-execution_count="242">
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="242">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987215</td>
<td>0.849206</td>
<td>0.891667</td>
<td>0.869919</td>
<td>0.984438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.980823</td>
<td>0.785714</td>
<td>0.825000</td>
<td>0.804878</td>
<td>0.970545</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="ocsvm_bunny" class="level2">
<h2 class="anchored" data-anchor-id="ocsvm_bunny">OCSVM_Bunny</h2>
<div id="3bdaf3d2-1a61-4ca2-a98e-033804672e15" class="cell" data-execution_count="243">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> OCSVM(nu<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a>clf.fit(X)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="243">
<pre><code>OCSVM(cache_size=200, coef0=0.0, contamination=0.1, degree=3, gamma='auto',
   kernel='rbf', max_iter=-1, nu=0.05, shrinking=True, tol=0.001,
   verbose=False)</code></pre>
</div>
</div>
<div id="66923ca9-f2a5-4c7f-9ae4-9bdf11469afe" class="cell" data-execution_count="244">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>outlier_OSVM_one <span class="op">=</span> <span class="bu">list</span>(clf.predict(X))</span></code></pre></div>
</div>
<div id="c908ea02-5fae-4900-9236-d83b63b7a3ba" class="cell" data-execution_count="245">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_OSVM_one)</span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"OCSVM (Sch ̈olkopf et al., 2001)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-246-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.917
Precision: 0.323
Recall: 0.675
F1 Score: 0.437</code></pre>
</div>
</div>
<div id="02a5a52c-b4e4-4554-9a19-811cc9be64f7" class="cell" data-execution_count="246">
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.294
Precision(TP / TP + FP): 0.323
Recall(TP / TP + FN): 0.675
F1 Score(2*precision*recall/precision+recall): 0.437</code></pre>
</div>
</div>
<div id="7cf8dc46-6338-4428-ab86-776c73c57042" class="cell" data-execution_count="247">
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(X))</span></code></pre></div>
</div>
<div id="82fa939b-9ac2-4811-90d4-ce3778bb6ca8" class="cell" data-execution_count="248">
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="248">
<pre><code>0.8575500069939852</code></pre>
</div>
</div>
<div id="2ad85516-a79f-4079-9873-8abe60023655" class="cell" data-execution_count="249">
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="249">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987215</td>
<td>0.849206</td>
<td>0.891667</td>
<td>0.869919</td>
<td>0.984438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.980823</td>
<td>0.785714</td>
<td>0.825000</td>
<td>0.804878</td>
<td>0.970545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.916500</td>
<td>0.322709</td>
<td>0.675000</td>
<td>0.436658</td>
<td>0.857550</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="mcd_bunny" class="level2">
<h2 class="anchored" data-anchor-id="mcd_bunny">MCD_Bunny</h2>
<div id="01aa6847-00fb-4fe3-8ad8-51a478d099df" class="cell" data-execution_count="250">
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> MCD(contamination<span class="op">=</span><span class="fl">0.05</span> , random_state <span class="op">=</span> <span class="dv">77</span>)</span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="250">
<pre><code>MCD(assume_centered=False, contamination=0.05, random_state=77,
  store_precision=True, support_fraction=None)</code></pre>
</div>
</div>
<div id="2b117d3e-3483-47c1-8c85-0d8fcb2fa7f9" class="cell" data-execution_count="251">
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a>outlier_MCD_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="65bcd5dd-8a30-4fcb-9ab3-4091133b832c" class="cell" data-execution_count="252">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_MCD_one)</span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"MCD (Hardin and Rocke, 2004)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-253-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.978
Precision: 0.762
Recall: 0.800
F1 Score: 0.780</code></pre>
</div>
</div>
<div id="92774c09-8509-4ff4-a693-b05c6c1a63c5" class="cell" data-execution_count="253">
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb417-5"><a href="#cb417-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.449
Precision(TP / TP + FP): 0.762
Recall(TP / TP + FN): 0.800
F1 Score(2*precision*recall/precision+recall): 0.780</code></pre>
</div>
</div>
<div id="5f051cdd-e45a-406a-979d-959930efa71e" class="cell" data-execution_count="254">
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]]))</span></code></pre></div>
</div>
<div id="0f0c8ec0-953e-46e5-b756-3478b360f4a1" class="cell" data-execution_count="255">
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="255">
<pre><code>0.9723982375157364</code></pre>
</div>
</div>
<div id="eb6d9f47-9a90-475f-8f40-5c922d9ae3c6" class="cell" data-execution_count="256">
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="256">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987215</td>
<td>0.849206</td>
<td>0.891667</td>
<td>0.869919</td>
<td>0.984438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.980823</td>
<td>0.785714</td>
<td>0.825000</td>
<td>0.804878</td>
<td>0.970545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.916500</td>
<td>0.322709</td>
<td>0.675000</td>
<td>0.436658</td>
<td>0.857550</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.978426</td>
<td>0.761905</td>
<td>0.800000</td>
<td>0.780488</td>
<td>0.972398</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="feature-bagging_bunny" class="level2">
<h2 class="anchored" data-anchor-id="feature-bagging_bunny">Feature Bagging_Bunny</h2>
<div id="79789759-a8b3-4772-9a93-73fa339774ca" class="cell" data-execution_count="257">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> FeatureBagging(contamination<span class="op">=</span><span class="fl">0.05</span>, random_state<span class="op">=</span><span class="dv">77</span>)</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="257">
<pre><code>FeatureBagging(base_estimator=None, bootstrap_features=False,
        check_detector=True, check_estimator=False, combination='average',
        contamination=0.05, estimator_params={}, max_features=1.0,
        n_estimators=10, n_jobs=1, random_state=77, verbose=0)</code></pre>
</div>
</div>
<div id="467facde-d96b-4c6e-946d-c92047c98fe6" class="cell" data-execution_count="258">
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a>outlier_FeatureBagging_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="97a57b7b-ac06-4b15-b9c9-4e06f67d6372" class="cell" data-execution_count="259">
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_FeatureBagging_one)</span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"Feature Bagging (Lazarevic and Kumar, 2005)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-260-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.949
Precision: 0.468
Recall: 0.492
F1 Score: 0.480</code></pre>
</div>
</div>
<div id="4c2468fa-7d41-41c4-ad3e-b535ec72db19" class="cell" data-execution_count="260">
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb428-4"><a href="#cb428-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb428-5"><a href="#cb428-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.375
Precision(TP / TP + FP): 0.468
Recall(TP / TP + FN): 0.492
F1 Score(2*precision*recall/precision+recall): 0.480</code></pre>
</div>
</div>
<div id="d2558915-1eb2-458b-9159-487f08bb2251" class="cell" data-execution_count="261">
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]]))</span></code></pre></div>
</div>
<div id="90879f57-7a86-470d-ab6d-7157c3d659b8" class="cell" data-execution_count="262">
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="262">
<pre><code>0.8338089243250805</code></pre>
</div>
</div>
<div id="39c5ad76-0c18-43ea-94d6-28fd39740ae5" class="cell" data-execution_count="263">
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="263">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987215</td>
<td>0.849206</td>
<td>0.891667</td>
<td>0.869919</td>
<td>0.984438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.980823</td>
<td>0.785714</td>
<td>0.825000</td>
<td>0.804878</td>
<td>0.970545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.916500</td>
<td>0.322709</td>
<td>0.675000</td>
<td>0.436658</td>
<td>0.857550</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.978426</td>
<td>0.761905</td>
<td>0.800000</td>
<td>0.780488</td>
<td>0.972398</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.948861</td>
<td>0.468254</td>
<td>0.491667</td>
<td>0.479675</td>
<td>0.833809</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="abod_bunny" class="level2">
<h2 class="anchored" data-anchor-id="abod_bunny">ABOD_Bunny</h2>
<div id="512fc1ff-9e59-4a36-80eb-c2b55fd689ab" class="cell" data-execution_count="264">
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> ABOD(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="264">
<pre><code>ABOD(contamination=0.05, method='fast', n_neighbors=5)</code></pre>
</div>
</div>
<div id="c24e2520-9416-4044-8461-81432c0e9804" class="cell" data-execution_count="265">
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a>outlier_ABOD_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="d992b902-0dc0-42e0-9317-b99e916b203c" class="cell" data-execution_count="266">
<div class="sourceCode cell-code" id="cb437"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_ABOD_one)</span>
<span id="cb437-2"><a href="#cb437-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"ABOD (Kriegel et al., 2008)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-267-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.979
Precision: 0.770
Recall: 0.808
F1 Score: 0.789</code></pre>
</div>
</div>
<div id="a70f0142-033d-42f8-ac7f-c9b73863036a" class="cell" data-execution_count="267">
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb439-4"><a href="#cb439-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb439-5"><a href="#cb439-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.451
Precision(TP / TP + FP): 0.770
Recall(TP / TP + FN): 0.808
F1 Score(2*precision*recall/precision+recall): 0.789</code></pre>
</div>
</div>
<div id="dc3e75ea-8b6e-4bec-8da5-0eaa0aac39ca" class="cell" data-execution_count="268">
<div class="sourceCode cell-code" id="cb441"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]]))</span></code></pre></div>
</div>
<div id="c486e3d5-659a-4725-a3ed-5dca3d9fd5b2" class="cell" data-execution_count="269">
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="269">
<pre><code>0.9715764442579382</code></pre>
</div>
</div>
<div id="57031b17-5d5a-4057-88a4-b8c22f29d9f8" class="cell" data-execution_count="270">
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="270">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987215</td>
<td>0.849206</td>
<td>0.891667</td>
<td>0.869919</td>
<td>0.984438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.980823</td>
<td>0.785714</td>
<td>0.825000</td>
<td>0.804878</td>
<td>0.970545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.916500</td>
<td>0.322709</td>
<td>0.675000</td>
<td>0.436658</td>
<td>0.857550</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.978426</td>
<td>0.761905</td>
<td>0.800000</td>
<td>0.780488</td>
<td>0.972398</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.948861</td>
<td>0.468254</td>
<td>0.491667</td>
<td>0.479675</td>
<td>0.833809</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.979225</td>
<td>0.769841</td>
<td>0.808333</td>
<td>0.788618</td>
<td>0.971576</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="iforest_bunny" class="level2">
<h2 class="anchored" data-anchor-id="iforest_bunny">IForest_Bunny</h2>
<div id="e3cda15f-f5a9-41ba-81a9-e5ba30dac313" class="cell" data-execution_count="271">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> IForest(contamination<span class="op">=</span><span class="fl">0.05</span>,random_state<span class="op">=</span><span class="dv">77</span>)</span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="271">
<pre><code>IForest(behaviour='old', bootstrap=False, contamination=0.05,
    max_features=1.0, max_samples='auto', n_estimators=100, n_jobs=1,
    random_state=77, verbose=0)</code></pre>
</div>
</div>
<div id="83c0bf77-46d8-4181-90b9-27e6176c73bd" class="cell" data-execution_count="272">
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a>outlier_IForest_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="787d12ae-bf84-4e8c-9952-96dbaf155e59" class="cell" data-execution_count="273">
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_IForest_one)</span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"Isolation Forest (Liu et al., 2008)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-274-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.972
Precision: 0.698
Recall: 0.733
F1 Score: 0.715</code></pre>
</div>
</div>
<div id="c76d7aaf-3c03-47e1-8db0-85bed5529f20" class="cell" data-execution_count="274">
<div class="sourceCode cell-code" id="cb450"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.433
Precision(TP / TP + FP): 0.698
Recall(TP / TP + FN): 0.733
F1 Score(2*precision*recall/precision+recall): 0.715</code></pre>
</div>
</div>
<div id="dde1c1c7-07ee-44d0-a98d-669b8d0c9a88" class="cell" data-execution_count="275">
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]]))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/base.py:457: UserWarning: X has feature names, but IsolationForest was fitted without feature names
  warnings.warn(</code></pre>
</div>
</div>
<div id="278b8033-5b92-4ea0-a5d6-c12e40ccf197" class="cell" data-execution_count="276">
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="276">
<pre><code>0.967953559938453</code></pre>
</div>
</div>
<div id="b959ff13-eec3-41f5-aec8-721971761c51" class="cell" data-execution_count="277">
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="277">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987215</td>
<td>0.849206</td>
<td>0.891667</td>
<td>0.869919</td>
<td>0.984438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.980823</td>
<td>0.785714</td>
<td>0.825000</td>
<td>0.804878</td>
<td>0.970545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.916500</td>
<td>0.322709</td>
<td>0.675000</td>
<td>0.436658</td>
<td>0.857550</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.978426</td>
<td>0.761905</td>
<td>0.800000</td>
<td>0.780488</td>
<td>0.972398</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.948861</td>
<td>0.468254</td>
<td>0.491667</td>
<td>0.479675</td>
<td>0.833809</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.979225</td>
<td>0.769841</td>
<td>0.808333</td>
<td>0.788618</td>
<td>0.971576</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.972034</td>
<td>0.698413</td>
<td>0.733333</td>
<td>0.715447</td>
<td>0.967954</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="hbos_bunny" class="level2">
<h2 class="anchored" data-anchor-id="hbos_bunny">HBOS_Bunny</h2>
<div id="ad561d85-7e81-49d0-9bd9-5c81c70f7aac" class="cell" data-execution_count="278">
<div class="sourceCode cell-code" id="cb457"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> HBOS(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="278">
<pre><code>HBOS(alpha=0.1, contamination=0.05, n_bins=10, tol=0.5)</code></pre>
</div>
</div>
<div id="bc20e15c-467b-4e4c-8fe1-fd2f14c9acde" class="cell" data-execution_count="279">
<div class="sourceCode cell-code" id="cb459"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a>outlier_HBOS_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="8e4ba9ee-e957-4903-bf60-fa5269062965" class="cell" data-execution_count="280">
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_HBOS_one)</span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"HBOS (Goldstein and Dengel, 2012)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-281-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.932
Precision: 0.302
Recall: 0.317
F1 Score: 0.309</code></pre>
</div>
</div>
<div id="3e81345d-2944-426a-a1e1-991d697bbe57" class="cell" data-execution_count="281">
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb462-3"><a href="#cb462-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb462-4"><a href="#cb462-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb462-5"><a href="#cb462-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.333
Precision(TP / TP + FP): 0.302
Recall(TP / TP + FN): 0.317
F1 Score(2*precision*recall/precision+recall): 0.309</code></pre>
</div>
</div>
<div id="fea7e0d9-0b77-4221-9ced-bba5dde8658d" class="cell" data-execution_count="282">
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]]))</span></code></pre></div>
</div>
<div id="d6941870-1f12-477c-97c1-b193eb756f20" class="cell" data-execution_count="283">
<div class="sourceCode cell-code" id="cb465"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="283">
<pre><code>0.8591918450132886</code></pre>
</div>
</div>
<div id="a38a96ad-66b3-4555-921c-b43b7c67733b" class="cell" data-execution_count="284">
<div class="sourceCode cell-code" id="cb467"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="284">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987215</td>
<td>0.849206</td>
<td>0.891667</td>
<td>0.869919</td>
<td>0.984438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.980823</td>
<td>0.785714</td>
<td>0.825000</td>
<td>0.804878</td>
<td>0.970545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.916500</td>
<td>0.322709</td>
<td>0.675000</td>
<td>0.436658</td>
<td>0.857550</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.978426</td>
<td>0.761905</td>
<td>0.800000</td>
<td>0.780488</td>
<td>0.972398</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.948861</td>
<td>0.468254</td>
<td>0.491667</td>
<td>0.479675</td>
<td>0.833809</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.979225</td>
<td>0.769841</td>
<td>0.808333</td>
<td>0.788618</td>
<td>0.971576</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.972034</td>
<td>0.698413</td>
<td>0.733333</td>
<td>0.715447</td>
<td>0.967954</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.932082</td>
<td>0.301587</td>
<td>0.316667</td>
<td>0.308943</td>
<td>0.859192</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="sos_bunny" class="level2">
<h2 class="anchored" data-anchor-id="sos_bunny">SOS_Bunny</h2>
<div id="a9f2545f-d15d-4601-a791-ab27c609b83f" class="cell" data-execution_count="285">
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SOS(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="285">
<pre><code>SOS(contamination=0.05, eps=1e-05, metric='euclidean', perplexity=4.5)</code></pre>
</div>
</div>
<div id="edcf6d22-b0bc-440c-be55-62a5f76ab1cb" class="cell" data-execution_count="286">
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a>outlier_SOS_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="6f3d9b46-3745-4374-b968-436d58eb26ea" class="cell" data-execution_count="287">
<div class="sourceCode cell-code" id="cb471"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_SOS_one)</span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"SOS (Janssens et al., 2012)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-288-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.909
Precision: 0.071
Recall: 0.075
F1 Score: 0.073</code></pre>
</div>
</div>
<div id="9a700d4e-eff5-432f-8edf-48eaaa3134a0" class="cell" data-execution_count="288">
<div class="sourceCode cell-code" id="cb473"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb473-3"><a href="#cb473-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb473-4"><a href="#cb473-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb473-5"><a href="#cb473-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.275
Precision(TP / TP + FP): 0.071
Recall(TP / TP + FN): 0.075
F1 Score(2*precision*recall/precision+recall): 0.073</code></pre>
</div>
</div>
<div id="a1fc88f0-796f-49d8-a805-16e682b8a953" class="cell" data-execution_count="289">
<div class="sourceCode cell-code" id="cb475"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]]))</span></code></pre></div>
</div>
<div id="7249ad0a-5662-40be-9456-726a42e740e0" class="cell" data-execution_count="290">
<div class="sourceCode cell-code" id="cb476"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="290">
<pre><code>0.5574311092460484</code></pre>
</div>
</div>
<div id="f1f006a9-0af5-4d06-bdba-c235466a003a" class="cell" data-execution_count="291">
<div class="sourceCode cell-code" id="cb478"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb478-2"><a href="#cb478-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="291">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987215</td>
<td>0.849206</td>
<td>0.891667</td>
<td>0.869919</td>
<td>0.984438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.980823</td>
<td>0.785714</td>
<td>0.825000</td>
<td>0.804878</td>
<td>0.970545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.916500</td>
<td>0.322709</td>
<td>0.675000</td>
<td>0.436658</td>
<td>0.857550</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.978426</td>
<td>0.761905</td>
<td>0.800000</td>
<td>0.780488</td>
<td>0.972398</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.948861</td>
<td>0.468254</td>
<td>0.491667</td>
<td>0.479675</td>
<td>0.833809</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.979225</td>
<td>0.769841</td>
<td>0.808333</td>
<td>0.788618</td>
<td>0.971576</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.972034</td>
<td>0.698413</td>
<td>0.733333</td>
<td>0.715447</td>
<td>0.967954</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.932082</td>
<td>0.301587</td>
<td>0.316667</td>
<td>0.308943</td>
<td>0.859192</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.908909</td>
<td>0.071429</td>
<td>0.075000</td>
<td>0.073171</td>
<td>0.557431</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="so_gaal_bunny" class="level2">
<h2 class="anchored" data-anchor-id="so_gaal_bunny">SO_GAAL_Bunny</h2>
<div id="3fd43c4e-880e-437f-a09b-619abe27c8c0" class="cell" data-scrolled="true" data-execution_count="292">
<div class="sourceCode cell-code" id="cb479"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SO_GAAL(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb479-3"><a href="#cb479-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/keras/src/optimizers/legacy/gradient_descent.py:114: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super().__init__(name, **kwargs)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1 of 60

Testing for epoch 1 index 1:

Testing for epoch 1 index 2:

Testing for epoch 1 index 3:

Testing for epoch 1 index 4:

Testing for epoch 1 index 5:
Epoch 2 of 60

Testing for epoch 2 index 1:

Testing for epoch 2 index 2:

Testing for epoch 2 index 3:

Testing for epoch 2 index 4:

Testing for epoch 2 index 5:
Epoch 3 of 60

Testing for epoch 3 index 1:

Testing for epoch 3 index 2:

Testing for epoch 3 index 3:

Testing for epoch 3 index 4:

Testing for epoch 3 index 5:
Epoch 4 of 60

Testing for epoch 4 index 1:

Testing for epoch 4 index 2:

Testing for epoch 4 index 3:

Testing for epoch 4 index 4:

Testing for epoch 4 index 5:
Epoch 5 of 60

Testing for epoch 5 index 1:

Testing for epoch 5 index 2:

Testing for epoch 5 index 3:

Testing for epoch 5 index 4:

Testing for epoch 5 index 5:
Epoch 6 of 60

Testing for epoch 6 index 1:

Testing for epoch 6 index 2:

Testing for epoch 6 index 3:

Testing for epoch 6 index 4:

Testing for epoch 6 index 5:
Epoch 7 of 60

Testing for epoch 7 index 1:

Testing for epoch 7 index 2:

Testing for epoch 7 index 3:

Testing for epoch 7 index 4:

Testing for epoch 7 index 5:
Epoch 8 of 60

Testing for epoch 8 index 1:

Testing for epoch 8 index 2:

Testing for epoch 8 index 3:

Testing for epoch 8 index 4:

Testing for epoch 8 index 5:
Epoch 9 of 60

Testing for epoch 9 index 1:

Testing for epoch 9 index 2:

Testing for epoch 9 index 3:

Testing for epoch 9 index 4:

Testing for epoch 9 index 5:
Epoch 10 of 60

Testing for epoch 10 index 1:

Testing for epoch 10 index 2:

Testing for epoch 10 index 3:

Testing for epoch 10 index 4:

Testing for epoch 10 index 5:
Epoch 11 of 60

Testing for epoch 11 index 1:

Testing for epoch 11 index 2:

Testing for epoch 11 index 3:

Testing for epoch 11 index 4:

Testing for epoch 11 index 5:
Epoch 12 of 60

Testing for epoch 12 index 1:

Testing for epoch 12 index 2:

Testing for epoch 12 index 3:

Testing for epoch 12 index 4:

Testing for epoch 12 index 5:
Epoch 13 of 60

Testing for epoch 13 index 1:

Testing for epoch 13 index 2:

Testing for epoch 13 index 3:

Testing for epoch 13 index 4:

Testing for epoch 13 index 5:
Epoch 14 of 60

Testing for epoch 14 index 1:

Testing for epoch 14 index 2:

Testing for epoch 14 index 3:

Testing for epoch 14 index 4:

Testing for epoch 14 index 5:
Epoch 15 of 60

Testing for epoch 15 index 1:

Testing for epoch 15 index 2:

Testing for epoch 15 index 3:

Testing for epoch 15 index 4:

Testing for epoch 15 index 5:
Epoch 16 of 60

Testing for epoch 16 index 1:

Testing for epoch 16 index 2:

Testing for epoch 16 index 3:

Testing for epoch 16 index 4:

Testing for epoch 16 index 5:
Epoch 17 of 60

Testing for epoch 17 index 1:

Testing for epoch 17 index 2:

Testing for epoch 17 index 3:

Testing for epoch 17 index 4:

Testing for epoch 17 index 5:
Epoch 18 of 60

Testing for epoch 18 index 1:

Testing for epoch 18 index 2:

Testing for epoch 18 index 3:

Testing for epoch 18 index 4:

Testing for epoch 18 index 5:
Epoch 19 of 60

Testing for epoch 19 index 1:

Testing for epoch 19 index 2:

Testing for epoch 19 index 3:

Testing for epoch 19 index 4:

Testing for epoch 19 index 5:
Epoch 20 of 60

Testing for epoch 20 index 1:

Testing for epoch 20 index 2:

Testing for epoch 20 index 3:

Testing for epoch 20 index 4:

Testing for epoch 20 index 5:
Epoch 21 of 60

Testing for epoch 21 index 1:

Testing for epoch 21 index 2:

Testing for epoch 21 index 3:

Testing for epoch 21 index 4:

Testing for epoch 21 index 5:
Epoch 22 of 60

Testing for epoch 22 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.8892

Testing for epoch 22 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 1.8773

Testing for epoch 22 index 3:
16/16 [==============================] - 0s 968us/step - loss: 1.8953

Testing for epoch 22 index 4:
16/16 [==============================] - 0s 1ms/step - loss: 1.8628

Testing for epoch 22 index 5:
16/16 [==============================] - 0s 841us/step - loss: 1.9471
Epoch 23 of 60

Testing for epoch 23 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 1.9137

Testing for epoch 23 index 2:
16/16 [==============================] - 0s 854us/step - loss: 1.9870

Testing for epoch 23 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 1.9878

Testing for epoch 23 index 4:
16/16 [==============================] - 0s 1ms/step - loss: 1.9311

Testing for epoch 23 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 1.9295
Epoch 24 of 60

Testing for epoch 24 index 1:
16/16 [==============================] - 0s 888us/step - loss: 1.9993

Testing for epoch 24 index 2:
16/16 [==============================] - 0s 807us/step - loss: 1.9489

Testing for epoch 24 index 3:
16/16 [==============================] - 0s 1ms/step - loss: 1.9849

Testing for epoch 24 index 4:
16/16 [==============================] - 0s 813us/step - loss: 1.9797

Testing for epoch 24 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 1.9702
Epoch 25 of 60

Testing for epoch 25 index 1:
16/16 [==============================] - 0s 869us/step - loss: 2.0650

Testing for epoch 25 index 2:
16/16 [==============================] - 0s 798us/step - loss: 2.0078

Testing for epoch 25 index 3:
16/16 [==============================] - 0s 1ms/step - loss: 2.0171

Testing for epoch 25 index 4:
16/16 [==============================] - 0s 922us/step - loss: 2.0466

Testing for epoch 25 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.0635
Epoch 26 of 60

Testing for epoch 26 index 1:
16/16 [==============================] - 0s 956us/step - loss: 2.0758

Testing for epoch 26 index 2:
16/16 [==============================] - 0s 834us/step - loss: 2.0865

Testing for epoch 26 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.0039

Testing for epoch 26 index 4:
16/16 [==============================] - 0s 2ms/step - loss: 2.0798

Testing for epoch 26 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.0561
Epoch 27 of 60

Testing for epoch 27 index 1:
16/16 [==============================] - 0s 950us/step - loss: 2.1265

Testing for epoch 27 index 2:
16/16 [==============================] - 0s 801us/step - loss: 2.0775

Testing for epoch 27 index 3:
16/16 [==============================] - 0s 792us/step - loss: 2.0951

Testing for epoch 27 index 4:
16/16 [==============================] - 0s 805us/step - loss: 2.1185

Testing for epoch 27 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.1396
Epoch 28 of 60

Testing for epoch 28 index 1:
16/16 [==============================] - 0s 807us/step - loss: 2.1326

Testing for epoch 28 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.1569

Testing for epoch 28 index 3:
16/16 [==============================] - 0s 849us/step - loss: 2.0954

Testing for epoch 28 index 4:
16/16 [==============================] - 0s 2ms/step - loss: 2.0795

Testing for epoch 28 index 5:
16/16 [==============================] - 0s 1ms/step - loss: 2.1101
Epoch 29 of 60

Testing for epoch 29 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 2.1282

Testing for epoch 29 index 2:
16/16 [==============================] - 0s 830us/step - loss: 2.0985

Testing for epoch 29 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.0946

Testing for epoch 29 index 4:
16/16 [==============================] - 0s 1ms/step - loss: 2.0580

Testing for epoch 29 index 5:
16/16 [==============================] - 0s 1ms/step - loss: 2.0928
Epoch 30 of 60

Testing for epoch 30 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.1236

Testing for epoch 30 index 2:
16/16 [==============================] - 0s 800us/step - loss: 2.1554

Testing for epoch 30 index 3:
16/16 [==============================] - 0s 1ms/step - loss: 2.1987

Testing for epoch 30 index 4:
16/16 [==============================] - 0s 793us/step - loss: 2.1537

Testing for epoch 30 index 5:
16/16 [==============================] - 0s 870us/step - loss: 2.1312
Epoch 31 of 60

Testing for epoch 31 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 2.1679

Testing for epoch 31 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.2280

Testing for epoch 31 index 3:
16/16 [==============================] - 0s 834us/step - loss: 2.1869

Testing for epoch 31 index 4:
16/16 [==============================] - 0s 808us/step - loss: 2.1695

Testing for epoch 31 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.2448
Epoch 32 of 60

Testing for epoch 32 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.1599

Testing for epoch 32 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 2.2401

Testing for epoch 32 index 3:
16/16 [==============================] - 0s 755us/step - loss: 2.2098

Testing for epoch 32 index 4:
16/16 [==============================] - 0s 840us/step - loss: 2.2194

Testing for epoch 32 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.2362
Epoch 33 of 60

Testing for epoch 33 index 1:
16/16 [==============================] - 0s 793us/step - loss: 2.2603

Testing for epoch 33 index 2:
16/16 [==============================] - 0s 939us/step - loss: 2.1833

Testing for epoch 33 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.2989

Testing for epoch 33 index 4:
16/16 [==============================] - 0s 823us/step - loss: 2.2219

Testing for epoch 33 index 5:
16/16 [==============================] - 0s 801us/step - loss: 2.2803
Epoch 34 of 60

Testing for epoch 34 index 1:
16/16 [==============================] - 0s 784us/step - loss: 2.2164

Testing for epoch 34 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.2358

Testing for epoch 34 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.1974

Testing for epoch 34 index 4:
16/16 [==============================] - 0s 889us/step - loss: 2.2659

Testing for epoch 34 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.2727
Epoch 35 of 60

Testing for epoch 35 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.2802

Testing for epoch 35 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.2867

Testing for epoch 35 index 3:
16/16 [==============================] - 0s 1ms/step - loss: 2.2722

Testing for epoch 35 index 4:
16/16 [==============================] - 0s 857us/step - loss: 2.2683

Testing for epoch 35 index 5:
16/16 [==============================] - 0s 883us/step - loss: 2.3110
Epoch 36 of 60

Testing for epoch 36 index 1:
16/16 [==============================] - 0s 781us/step - loss: 2.2822

Testing for epoch 36 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.3013

Testing for epoch 36 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.3260

Testing for epoch 36 index 4:
16/16 [==============================] - 0s 911us/step - loss: 2.3637

Testing for epoch 36 index 5:
16/16 [==============================] - 0s 814us/step - loss: 2.2913
Epoch 37 of 60

Testing for epoch 37 index 1:
16/16 [==============================] - 0s 814us/step - loss: 2.3133

Testing for epoch 37 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 2.2731

Testing for epoch 37 index 3:
16/16 [==============================] - 0s 971us/step - loss: 2.3091

Testing for epoch 37 index 4:
16/16 [==============================] - 0s 2ms/step - loss: 2.3101

Testing for epoch 37 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.2987
Epoch 38 of 60

Testing for epoch 38 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 2.3002

Testing for epoch 38 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 2.2867

Testing for epoch 38 index 3:
16/16 [==============================] - 0s 843us/step - loss: 2.2980

Testing for epoch 38 index 4:
16/16 [==============================] - 0s 806us/step - loss: 2.3380

Testing for epoch 38 index 5:
16/16 [==============================] - 0s 1ms/step - loss: 2.2815
Epoch 39 of 60

Testing for epoch 39 index 1:
16/16 [==============================] - 0s 1ms/step - loss: 2.3563

Testing for epoch 39 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.3031

Testing for epoch 39 index 3:
16/16 [==============================] - 0s 868us/step - loss: 2.3611

Testing for epoch 39 index 4:
16/16 [==============================] - 0s 1ms/step - loss: 2.3812

Testing for epoch 39 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.3761
Epoch 40 of 60

Testing for epoch 40 index 1:
16/16 [==============================] - 0s 838us/step - loss: 2.3955

Testing for epoch 40 index 2:
16/16 [==============================] - 0s 796us/step - loss: 2.4065

Testing for epoch 40 index 3:
16/16 [==============================] - 0s 1ms/step - loss: 2.4450

Testing for epoch 40 index 4:
16/16 [==============================] - 0s 840us/step - loss: 2.3389

Testing for epoch 40 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.3475
Epoch 41 of 60

Testing for epoch 41 index 1:
16/16 [==============================] - 0s 821us/step - loss: 2.3851

Testing for epoch 41 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.3873

Testing for epoch 41 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.3659

Testing for epoch 41 index 4:
16/16 [==============================] - 0s 2ms/step - loss: 2.3792

Testing for epoch 41 index 5:
16/16 [==============================] - 0s 1ms/step - loss: 2.3896
Epoch 42 of 60

Testing for epoch 42 index 1:
16/16 [==============================] - 0s 985us/step - loss: 2.4595

Testing for epoch 42 index 2:
16/16 [==============================] - 0s 821us/step - loss: 2.4335

Testing for epoch 42 index 3:
16/16 [==============================] - 0s 1ms/step - loss: 2.3803

Testing for epoch 42 index 4:
16/16 [==============================] - 0s 827us/step - loss: 2.3513

Testing for epoch 42 index 5:
16/16 [==============================] - 0s 809us/step - loss: 2.4367
Epoch 43 of 60

Testing for epoch 43 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.3864

Testing for epoch 43 index 2:
16/16 [==============================] - 0s 795us/step - loss: 2.3912

Testing for epoch 43 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.4194

Testing for epoch 43 index 4:
16/16 [==============================] - 0s 799us/step - loss: 2.5205

Testing for epoch 43 index 5:
16/16 [==============================] - 0s 815us/step - loss: 2.4733
Epoch 44 of 60

Testing for epoch 44 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.4465

Testing for epoch 44 index 2:
16/16 [==============================] - 0s 1ms/step - loss: 2.4298

Testing for epoch 44 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.4497

Testing for epoch 44 index 4:
16/16 [==============================] - 0s 821us/step - loss: 2.4719

Testing for epoch 44 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.4463
Epoch 45 of 60

Testing for epoch 45 index 1:
16/16 [==============================] - 0s 824us/step - loss: 2.5313

Testing for epoch 45 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.4766

Testing for epoch 45 index 3:
16/16 [==============================] - 0s 956us/step - loss: 2.4820

Testing for epoch 45 index 4:
16/16 [==============================] - 0s 2ms/step - loss: 2.4411

Testing for epoch 45 index 5:
16/16 [==============================] - 0s 813us/step - loss: 2.4633
Epoch 46 of 60

Testing for epoch 46 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.4844

Testing for epoch 46 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.4777

Testing for epoch 46 index 3:
16/16 [==============================] - 0s 826us/step - loss: 2.4881

Testing for epoch 46 index 4:
16/16 [==============================] - 0s 800us/step - loss: 2.5910

Testing for epoch 46 index 5:
16/16 [==============================] - 0s 810us/step - loss: 2.3987
Epoch 47 of 60

Testing for epoch 47 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.5073

Testing for epoch 47 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.4767

Testing for epoch 47 index 3:
16/16 [==============================] - 0s 1ms/step - loss: 2.5076

Testing for epoch 47 index 4:
16/16 [==============================] - 0s 820us/step - loss: 2.4839

Testing for epoch 47 index 5:
16/16 [==============================] - 0s 822us/step - loss: 2.4424
Epoch 48 of 60

Testing for epoch 48 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.4959

Testing for epoch 48 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.5135

Testing for epoch 48 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.4452

Testing for epoch 48 index 4:
16/16 [==============================] - 0s 2ms/step - loss: 2.5420

Testing for epoch 48 index 5:
16/16 [==============================] - 0s 812us/step - loss: 2.5427
Epoch 49 of 60

Testing for epoch 49 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.4873

Testing for epoch 49 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.5430

Testing for epoch 49 index 3:
16/16 [==============================] - 0s 838us/step - loss: 2.4718

Testing for epoch 49 index 4:
16/16 [==============================] - 0s 2ms/step - loss: 2.5524

Testing for epoch 49 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.4794
Epoch 50 of 60

Testing for epoch 50 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.5831

Testing for epoch 50 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.5607

Testing for epoch 50 index 3:
16/16 [==============================] - 0s 835us/step - loss: 2.5869

Testing for epoch 50 index 4:
16/16 [==============================] - 0s 820us/step - loss: 2.5292

Testing for epoch 50 index 5:
16/16 [==============================] - 0s 818us/step - loss: 2.5355
Epoch 51 of 60

Testing for epoch 51 index 1:
16/16 [==============================] - 0s 794us/step - loss: 2.6074

Testing for epoch 51 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.5498

Testing for epoch 51 index 3:
16/16 [==============================] - 0s 798us/step - loss: 2.5585

Testing for epoch 51 index 4:
16/16 [==============================] - 0s 1ms/step - loss: 2.5851

Testing for epoch 51 index 5:
16/16 [==============================] - 0s 810us/step - loss: 2.5378
Epoch 52 of 60

Testing for epoch 52 index 1:
16/16 [==============================] - 0s 805us/step - loss: 2.5224

Testing for epoch 52 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.5417

Testing for epoch 52 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.5603

Testing for epoch 52 index 4:
16/16 [==============================] - 0s 2ms/step - loss: 2.5464

Testing for epoch 52 index 5:
16/16 [==============================] - 0s 1ms/step - loss: 2.5803
Epoch 53 of 60

Testing for epoch 53 index 1:
16/16 [==============================] - 0s 819us/step - loss: 2.5619

Testing for epoch 53 index 2:
16/16 [==============================] - 0s 797us/step - loss: 2.5412

Testing for epoch 53 index 3:
16/16 [==============================] - 0s 1ms/step - loss: 2.6601

Testing for epoch 53 index 4:
16/16 [==============================] - 0s 813us/step - loss: 2.4935

Testing for epoch 53 index 5:
16/16 [==============================] - 0s 1ms/step - loss: 2.5908
Epoch 54 of 60

Testing for epoch 54 index 1:
16/16 [==============================] - 0s 839us/step - loss: 2.5420

Testing for epoch 54 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.6080

Testing for epoch 54 index 3:
16/16 [==============================] - 0s 935us/step - loss: 2.5973

Testing for epoch 54 index 4:
16/16 [==============================] - 0s 820us/step - loss: 2.6289

Testing for epoch 54 index 5:
16/16 [==============================] - 0s 811us/step - loss: 2.6870
Epoch 55 of 60

Testing for epoch 55 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.5925

Testing for epoch 55 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.6485

Testing for epoch 55 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.6448

Testing for epoch 55 index 4:
16/16 [==============================] - 0s 1ms/step - loss: 2.5929

Testing for epoch 55 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.5843
Epoch 56 of 60

Testing for epoch 56 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.6255

Testing for epoch 56 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.6109

Testing for epoch 56 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.5776

Testing for epoch 56 index 4:
16/16 [==============================] - 0s 1ms/step - loss: 2.5939

Testing for epoch 56 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.6101
Epoch 57 of 60

Testing for epoch 57 index 1:
16/16 [==============================] - 0s 869us/step - loss: 2.6185

Testing for epoch 57 index 2:
16/16 [==============================] - 0s 811us/step - loss: 2.5944

Testing for epoch 57 index 3:
16/16 [==============================] - 0s 845us/step - loss: 2.6853

Testing for epoch 57 index 4:
16/16 [==============================] - 0s 808us/step - loss: 2.6887

Testing for epoch 57 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.5760
Epoch 58 of 60

Testing for epoch 58 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.7048

Testing for epoch 58 index 2:
16/16 [==============================] - 0s 939us/step - loss: 2.6857

Testing for epoch 58 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.7510

Testing for epoch 58 index 4:
16/16 [==============================] - 0s 2ms/step - loss: 2.6191

Testing for epoch 58 index 5:
16/16 [==============================] - 0s 812us/step - loss: 2.6330
Epoch 59 of 60

Testing for epoch 59 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.6354

Testing for epoch 59 index 2:
16/16 [==============================] - 0s 806us/step - loss: 2.6133

Testing for epoch 59 index 3:
16/16 [==============================] - 0s 895us/step - loss: 2.6335

Testing for epoch 59 index 4:
16/16 [==============================] - 0s 2ms/step - loss: 2.6475

Testing for epoch 59 index 5:
16/16 [==============================] - 0s 2ms/step - loss: 2.6326
Epoch 60 of 60

Testing for epoch 60 index 1:
16/16 [==============================] - 0s 2ms/step - loss: 2.7069

Testing for epoch 60 index 2:
16/16 [==============================] - 0s 2ms/step - loss: 2.7578

Testing for epoch 60 index 3:
16/16 [==============================] - 0s 2ms/step - loss: 2.7084

Testing for epoch 60 index 4:
16/16 [==============================] - 0s 2ms/step - loss: 2.6440

Testing for epoch 60 index 5:
16/16 [==============================] - 0s 914us/step - loss: 2.6770
79/79 [==============================] - 0s 732us/step</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="292">
<pre><code>SO_GAAL(contamination=0.05, lr_d=0.01, lr_g=0.0001, momentum=0.9,
    stop_epochs=20)</code></pre>
</div>
</div>
<div id="946c49b9-73da-445b-9377-57f7edfc9637" class="cell" data-execution_count="293">
<div class="sourceCode cell-code" id="cb483"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a>outlier_SO_GAAL_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="c4f6e006-6e33-40af-a49e-bb5ce8a4e674" class="cell" data-execution_count="294">
<div class="sourceCode cell-code" id="cb484"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_SO_GAAL_one)</span>
<span id="cb484-2"><a href="#cb484-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"SO-GAAL (Liu et al., 2019)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-295-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.952
Precision: 0.000
Recall: 0.000
F1 Score: 0.000</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))</code></pre>
</div>
</div>
<div id="8b09b1f6-da1f-42a5-99cc-456817635666" class="cell" data-execution_count="295">
<div class="sourceCode cell-code" id="cb487"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb487-3"><a href="#cb487-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb487-4"><a href="#cb487-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb487-5"><a href="#cb487-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.383
Precision(TP / TP + FP): nan
Recall(TP / TP + FN): 0.000
F1 Score(2*precision*recall/precision+recall): nan</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_3852735/4166638268.py:3: RuntimeWarning: invalid value encountered in long_scalars
  print('Precision(TP / TP + FP): %.3f' % round(_conf.conf_matrix[1][1]/(_conf.conf_matrix[0][1] + _conf.conf_matrix[1][1]),3))
/tmp/ipykernel_3852735/4166638268.py:5: RuntimeWarning: invalid value encountered in long_scalars
  print('F1 Score(2*precision*recall/precision+recall): %.3f' % round((2*(_conf.conf_matrix[1][1]/(_conf.conf_matrix[0][1] + _conf.conf_matrix[1][1]))*(_conf.conf_matrix[1][1]/(_conf.conf_matrix[1][0] + _conf.conf_matrix[1][1]))) / (_conf.conf_matrix[1][1]/(_conf.conf_matrix[0][1] + _conf.conf_matrix[1][1]) + _conf.conf_matrix[1][1]/(_conf.conf_matrix[1][0] + _conf.conf_matrix[1][1])),3))</code></pre>
</div>
</div>
<div id="e3dc16bb-5e29-4814-a043-11b02cab34d9" class="cell" data-execution_count="296">
<div class="sourceCode cell-code" id="cb490"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>79/79 [==============================] - 0s 527us/step</code></pre>
</div>
</div>
<div id="cc162830-b845-4a51-aa51-fcb9b96529cc" class="cell" data-execution_count="297">
<div class="sourceCode cell-code" id="cb492"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="297">
<pre><code>0.6730102112183523</code></pre>
</div>
</div>
<div id="0867d455-17d9-47e6-88f2-8db4c095986f" class="cell" data-execution_count="298">
<div class="sourceCode cell-code" id="cb494"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb494-2"><a href="#cb494-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="298">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987215</td>
<td>0.849206</td>
<td>0.891667</td>
<td>0.869919</td>
<td>0.984438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.980823</td>
<td>0.785714</td>
<td>0.825000</td>
<td>0.804878</td>
<td>0.970545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.916500</td>
<td>0.322709</td>
<td>0.675000</td>
<td>0.436658</td>
<td>0.857550</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.978426</td>
<td>0.761905</td>
<td>0.800000</td>
<td>0.780488</td>
<td>0.972398</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.948861</td>
<td>0.468254</td>
<td>0.491667</td>
<td>0.479675</td>
<td>0.833809</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.979225</td>
<td>0.769841</td>
<td>0.808333</td>
<td>0.788618</td>
<td>0.971576</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.972034</td>
<td>0.698413</td>
<td>0.733333</td>
<td>0.715447</td>
<td>0.967954</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.932082</td>
<td>0.301587</td>
<td>0.316667</td>
<td>0.308943</td>
<td>0.859192</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.908909</td>
<td>0.071429</td>
<td>0.075000</td>
<td>0.073171</td>
<td>0.557431</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SO-GAAL (Liu et al., 2019)</td>
<td>0.952058</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.673010</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="mo_gaal_bunny" class="level2">
<h2 class="anchored" data-anchor-id="mo_gaal_bunny">MO_GAAL_Bunny</h2>
<div id="0fbe9d74-7fc4-43b9-add2-749c8ecb3415" class="cell" data-scrolled="true" data-execution_count="299">
<div class="sourceCode cell-code" id="cb495"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">77</span>)</span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> MO_GAAL(contamination<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb495-3"><a href="#cb495-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/keras/src/optimizers/legacy/gradient_descent.py:114: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super().__init__(name, **kwargs)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1 of 60

Testing for epoch 1 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 1 index 2:
79/79 [==============================] - 0s 2ms/step

Testing for epoch 1 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 1 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 1 index 5:
79/79 [==============================] - 0s 822us/step
Epoch 2 of 60

Testing for epoch 2 index 1:
79/79 [==============================] - 0s 556us/step

Testing for epoch 2 index 2:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 2 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 2 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 2 index 5:
79/79 [==============================] - 0s 1ms/step
Epoch 3 of 60

Testing for epoch 3 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 3 index 2:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 3 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 3 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 3 index 5:
79/79 [==============================] - 0s 1ms/step
Epoch 4 of 60

Testing for epoch 4 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 4 index 2:
79/79 [==============================] - 0s 832us/step

Testing for epoch 4 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 4 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 4 index 5:
79/79 [==============================] - 0s 2ms/step
Epoch 5 of 60

Testing for epoch 5 index 1:
79/79 [==============================] - 0s 540us/step

Testing for epoch 5 index 2:
79/79 [==============================] - 0s 539us/step

Testing for epoch 5 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 5 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 5 index 5:
79/79 [==============================] - 0s 792us/step
Epoch 6 of 60

Testing for epoch 6 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 6 index 2:
79/79 [==============================] - 0s 527us/step

Testing for epoch 6 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 6 index 4:
79/79 [==============================] - 0s 928us/step

Testing for epoch 6 index 5:
79/79 [==============================] - 0s 1ms/step
Epoch 7 of 60

Testing for epoch 7 index 1:
79/79 [==============================] - 0s 2ms/step

Testing for epoch 7 index 2:
79/79 [==============================] - 0s 994us/step

Testing for epoch 7 index 3:
79/79 [==============================] - 0s 2ms/step

Testing for epoch 7 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 7 index 5:
79/79 [==============================] - 0s 612us/step
Epoch 8 of 60

Testing for epoch 8 index 1:
79/79 [==============================] - 0s 919us/step

Testing for epoch 8 index 2:
79/79 [==============================] - 0s 990us/step

Testing for epoch 8 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 8 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 8 index 5:
79/79 [==============================] - 0s 901us/step
Epoch 9 of 60

Testing for epoch 9 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 9 index 2:
79/79 [==============================] - 0s 567us/step

Testing for epoch 9 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 9 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 9 index 5:
79/79 [==============================] - 0s 568us/step
Epoch 10 of 60

Testing for epoch 10 index 1:
79/79 [==============================] - 0s 6ms/step

Testing for epoch 10 index 2:
79/79 [==============================] - 0s 534us/step

Testing for epoch 10 index 3:
79/79 [==============================] - 0s 541us/step

Testing for epoch 10 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 10 index 5:
79/79 [==============================] - 0s 527us/step
Epoch 11 of 60

Testing for epoch 11 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 11 index 2:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 11 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 11 index 4:
79/79 [==============================] - 0s 999us/step

Testing for epoch 11 index 5:
79/79 [==============================] - 0s 2ms/step
Epoch 12 of 60

Testing for epoch 12 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 12 index 2:
79/79 [==============================] - 0s 2ms/step

Testing for epoch 12 index 3:
79/79 [==============================] - 0s 927us/step

Testing for epoch 12 index 4:
79/79 [==============================] - 0s 2ms/step

Testing for epoch 12 index 5:
79/79 [==============================] - 0s 544us/step
Epoch 13 of 60

Testing for epoch 13 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 13 index 2:
79/79 [==============================] - 0s 999us/step

Testing for epoch 13 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 13 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 13 index 5:
79/79 [==============================] - 0s 538us/step
Epoch 14 of 60

Testing for epoch 14 index 1:
79/79 [==============================] - 0s 533us/step

Testing for epoch 14 index 2:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 14 index 3:
79/79 [==============================] - 0s 521us/step

Testing for epoch 14 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 14 index 5:
79/79 [==============================] - 0s 535us/step
Epoch 15 of 60

Testing for epoch 15 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 15 index 2:
79/79 [==============================] - 0s 2ms/step

Testing for epoch 15 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 15 index 4:
79/79 [==============================] - 0s 534us/step

Testing for epoch 15 index 5:
79/79 [==============================] - 0s 1ms/step
Epoch 16 of 60

Testing for epoch 16 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 16 index 2:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 16 index 3:
79/79 [==============================] - 0s 2ms/step

Testing for epoch 16 index 4:
79/79 [==============================] - 0s 2ms/step

Testing for epoch 16 index 5:
79/79 [==============================] - 0s 533us/step
Epoch 17 of 60

Testing for epoch 17 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 17 index 2:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 17 index 3:
79/79 [==============================] - 0s 532us/step

Testing for epoch 17 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 17 index 5:
79/79 [==============================] - 0s 812us/step
Epoch 18 of 60

Testing for epoch 18 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 18 index 2:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 18 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 18 index 4:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 18 index 5:
79/79 [==============================] - 0s 1ms/step
Epoch 19 of 60

Testing for epoch 19 index 1:
79/79 [==============================] - 0s 989us/step

Testing for epoch 19 index 2:
79/79 [==============================] - 0s 531us/step

Testing for epoch 19 index 3:
79/79 [==============================] - 0s 969us/step

Testing for epoch 19 index 4:
79/79 [==============================] - 0s 2ms/step

Testing for epoch 19 index 5:
79/79 [==============================] - 0s 1ms/step
Epoch 20 of 60

Testing for epoch 20 index 1:
79/79 [==============================] - 0s 672us/step

Testing for epoch 20 index 2:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 20 index 3:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 20 index 4:
79/79 [==============================] - 0s 965us/step

Testing for epoch 20 index 5:
79/79 [==============================] - 0s 2ms/step
Epoch 21 of 60

Testing for epoch 21 index 1:
79/79 [==============================] - 0s 1ms/step

Testing for epoch 21 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1840
16/16 [==============================] - 0s 861us/step - loss: 1.4152
16/16 [==============================] - 0s 2ms/step - loss: 1.6292
16/16 [==============================] - 0s 2ms/step - loss: 1.6820
16/16 [==============================] - 0s 2ms/step - loss: 1.6830
16/16 [==============================] - 0s 863us/step - loss: 1.6735
16/16 [==============================] - 0s 2ms/step - loss: 1.6625
16/16 [==============================] - 0s 2ms/step - loss: 1.6544
16/16 [==============================] - 0s 2ms/step - loss: 1.6507
16/16 [==============================] - 0s 2ms/step - loss: 1.6493

Testing for epoch 21 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.1812
16/16 [==============================] - 0s 900us/step - loss: 1.4503
16/16 [==============================] - 0s 853us/step - loss: 1.6832
16/16 [==============================] - 0s 846us/step - loss: 1.7404
16/16 [==============================] - 0s 1ms/step - loss: 1.7416
16/16 [==============================] - 0s 848us/step - loss: 1.7307
16/16 [==============================] - 0s 859us/step - loss: 1.7183
16/16 [==============================] - 0s 869us/step - loss: 1.7096
16/16 [==============================] - 0s 857us/step - loss: 1.7057
16/16 [==============================] - 0s 864us/step - loss: 1.7044

Testing for epoch 21 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1766
16/16 [==============================] - 0s 915us/step - loss: 1.4131
16/16 [==============================] - 0s 2ms/step - loss: 1.6342
16/16 [==============================] - 0s 890us/step - loss: 1.6873
16/16 [==============================] - 0s 1ms/step - loss: 1.6871
16/16 [==============================] - 0s 1ms/step - loss: 1.6767
16/16 [==============================] - 0s 1ms/step - loss: 1.6644
16/16 [==============================] - 0s 2ms/step - loss: 1.6559
16/16 [==============================] - 0s 2ms/step - loss: 1.6521
16/16 [==============================] - 0s 1ms/step - loss: 1.6509

Testing for epoch 21 index 5:
79/79 [==============================] - 0s 927us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.1745
16/16 [==============================] - 0s 2ms/step - loss: 1.4735
16/16 [==============================] - 0s 2ms/step - loss: 1.7117
16/16 [==============================] - 0s 1ms/step - loss: 1.7696
16/16 [==============================] - 0s 864us/step - loss: 1.7706
16/16 [==============================] - 0s 2ms/step - loss: 1.7616
16/16 [==============================] - 0s 2ms/step - loss: 1.7494
16/16 [==============================] - 0s 2ms/step - loss: 1.7407
16/16 [==============================] - 0s 889us/step - loss: 1.7368
16/16 [==============================] - 0s 2ms/step - loss: 1.7354
Epoch 22 of 60

Testing for epoch 22 index 1:
79/79 [==============================] - 0s 678us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.1723
16/16 [==============================] - 0s 2ms/step - loss: 1.4294
16/16 [==============================] - 0s 901us/step - loss: 1.6597
16/16 [==============================] - 0s 2ms/step - loss: 1.7140
16/16 [==============================] - 0s 833us/step - loss: 1.7139
16/16 [==============================] - 0s 833us/step - loss: 1.7050
16/16 [==============================] - 0s 2ms/step - loss: 1.6925
16/16 [==============================] - 0s 2ms/step - loss: 1.6839
16/16 [==============================] - 0s 1ms/step - loss: 1.6801
16/16 [==============================] - 0s 1ms/step - loss: 1.6788

Testing for epoch 22 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1642
16/16 [==============================] - 0s 937us/step - loss: 1.5060
16/16 [==============================] - 0s 1ms/step - loss: 1.7582
16/16 [==============================] - 0s 2ms/step - loss: 1.8145
16/16 [==============================] - 0s 1ms/step - loss: 1.8126
16/16 [==============================] - 0s 2ms/step - loss: 1.8008
16/16 [==============================] - 0s 1ms/step - loss: 1.7866
16/16 [==============================] - 0s 1ms/step - loss: 1.7772
16/16 [==============================] - 0s 2ms/step - loss: 1.7731
16/16 [==============================] - 0s 2ms/step - loss: 1.7717

Testing for epoch 22 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1661
16/16 [==============================] - 0s 860us/step - loss: 1.4501
16/16 [==============================] - 0s 2ms/step - loss: 1.6971
16/16 [==============================] - 0s 925us/step - loss: 1.7575
16/16 [==============================] - 0s 2ms/step - loss: 1.7591
16/16 [==============================] - 0s 2ms/step - loss: 1.7501
16/16 [==============================] - 0s 2ms/step - loss: 1.7368
16/16 [==============================] - 0s 969us/step - loss: 1.7276
16/16 [==============================] - 0s 2ms/step - loss: 1.7235
16/16 [==============================] - 0s 2ms/step - loss: 1.7221

Testing for epoch 22 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.1628
16/16 [==============================] - 0s 2ms/step - loss: 1.4725
16/16 [==============================] - 0s 2ms/step - loss: 1.7223
16/16 [==============================] - 0s 869us/step - loss: 1.7835
16/16 [==============================] - 0s 2ms/step - loss: 1.7839
16/16 [==============================] - 0s 2ms/step - loss: 1.7738
16/16 [==============================] - 0s 2ms/step - loss: 1.7600
16/16 [==============================] - 0s 886us/step - loss: 1.7510
16/16 [==============================] - 0s 2ms/step - loss: 1.7470
16/16 [==============================] - 0s 899us/step - loss: 1.7457

Testing for epoch 22 index 5:
79/79 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1607
16/16 [==============================] - 0s 2ms/step - loss: 1.4542
16/16 [==============================] - 0s 995us/step - loss: 1.7067
16/16 [==============================] - 0s 830us/step - loss: 1.7676
16/16 [==============================] - 0s 804us/step - loss: 1.7679
16/16 [==============================] - 0s 802us/step - loss: 1.7587
16/16 [==============================] - 0s 827us/step - loss: 1.7455
16/16 [==============================] - 0s 2ms/step - loss: 1.7365
16/16 [==============================] - 0s 811us/step - loss: 1.7324
16/16 [==============================] - 0s 790us/step - loss: 1.7309
Epoch 23 of 60

Testing for epoch 23 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 893us/step - loss: 0.1558
16/16 [==============================] - 0s 2ms/step - loss: 1.4940
16/16 [==============================] - 0s 2ms/step - loss: 1.7608
16/16 [==============================] - 0s 2ms/step - loss: 1.8229
16/16 [==============================] - 0s 2ms/step - loss: 1.8213
16/16 [==============================] - 0s 857us/step - loss: 1.8105
16/16 [==============================] - 0s 792us/step - loss: 1.7952
16/16 [==============================] - 0s 2ms/step - loss: 1.7854
16/16 [==============================] - 0s 2ms/step - loss: 1.7812
16/16 [==============================] - 0s 1ms/step - loss: 1.7798

Testing for epoch 23 index 2:
79/79 [==============================] - 0s 529us/step
16/16 [==============================] - 0s 780us/step - loss: 0.1554
16/16 [==============================] - 0s 806us/step - loss: 1.4708
16/16 [==============================] - 0s 777us/step - loss: 1.7371
16/16 [==============================] - 0s 2ms/step - loss: 1.8014
16/16 [==============================] - 0s 1ms/step - loss: 1.8023
16/16 [==============================] - 0s 821us/step - loss: 1.7935
16/16 [==============================] - 0s 841us/step - loss: 1.7807
16/16 [==============================] - 0s 803us/step - loss: 1.7715
16/16 [==============================] - 0s 792us/step - loss: 1.7674
16/16 [==============================] - 0s 792us/step - loss: 1.7659

Testing for epoch 23 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 921us/step - loss: 0.1535
16/16 [==============================] - 0s 2ms/step - loss: 1.4858
16/16 [==============================] - 0s 820us/step - loss: 1.7596
16/16 [==============================] - 0s 800us/step - loss: 1.8211
16/16 [==============================] - 0s 793us/step - loss: 1.8196
16/16 [==============================] - 0s 2ms/step - loss: 1.8077
16/16 [==============================] - 0s 840us/step - loss: 1.7924
16/16 [==============================] - 0s 870us/step - loss: 1.7827
16/16 [==============================] - 0s 1ms/step - loss: 1.7786
16/16 [==============================] - 0s 2ms/step - loss: 1.7772

Testing for epoch 23 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 849us/step - loss: 0.1485
16/16 [==============================] - 0s 2ms/step - loss: 1.4917
16/16 [==============================] - 0s 1ms/step - loss: 1.7753
16/16 [==============================] - 0s 901us/step - loss: 1.8377
16/16 [==============================] - 0s 1ms/step - loss: 1.8375
16/16 [==============================] - 0s 1ms/step - loss: 1.8268
16/16 [==============================] - 0s 2ms/step - loss: 1.8121
16/16 [==============================] - 0s 901us/step - loss: 1.8024
16/16 [==============================] - 0s 909us/step - loss: 1.7981
16/16 [==============================] - 0s 815us/step - loss: 1.7966

Testing for epoch 23 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1484
16/16 [==============================] - 0s 1ms/step - loss: 1.4544
16/16 [==============================] - 0s 846us/step - loss: 1.7244
16/16 [==============================] - 0s 2ms/step - loss: 1.7837
16/16 [==============================] - 0s 2ms/step - loss: 1.7832
16/16 [==============================] - 0s 856us/step - loss: 1.7717
16/16 [==============================] - 0s 811us/step - loss: 1.7570
16/16 [==============================] - 0s 2ms/step - loss: 1.7477
16/16 [==============================] - 0s 2ms/step - loss: 1.7438
16/16 [==============================] - 0s 2ms/step - loss: 1.7425
Epoch 24 of 60

Testing for epoch 24 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.1439
16/16 [==============================] - 0s 2ms/step - loss: 1.4811
16/16 [==============================] - 0s 876us/step - loss: 1.7631
16/16 [==============================] - 0s 793us/step - loss: 1.8232
16/16 [==============================] - 0s 2ms/step - loss: 1.8216
16/16 [==============================] - 0s 2ms/step - loss: 1.8096
16/16 [==============================] - 0s 2ms/step - loss: 1.7938
16/16 [==============================] - 0s 2ms/step - loss: 1.7839
16/16 [==============================] - 0s 2ms/step - loss: 1.7796
16/16 [==============================] - 0s 826us/step - loss: 1.7781

Testing for epoch 24 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 941us/step - loss: 0.1409
16/16 [==============================] - 0s 997us/step - loss: 1.5099
16/16 [==============================] - 0s 2ms/step - loss: 1.8010
16/16 [==============================] - 0s 2ms/step - loss: 1.8576
16/16 [==============================] - 0s 861us/step - loss: 1.8541
16/16 [==============================] - 0s 1ms/step - loss: 1.8404
16/16 [==============================] - 0s 2ms/step - loss: 1.8234
16/16 [==============================] - 0s 828us/step - loss: 1.8131
16/16 [==============================] - 0s 1ms/step - loss: 1.8088
16/16 [==============================] - 0s 850us/step - loss: 1.8075

Testing for epoch 24 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 825us/step - loss: 0.1407
16/16 [==============================] - 0s 784us/step - loss: 1.5069
16/16 [==============================] - 0s 802us/step - loss: 1.8032
16/16 [==============================] - 0s 1ms/step - loss: 1.8644
16/16 [==============================] - 0s 2ms/step - loss: 1.8632
16/16 [==============================] - 0s 835us/step - loss: 1.8512
16/16 [==============================] - 0s 836us/step - loss: 1.8357
16/16 [==============================] - 0s 2ms/step - loss: 1.8259
16/16 [==============================] - 0s 2ms/step - loss: 1.8218
16/16 [==============================] - 0s 966us/step - loss: 1.8204

Testing for epoch 24 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1394
16/16 [==============================] - 0s 844us/step - loss: 1.4794
16/16 [==============================] - 0s 804us/step - loss: 1.7777
16/16 [==============================] - 0s 740us/step - loss: 1.8444
16/16 [==============================] - 0s 774us/step - loss: 1.8460
16/16 [==============================] - 0s 799us/step - loss: 1.8363
16/16 [==============================] - 0s 795us/step - loss: 1.8218
16/16 [==============================] - 0s 774us/step - loss: 1.8121
16/16 [==============================] - 0s 805us/step - loss: 1.8078
16/16 [==============================] - 0s 791us/step - loss: 1.8063

Testing for epoch 24 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 834us/step - loss: 0.1379
16/16 [==============================] - 0s 814us/step - loss: 1.5212
16/16 [==============================] - 0s 1ms/step - loss: 1.8264
16/16 [==============================] - 0s 2ms/step - loss: 1.8886
16/16 [==============================] - 0s 801us/step - loss: 1.8851
16/16 [==============================] - 0s 798us/step - loss: 1.8698
16/16 [==============================] - 0s 1ms/step - loss: 1.8519
16/16 [==============================] - 0s 816us/step - loss: 1.8410
16/16 [==============================] - 0s 799us/step - loss: 1.8365
16/16 [==============================] - 0s 2ms/step - loss: 1.8350
Epoch 25 of 60

Testing for epoch 25 index 1:
79/79 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1387
16/16 [==============================] - 0s 944us/step - loss: 1.5261
16/16 [==============================] - 0s 789us/step - loss: 1.8311
16/16 [==============================] - 0s 2ms/step - loss: 1.8989
16/16 [==============================] - 0s 822us/step - loss: 1.8986
16/16 [==============================] - 0s 811us/step - loss: 1.8862
16/16 [==============================] - 0s 784us/step - loss: 1.8695
16/16 [==============================] - 0s 783us/step - loss: 1.8590
16/16 [==============================] - 0s 807us/step - loss: 1.8545
16/16 [==============================] - 0s 806us/step - loss: 1.8530

Testing for epoch 25 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1400
16/16 [==============================] - 0s 879us/step - loss: 1.5416
16/16 [==============================] - 0s 2ms/step - loss: 1.8371
16/16 [==============================] - 0s 877us/step - loss: 1.8998
16/16 [==============================] - 0s 2ms/step - loss: 1.8958
16/16 [==============================] - 0s 1ms/step - loss: 1.8811
16/16 [==============================] - 0s 1ms/step - loss: 1.8632
16/16 [==============================] - 0s 813us/step - loss: 1.8526
16/16 [==============================] - 0s 2ms/step - loss: 1.8483
16/16 [==============================] - 0s 2ms/step - loss: 1.8469

Testing for epoch 25 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 881us/step - loss: 0.1348
16/16 [==============================] - 0s 922us/step - loss: 1.5746
16/16 [==============================] - 0s 867us/step - loss: 1.8787
16/16 [==============================] - 0s 2ms/step - loss: 1.9429
16/16 [==============================] - 0s 1ms/step - loss: 1.9376
16/16 [==============================] - 0s 2ms/step - loss: 1.9217
16/16 [==============================] - 0s 825us/step - loss: 1.9027
16/16 [==============================] - 0s 2ms/step - loss: 1.8917
16/16 [==============================] - 0s 2ms/step - loss: 1.8873
16/16 [==============================] - 0s 970us/step - loss: 1.8860

Testing for epoch 25 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.1318
16/16 [==============================] - 0s 2ms/step - loss: 1.5680
16/16 [==============================] - 0s 937us/step - loss: 1.8780
16/16 [==============================] - 0s 2ms/step - loss: 1.9470
16/16 [==============================] - 0s 937us/step - loss: 1.9437
16/16 [==============================] - 0s 2ms/step - loss: 1.9288
16/16 [==============================] - 0s 1ms/step - loss: 1.9096
16/16 [==============================] - 0s 2ms/step - loss: 1.8985
16/16 [==============================] - 0s 1ms/step - loss: 1.8940
16/16 [==============================] - 0s 2ms/step - loss: 1.8925

Testing for epoch 25 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.1323
16/16 [==============================] - 0s 785us/step - loss: 1.5430
16/16 [==============================] - 0s 2ms/step - loss: 1.8371
16/16 [==============================] - 0s 2ms/step - loss: 1.9035
16/16 [==============================] - 0s 1ms/step - loss: 1.9006
16/16 [==============================] - 0s 891us/step - loss: 1.8875
16/16 [==============================] - 0s 1ms/step - loss: 1.8704
16/16 [==============================] - 0s 2ms/step - loss: 1.8601
16/16 [==============================] - 0s 788us/step - loss: 1.8559
16/16 [==============================] - 0s 785us/step - loss: 1.8545
Epoch 26 of 60

Testing for epoch 26 index 1:
79/79 [==============================] - 0s 548us/step
16/16 [==============================] - 0s 808us/step - loss: 0.1312
16/16 [==============================] - 0s 2ms/step - loss: 1.5662
16/16 [==============================] - 0s 1ms/step - loss: 1.8601
16/16 [==============================] - 0s 1ms/step - loss: 1.9226
16/16 [==============================] - 0s 797us/step - loss: 1.9149
16/16 [==============================] - 0s 2ms/step - loss: 1.8993
16/16 [==============================] - 0s 791us/step - loss: 1.8800
16/16 [==============================] - 0s 2ms/step - loss: 1.8689
16/16 [==============================] - 0s 779us/step - loss: 1.8644
16/16 [==============================] - 0s 2ms/step - loss: 1.8630

Testing for epoch 26 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1308
16/16 [==============================] - 0s 2ms/step - loss: 1.5812
16/16 [==============================] - 0s 1ms/step - loss: 1.8801
16/16 [==============================] - 0s 831us/step - loss: 1.9452
16/16 [==============================] - 0s 828us/step - loss: 1.9388
16/16 [==============================] - 0s 2ms/step - loss: 1.9232
16/16 [==============================] - 0s 1ms/step - loss: 1.9043
16/16 [==============================] - 0s 2ms/step - loss: 1.8934
16/16 [==============================] - 0s 2ms/step - loss: 1.8890
16/16 [==============================] - 0s 2ms/step - loss: 1.8877

Testing for epoch 26 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1296
16/16 [==============================] - 0s 920us/step - loss: 1.5545
16/16 [==============================] - 0s 2ms/step - loss: 1.8535
16/16 [==============================] - 0s 2ms/step - loss: 1.9218
16/16 [==============================] - 0s 866us/step - loss: 1.9171
16/16 [==============================] - 0s 2ms/step - loss: 1.9035
16/16 [==============================] - 0s 894us/step - loss: 1.8858
16/16 [==============================] - 0s 839us/step - loss: 1.8753
16/16 [==============================] - 0s 2ms/step - loss: 1.8710
16/16 [==============================] - 0s 1ms/step - loss: 1.8696

Testing for epoch 26 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 930us/step - loss: 0.1253
16/16 [==============================] - 0s 784us/step - loss: 1.5799
16/16 [==============================] - 0s 2ms/step - loss: 1.8860
16/16 [==============================] - 0s 859us/step - loss: 1.9532
16/16 [==============================] - 0s 797us/step - loss: 1.9468
16/16 [==============================] - 0s 792us/step - loss: 1.9325
16/16 [==============================] - 0s 2ms/step - loss: 1.9138
16/16 [==============================] - 0s 827us/step - loss: 1.9027
16/16 [==============================] - 0s 2ms/step - loss: 1.8982
16/16 [==============================] - 0s 2ms/step - loss: 1.8967

Testing for epoch 26 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.1269
16/16 [==============================] - 0s 1ms/step - loss: 1.5803
16/16 [==============================] - 0s 1ms/step - loss: 1.8920
16/16 [==============================] - 0s 970us/step - loss: 1.9613
16/16 [==============================] - 0s 2ms/step - loss: 1.9560
16/16 [==============================] - 0s 834us/step - loss: 1.9420
16/16 [==============================] - 0s 837us/step - loss: 1.9229
16/16 [==============================] - 0s 2ms/step - loss: 1.9119
16/16 [==============================] - 0s 1ms/step - loss: 1.9075
16/16 [==============================] - 0s 2ms/step - loss: 1.9061
Epoch 27 of 60

Testing for epoch 27 index 1:
79/79 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1268
16/16 [==============================] - 0s 928us/step - loss: 1.5500
16/16 [==============================] - 0s 2ms/step - loss: 1.8525
16/16 [==============================] - 0s 2ms/step - loss: 1.9169
16/16 [==============================] - 0s 852us/step - loss: 1.9095
16/16 [==============================] - 0s 2ms/step - loss: 1.8953
16/16 [==============================] - 0s 896us/step - loss: 1.8767
16/16 [==============================] - 0s 1ms/step - loss: 1.8661
16/16 [==============================] - 0s 2ms/step - loss: 1.8618
16/16 [==============================] - 0s 848us/step - loss: 1.8605

Testing for epoch 27 index 2:
79/79 [==============================] - 0s 532us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.1281
16/16 [==============================] - 0s 796us/step - loss: 1.5308
16/16 [==============================] - 0s 798us/step - loss: 1.8295
16/16 [==============================] - 0s 807us/step - loss: 1.8894
16/16 [==============================] - 0s 2ms/step - loss: 1.8819
16/16 [==============================] - 0s 861us/step - loss: 1.8655
16/16 [==============================] - 0s 2ms/step - loss: 1.8453
16/16 [==============================] - 0s 1ms/step - loss: 1.8344
16/16 [==============================] - 0s 813us/step - loss: 1.8300
16/16 [==============================] - 0s 898us/step - loss: 1.8287

Testing for epoch 27 index 3:
79/79 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 945us/step - loss: 0.1295
16/16 [==============================] - 0s 857us/step - loss: 1.5644
16/16 [==============================] - 0s 803us/step - loss: 1.8682
16/16 [==============================] - 0s 830us/step - loss: 1.9264
16/16 [==============================] - 0s 2ms/step - loss: 1.9168
16/16 [==============================] - 0s 2ms/step - loss: 1.8978
16/16 [==============================] - 0s 2ms/step - loss: 1.8759
16/16 [==============================] - 0s 1ms/step - loss: 1.8643
16/16 [==============================] - 0s 1ms/step - loss: 1.8598
16/16 [==============================] - 0s 2ms/step - loss: 1.8584

Testing for epoch 27 index 4:
79/79 [==============================] - 0s 838us/step
16/16 [==============================] - 0s 893us/step - loss: 0.1229
16/16 [==============================] - 0s 843us/step - loss: 1.6017
16/16 [==============================] - 0s 2ms/step - loss: 1.9158
16/16 [==============================] - 0s 1ms/step - loss: 1.9750
16/16 [==============================] - 0s 842us/step - loss: 1.9655
16/16 [==============================] - 0s 1ms/step - loss: 1.9476
16/16 [==============================] - 0s 864us/step - loss: 1.9272
16/16 [==============================] - 0s 1ms/step - loss: 1.9159
16/16 [==============================] - 0s 2ms/step - loss: 1.9113
16/16 [==============================] - 0s 1ms/step - loss: 1.9099

Testing for epoch 27 index 5:
79/79 [==============================] - 0s 623us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1209
16/16 [==============================] - 0s 2ms/step - loss: 1.6582
16/16 [==============================] - 0s 1ms/step - loss: 1.9963
16/16 [==============================] - 0s 815us/step - loss: 2.0588
16/16 [==============================] - 0s 809us/step - loss: 2.0491
16/16 [==============================] - 0s 902us/step - loss: 2.0283
16/16 [==============================] - 0s 2ms/step - loss: 2.0048
16/16 [==============================] - 0s 785us/step - loss: 1.9922
16/16 [==============================] - 0s 2ms/step - loss: 1.9874
16/16 [==============================] - 0s 794us/step - loss: 1.9860
Epoch 28 of 60

Testing for epoch 28 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1205
16/16 [==============================] - 0s 2ms/step - loss: 1.6297
16/16 [==============================] - 0s 1ms/step - loss: 1.9572
16/16 [==============================] - 0s 2ms/step - loss: 2.0155
16/16 [==============================] - 0s 2ms/step - loss: 2.0083
16/16 [==============================] - 0s 1ms/step - loss: 1.9886
16/16 [==============================] - 0s 2ms/step - loss: 1.9666
16/16 [==============================] - 0s 845us/step - loss: 1.9547
16/16 [==============================] - 0s 813us/step - loss: 1.9500
16/16 [==============================] - 0s 819us/step - loss: 1.9486

Testing for epoch 28 index 2:
79/79 [==============================] - 0s 965us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1231
16/16 [==============================] - 0s 2ms/step - loss: 1.5918
16/16 [==============================] - 0s 2ms/step - loss: 1.9122
16/16 [==============================] - 0s 2ms/step - loss: 1.9660
16/16 [==============================] - 0s 990us/step - loss: 1.9574
16/16 [==============================] - 0s 1ms/step - loss: 1.9368
16/16 [==============================] - 0s 2ms/step - loss: 1.9143
16/16 [==============================] - 0s 2ms/step - loss: 1.9024
16/16 [==============================] - 0s 864us/step - loss: 1.8977
16/16 [==============================] - 0s 841us/step - loss: 1.8962

Testing for epoch 28 index 3:
79/79 [==============================] - 0s 952us/step
16/16 [==============================] - 0s 806us/step - loss: 0.1199
16/16 [==============================] - 0s 2ms/step - loss: 1.6289
16/16 [==============================] - 0s 807us/step - loss: 1.9569
16/16 [==============================] - 0s 791us/step - loss: 2.0083
16/16 [==============================] - 0s 808us/step - loss: 1.9981
16/16 [==============================] - 0s 2ms/step - loss: 1.9776
16/16 [==============================] - 0s 829us/step - loss: 1.9548
16/16 [==============================] - 0s 2ms/step - loss: 1.9428
16/16 [==============================] - 0s 822us/step - loss: 1.9382
16/16 [==============================] - 0s 962us/step - loss: 1.9368

Testing for epoch 28 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 885us/step - loss: 0.1181
16/16 [==============================] - 0s 2ms/step - loss: 1.6031
16/16 [==============================] - 0s 2ms/step - loss: 1.9313
16/16 [==============================] - 0s 2ms/step - loss: 1.9866
16/16 [==============================] - 0s 2ms/step - loss: 1.9794
16/16 [==============================] - 0s 925us/step - loss: 1.9606
16/16 [==============================] - 0s 807us/step - loss: 1.9384
16/16 [==============================] - 0s 920us/step - loss: 1.9267
16/16 [==============================] - 0s 2ms/step - loss: 1.9220
16/16 [==============================] - 0s 800us/step - loss: 1.9206

Testing for epoch 28 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 814us/step - loss: 0.1194
16/16 [==============================] - 0s 2ms/step - loss: 1.6061
16/16 [==============================] - 0s 2ms/step - loss: 1.9314
16/16 [==============================] - 0s 2ms/step - loss: 1.9818
16/16 [==============================] - 0s 2ms/step - loss: 1.9704
16/16 [==============================] - 0s 872us/step - loss: 1.9494
16/16 [==============================] - 0s 2ms/step - loss: 1.9268
16/16 [==============================] - 0s 857us/step - loss: 1.9151
16/16 [==============================] - 0s 2ms/step - loss: 1.9106
16/16 [==============================] - 0s 873us/step - loss: 1.9093
Epoch 29 of 60

Testing for epoch 29 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1170
16/16 [==============================] - 0s 1ms/step - loss: 1.5952
16/16 [==============================] - 0s 2ms/step - loss: 1.9156
16/16 [==============================] - 0s 2ms/step - loss: 1.9670
16/16 [==============================] - 0s 1ms/step - loss: 1.9563
16/16 [==============================] - 0s 962us/step - loss: 1.9371
16/16 [==============================] - 0s 2ms/step - loss: 1.9153
16/16 [==============================] - 0s 849us/step - loss: 1.9039
16/16 [==============================] - 0s 1ms/step - loss: 1.8994
16/16 [==============================] - 0s 2ms/step - loss: 1.8980

Testing for epoch 29 index 2:
79/79 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1179
16/16 [==============================] - 0s 2ms/step - loss: 1.6545
16/16 [==============================] - 0s 2ms/step - loss: 1.9932
16/16 [==============================] - 0s 2ms/step - loss: 2.0482
16/16 [==============================] - 0s 920us/step - loss: 2.0365
16/16 [==============================] - 0s 2ms/step - loss: 2.0159
16/16 [==============================] - 0s 1ms/step - loss: 1.9922
16/16 [==============================] - 0s 816us/step - loss: 1.9800
16/16 [==============================] - 0s 804us/step - loss: 1.9752
16/16 [==============================] - 0s 911us/step - loss: 1.9737

Testing for epoch 29 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.1166
16/16 [==============================] - 0s 820us/step - loss: 1.6659
16/16 [==============================] - 0s 2ms/step - loss: 2.0026
16/16 [==============================] - 0s 2ms/step - loss: 2.0614
16/16 [==============================] - 0s 2ms/step - loss: 2.0491
16/16 [==============================] - 0s 897us/step - loss: 2.0274
16/16 [==============================] - 0s 1ms/step - loss: 2.0028
16/16 [==============================] - 0s 2ms/step - loss: 1.9905
16/16 [==============================] - 0s 1ms/step - loss: 1.9859
16/16 [==============================] - 0s 867us/step - loss: 1.9846

Testing for epoch 29 index 4:
79/79 [==============================] - 0s 544us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1145
16/16 [==============================] - 0s 803us/step - loss: 1.6746
16/16 [==============================] - 0s 953us/step - loss: 2.0219
16/16 [==============================] - 0s 2ms/step - loss: 2.0813
16/16 [==============================] - 0s 1ms/step - loss: 2.0677
16/16 [==============================] - 0s 2ms/step - loss: 2.0448
16/16 [==============================] - 0s 2ms/step - loss: 2.0186
16/16 [==============================] - 0s 2ms/step - loss: 2.0056
16/16 [==============================] - 0s 791us/step - loss: 2.0007
16/16 [==============================] - 0s 1ms/step - loss: 1.9992

Testing for epoch 29 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 958us/step - loss: 0.1158
16/16 [==============================] - 0s 797us/step - loss: 1.6228
16/16 [==============================] - 0s 912us/step - loss: 1.9529
16/16 [==============================] - 0s 822us/step - loss: 2.0115
16/16 [==============================] - 0s 2ms/step - loss: 1.9991
16/16 [==============================] - 0s 834us/step - loss: 1.9784
16/16 [==============================] - 0s 2ms/step - loss: 1.9536
16/16 [==============================] - 0s 2ms/step - loss: 1.9414
16/16 [==============================] - 0s 858us/step - loss: 1.9367
16/16 [==============================] - 0s 783us/step - loss: 1.9354
Epoch 30 of 60

Testing for epoch 30 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1159
16/16 [==============================] - 0s 2ms/step - loss: 1.6216
16/16 [==============================] - 0s 1ms/step - loss: 1.9505
16/16 [==============================] - 0s 2ms/step - loss: 2.0062
16/16 [==============================] - 0s 885us/step - loss: 1.9926
16/16 [==============================] - 0s 998us/step - loss: 1.9723
16/16 [==============================] - 0s 850us/step - loss: 1.9478
16/16 [==============================] - 0s 772us/step - loss: 1.9356
16/16 [==============================] - 0s 786us/step - loss: 1.9310
16/16 [==============================] - 0s 787us/step - loss: 1.9297

Testing for epoch 30 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 898us/step - loss: 0.1135
16/16 [==============================] - 0s 1ms/step - loss: 1.6538
16/16 [==============================] - 0s 849us/step - loss: 1.9883
16/16 [==============================] - 0s 794us/step - loss: 2.0417
16/16 [==============================] - 0s 797us/step - loss: 2.0248
16/16 [==============================] - 0s 811us/step - loss: 2.0018
16/16 [==============================] - 0s 803us/step - loss: 1.9755
16/16 [==============================] - 0s 788us/step - loss: 1.9627
16/16 [==============================] - 0s 847us/step - loss: 1.9580
16/16 [==============================] - 0s 858us/step - loss: 1.9566

Testing for epoch 30 index 3:
79/79 [==============================] - 0s 904us/step
16/16 [==============================] - 0s 819us/step - loss: 0.1135
16/16 [==============================] - 0s 814us/step - loss: 1.6788
16/16 [==============================] - 0s 794us/step - loss: 2.0212
16/16 [==============================] - 0s 784us/step - loss: 2.0796
16/16 [==============================] - 0s 794us/step - loss: 2.0633
16/16 [==============================] - 0s 778us/step - loss: 2.0402
16/16 [==============================] - 0s 778us/step - loss: 2.0132
16/16 [==============================] - 0s 778us/step - loss: 2.0001
16/16 [==============================] - 0s 776us/step - loss: 1.9951
16/16 [==============================] - 0s 796us/step - loss: 1.9937

Testing for epoch 30 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 810us/step - loss: 0.1126
16/16 [==============================] - 0s 800us/step - loss: 1.6895
16/16 [==============================] - 0s 808us/step - loss: 2.0271
16/16 [==============================] - 0s 997us/step - loss: 2.0808
16/16 [==============================] - 0s 785us/step - loss: 2.0617
16/16 [==============================] - 0s 810us/step - loss: 2.0363
16/16 [==============================] - 0s 1ms/step - loss: 2.0086
16/16 [==============================] - 0s 796us/step - loss: 1.9954
16/16 [==============================] - 0s 2ms/step - loss: 1.9906
16/16 [==============================] - 0s 1ms/step - loss: 1.9892

Testing for epoch 30 index 5:
79/79 [==============================] - 0s 537us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1123
16/16 [==============================] - 0s 814us/step - loss: 1.6778
16/16 [==============================] - 0s 2ms/step - loss: 2.0144
16/16 [==============================] - 0s 2ms/step - loss: 2.0707
16/16 [==============================] - 0s 1ms/step - loss: 2.0538
16/16 [==============================] - 0s 1ms/step - loss: 2.0315
16/16 [==============================] - 0s 854us/step - loss: 2.0061
16/16 [==============================] - 0s 818us/step - loss: 1.9937
16/16 [==============================] - 0s 2ms/step - loss: 1.9890
16/16 [==============================] - 0s 2ms/step - loss: 1.9876
Epoch 31 of 60

Testing for epoch 31 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 890us/step - loss: 0.1101
16/16 [==============================] - 0s 808us/step - loss: 1.6815
16/16 [==============================] - 0s 792us/step - loss: 2.0160
16/16 [==============================] - 0s 811us/step - loss: 2.0706
16/16 [==============================] - 0s 798us/step - loss: 2.0509
16/16 [==============================] - 0s 2ms/step - loss: 2.0265
16/16 [==============================] - 0s 2ms/step - loss: 2.0000
16/16 [==============================] - 0s 845us/step - loss: 1.9874
16/16 [==============================] - 0s 796us/step - loss: 1.9828
16/16 [==============================] - 0s 2ms/step - loss: 1.9814

Testing for epoch 31 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 973us/step - loss: 0.1125
16/16 [==============================] - 0s 849us/step - loss: 1.6742
16/16 [==============================] - 0s 1ms/step - loss: 2.0050
16/16 [==============================] - 0s 895us/step - loss: 2.0596
16/16 [==============================] - 0s 795us/step - loss: 2.0400
16/16 [==============================] - 0s 1ms/step - loss: 2.0148
16/16 [==============================] - 0s 2ms/step - loss: 1.9884
16/16 [==============================] - 0s 2ms/step - loss: 1.9757
16/16 [==============================] - 0s 802us/step - loss: 1.9711
16/16 [==============================] - 0s 796us/step - loss: 1.9697

Testing for epoch 31 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 932us/step - loss: 0.1094
16/16 [==============================] - 0s 1ms/step - loss: 1.6789
16/16 [==============================] - 0s 2ms/step - loss: 2.0053
16/16 [==============================] - 0s 824us/step - loss: 2.0575
16/16 [==============================] - 0s 787us/step - loss: 2.0375
16/16 [==============================] - 0s 824us/step - loss: 2.0138
16/16 [==============================] - 0s 2ms/step - loss: 1.9874
16/16 [==============================] - 0s 2ms/step - loss: 1.9748
16/16 [==============================] - 0s 1ms/step - loss: 1.9702
16/16 [==============================] - 0s 858us/step - loss: 1.9689

Testing for epoch 31 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1056
16/16 [==============================] - 0s 2ms/step - loss: 1.6807
16/16 [==============================] - 0s 2ms/step - loss: 2.0141
16/16 [==============================] - 0s 2ms/step - loss: 2.0715
16/16 [==============================] - 0s 2ms/step - loss: 2.0530
16/16 [==============================] - 0s 2ms/step - loss: 2.0299
16/16 [==============================] - 0s 2ms/step - loss: 2.0042
16/16 [==============================] - 0s 2ms/step - loss: 1.9918
16/16 [==============================] - 0s 1ms/step - loss: 1.9873
16/16 [==============================] - 0s 891us/step - loss: 1.9860

Testing for epoch 31 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 843us/step - loss: 0.1083
16/16 [==============================] - 0s 1ms/step - loss: 1.6546
16/16 [==============================] - 0s 804us/step - loss: 1.9743
16/16 [==============================] - 0s 2ms/step - loss: 2.0268
16/16 [==============================] - 0s 2ms/step - loss: 2.0072
16/16 [==============================] - 0s 812us/step - loss: 1.9828
16/16 [==============================] - 0s 803us/step - loss: 1.9560
16/16 [==============================] - 0s 1ms/step - loss: 1.9432
16/16 [==============================] - 0s 813us/step - loss: 1.9386
16/16 [==============================] - 0s 1ms/step - loss: 1.9372
Epoch 32 of 60

Testing for epoch 32 index 1:
79/79 [==============================] - 0s 522us/step
16/16 [==============================] - 0s 823us/step - loss: 0.1059
16/16 [==============================] - 0s 825us/step - loss: 1.7084
16/16 [==============================] - 0s 802us/step - loss: 2.0421
16/16 [==============================] - 0s 2ms/step - loss: 2.0994
16/16 [==============================] - 0s 848us/step - loss: 2.0779
16/16 [==============================] - 0s 798us/step - loss: 2.0520
16/16 [==============================] - 0s 767us/step - loss: 2.0243
16/16 [==============================] - 0s 789us/step - loss: 2.0112
16/16 [==============================] - 0s 804us/step - loss: 2.0065
16/16 [==============================] - 0s 806us/step - loss: 2.0051

Testing for epoch 32 index 2:
79/79 [==============================] - 0s 806us/step
16/16 [==============================] - 0s 789us/step - loss: 0.1044
16/16 [==============================] - 0s 789us/step - loss: 1.7390
16/16 [==============================] - 0s 790us/step - loss: 2.0806
16/16 [==============================] - 0s 801us/step - loss: 2.1353
16/16 [==============================] - 0s 1ms/step - loss: 2.1106
16/16 [==============================] - 0s 2ms/step - loss: 2.0819
16/16 [==============================] - 0s 2ms/step - loss: 2.0526
16/16 [==============================] - 0s 1ms/step - loss: 2.0390
16/16 [==============================] - 0s 2ms/step - loss: 2.0340
16/16 [==============================] - 0s 2ms/step - loss: 2.0326

Testing for epoch 32 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1093
16/16 [==============================] - 0s 2ms/step - loss: 1.6886
16/16 [==============================] - 0s 2ms/step - loss: 2.0213
16/16 [==============================] - 0s 2ms/step - loss: 2.0751
16/16 [==============================] - 0s 2ms/step - loss: 2.0513
16/16 [==============================] - 0s 2ms/step - loss: 2.0243
16/16 [==============================] - 0s 1ms/step - loss: 1.9958
16/16 [==============================] - 0s 1ms/step - loss: 1.9825
16/16 [==============================] - 0s 842us/step - loss: 1.9776
16/16 [==============================] - 0s 803us/step - loss: 1.9762

Testing for epoch 32 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1047
16/16 [==============================] - 0s 834us/step - loss: 1.7320
16/16 [==============================] - 0s 870us/step - loss: 2.0796
16/16 [==============================] - 0s 2ms/step - loss: 2.1341
16/16 [==============================] - 0s 2ms/step - loss: 2.1104
16/16 [==============================] - 0s 820us/step - loss: 2.0836
16/16 [==============================] - 0s 2ms/step - loss: 2.0549
16/16 [==============================] - 0s 951us/step - loss: 2.0415
16/16 [==============================] - 0s 812us/step - loss: 2.0367
16/16 [==============================] - 0s 2ms/step - loss: 2.0354

Testing for epoch 32 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1053
16/16 [==============================] - 0s 2ms/step - loss: 1.7510
16/16 [==============================] - 0s 2ms/step - loss: 2.1031
16/16 [==============================] - 0s 897us/step - loss: 2.1564
16/16 [==============================] - 0s 901us/step - loss: 2.1313
16/16 [==============================] - 0s 2ms/step - loss: 2.1030
16/16 [==============================] - 0s 2ms/step - loss: 2.0735
16/16 [==============================] - 0s 1ms/step - loss: 2.0597
16/16 [==============================] - 0s 799us/step - loss: 2.0548
16/16 [==============================] - 0s 2ms/step - loss: 2.0533
Epoch 33 of 60

Testing for epoch 33 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1042
16/16 [==============================] - 0s 2ms/step - loss: 1.7352
16/16 [==============================] - 0s 925us/step - loss: 2.0848
16/16 [==============================] - 0s 2ms/step - loss: 2.1397
16/16 [==============================] - 0s 2ms/step - loss: 2.1162
16/16 [==============================] - 0s 2ms/step - loss: 2.0905
16/16 [==============================] - 0s 2ms/step - loss: 2.0623
16/16 [==============================] - 0s 2ms/step - loss: 2.0489
16/16 [==============================] - 0s 1ms/step - loss: 2.0440
16/16 [==============================] - 0s 910us/step - loss: 2.0426

Testing for epoch 33 index 2:
79/79 [==============================] - 0s 868us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1036
16/16 [==============================] - 0s 2ms/step - loss: 1.6918
16/16 [==============================] - 0s 837us/step - loss: 2.0308
16/16 [==============================] - 0s 2ms/step - loss: 2.0838
16/16 [==============================] - 0s 2ms/step - loss: 2.0615
16/16 [==============================] - 0s 837us/step - loss: 2.0372
16/16 [==============================] - 0s 915us/step - loss: 2.0101
16/16 [==============================] - 0s 2ms/step - loss: 1.9973
16/16 [==============================] - 0s 2ms/step - loss: 1.9927
16/16 [==============================] - 0s 2ms/step - loss: 1.9914

Testing for epoch 33 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1041
16/16 [==============================] - 0s 791us/step - loss: 1.7168
16/16 [==============================] - 0s 2ms/step - loss: 2.0616
16/16 [==============================] - 0s 805us/step - loss: 2.1092
16/16 [==============================] - 0s 799us/step - loss: 2.0820
16/16 [==============================] - 0s 812us/step - loss: 2.0542
16/16 [==============================] - 0s 799us/step - loss: 2.0252
16/16 [==============================] - 0s 784us/step - loss: 2.0118
16/16 [==============================] - 0s 791us/step - loss: 2.0070
16/16 [==============================] - 0s 781us/step - loss: 2.0057

Testing for epoch 33 index 4:
79/79 [==============================] - 0s 547us/step
16/16 [==============================] - 0s 822us/step - loss: 0.1023
16/16 [==============================] - 0s 2ms/step - loss: 1.7233
16/16 [==============================] - 0s 808us/step - loss: 2.0734
16/16 [==============================] - 0s 796us/step - loss: 2.1271
16/16 [==============================] - 0s 803us/step - loss: 2.1028
16/16 [==============================] - 0s 796us/step - loss: 2.0779
16/16 [==============================] - 0s 2ms/step - loss: 2.0499
16/16 [==============================] - 0s 783us/step - loss: 2.0367
16/16 [==============================] - 0s 829us/step - loss: 2.0319
16/16 [==============================] - 0s 875us/step - loss: 2.0305

Testing for epoch 33 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1024
16/16 [==============================] - 0s 2ms/step - loss: 1.7279
16/16 [==============================] - 0s 943us/step - loss: 2.0767
16/16 [==============================] - 0s 837us/step - loss: 2.1247
16/16 [==============================] - 0s 2ms/step - loss: 2.0985
16/16 [==============================] - 0s 2ms/step - loss: 2.0716
16/16 [==============================] - 0s 2ms/step - loss: 2.0428
16/16 [==============================] - 0s 934us/step - loss: 2.0295
16/16 [==============================] - 0s 2ms/step - loss: 2.0247
16/16 [==============================] - 0s 911us/step - loss: 2.0233
Epoch 34 of 60

Testing for epoch 34 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.1033
16/16 [==============================] - 0s 2ms/step - loss: 1.6971
16/16 [==============================] - 0s 2ms/step - loss: 2.0431
16/16 [==============================] - 0s 2ms/step - loss: 2.0937
16/16 [==============================] - 0s 1ms/step - loss: 2.0696
16/16 [==============================] - 0s 1ms/step - loss: 2.0442
16/16 [==============================] - 0s 811us/step - loss: 2.0163
16/16 [==============================] - 0s 769us/step - loss: 2.0032
16/16 [==============================] - 0s 2ms/step - loss: 1.9984
16/16 [==============================] - 0s 830us/step - loss: 1.9969

Testing for epoch 34 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 809us/step - loss: 0.1011
16/16 [==============================] - 0s 2ms/step - loss: 1.7431
16/16 [==============================] - 0s 1ms/step - loss: 2.0892
16/16 [==============================] - 0s 2ms/step - loss: 2.1349
16/16 [==============================] - 0s 878us/step - loss: 2.1070
16/16 [==============================] - 0s 2ms/step - loss: 2.0785
16/16 [==============================] - 0s 1ms/step - loss: 2.0484
16/16 [==============================] - 0s 2ms/step - loss: 2.0346
16/16 [==============================] - 0s 2ms/step - loss: 2.0298
16/16 [==============================] - 0s 882us/step - loss: 2.0284

Testing for epoch 34 index 3:
79/79 [==============================] - 0s 527us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0980
16/16 [==============================] - 0s 1ms/step - loss: 1.7630
16/16 [==============================] - 0s 2ms/step - loss: 2.1150
16/16 [==============================] - 0s 2ms/step - loss: 2.1627
16/16 [==============================] - 0s 2ms/step - loss: 2.1348
16/16 [==============================] - 0s 1ms/step - loss: 2.1076
16/16 [==============================] - 0s 944us/step - loss: 2.0785
16/16 [==============================] - 0s 1ms/step - loss: 2.0650
16/16 [==============================] - 0s 1ms/step - loss: 2.0601
16/16 [==============================] - 0s 837us/step - loss: 2.0587

Testing for epoch 34 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 805us/step - loss: 0.1000
16/16 [==============================] - 0s 1ms/step - loss: 1.7837
16/16 [==============================] - 0s 836us/step - loss: 2.1409
16/16 [==============================] - 0s 768us/step - loss: 2.1874
16/16 [==============================] - 0s 795us/step - loss: 2.1579
16/16 [==============================] - 0s 838us/step - loss: 2.1286
16/16 [==============================] - 0s 1ms/step - loss: 2.0982
16/16 [==============================] - 0s 1ms/step - loss: 2.0842
16/16 [==============================] - 0s 2ms/step - loss: 2.0792
16/16 [==============================] - 0s 2ms/step - loss: 2.0778

Testing for epoch 34 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0980
16/16 [==============================] - 0s 998us/step - loss: 1.7543
16/16 [==============================] - 0s 847us/step - loss: 2.1009
16/16 [==============================] - 0s 919us/step - loss: 2.1467
16/16 [==============================] - 0s 2ms/step - loss: 2.1179
16/16 [==============================] - 0s 818us/step - loss: 2.0890
16/16 [==============================] - 0s 2ms/step - loss: 2.0592
16/16 [==============================] - 0s 2ms/step - loss: 2.0457
16/16 [==============================] - 0s 827us/step - loss: 2.0409
16/16 [==============================] - 0s 1ms/step - loss: 2.0396
Epoch 35 of 60

Testing for epoch 35 index 1:
79/79 [==============================] - 0s 967us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0996
16/16 [==============================] - 0s 2ms/step - loss: 1.7749
16/16 [==============================] - 0s 1ms/step - loss: 2.1228
16/16 [==============================] - 0s 835us/step - loss: 2.1664
16/16 [==============================] - 0s 2ms/step - loss: 2.1358
16/16 [==============================] - 0s 942us/step - loss: 2.1046
16/16 [==============================] - 0s 1ms/step - loss: 2.0731
16/16 [==============================] - 0s 2ms/step - loss: 2.0590
16/16 [==============================] - 0s 2ms/step - loss: 2.0540
16/16 [==============================] - 0s 878us/step - loss: 2.0527

Testing for epoch 35 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0994
16/16 [==============================] - 0s 2ms/step - loss: 1.7644
16/16 [==============================] - 0s 788us/step - loss: 2.1129
16/16 [==============================] - 0s 800us/step - loss: 2.1556
16/16 [==============================] - 0s 2ms/step - loss: 2.1258
16/16 [==============================] - 0s 991us/step - loss: 2.0959
16/16 [==============================] - 0s 802us/step - loss: 2.0654
16/16 [==============================] - 0s 809us/step - loss: 2.0517
16/16 [==============================] - 0s 964us/step - loss: 2.0469
16/16 [==============================] - 0s 821us/step - loss: 2.0457

Testing for epoch 35 index 3:
79/79 [==============================] - 0s 957us/step
16/16 [==============================] - 0s 809us/step - loss: 0.0977
16/16 [==============================] - 0s 2ms/step - loss: 1.7360
16/16 [==============================] - 0s 776us/step - loss: 2.0806
16/16 [==============================] - 0s 821us/step - loss: 2.1208
16/16 [==============================] - 0s 797us/step - loss: 2.0925
16/16 [==============================] - 0s 806us/step - loss: 2.0644
16/16 [==============================] - 0s 835us/step - loss: 2.0354
16/16 [==============================] - 0s 794us/step - loss: 2.0221
16/16 [==============================] - 0s 2ms/step - loss: 2.0172
16/16 [==============================] - 0s 2ms/step - loss: 2.0158

Testing for epoch 35 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0945
16/16 [==============================] - 0s 825us/step - loss: 1.7867
16/16 [==============================] - 0s 2ms/step - loss: 2.1448
16/16 [==============================] - 0s 2ms/step - loss: 2.1815
16/16 [==============================] - 0s 2ms/step - loss: 2.1496
16/16 [==============================] - 0s 946us/step - loss: 2.1162
16/16 [==============================] - 0s 2ms/step - loss: 2.0834
16/16 [==============================] - 0s 862us/step - loss: 2.0689
16/16 [==============================] - 0s 881us/step - loss: 2.0639
16/16 [==============================] - 0s 817us/step - loss: 2.0626

Testing for epoch 35 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 807us/step - loss: 0.0977
16/16 [==============================] - 0s 2ms/step - loss: 1.7696
16/16 [==============================] - 0s 856us/step - loss: 2.1303
16/16 [==============================] - 0s 814us/step - loss: 2.1687
16/16 [==============================] - 0s 821us/step - loss: 2.1397
16/16 [==============================] - 0s 803us/step - loss: 2.1090
16/16 [==============================] - 0s 795us/step - loss: 2.0780
16/16 [==============================] - 0s 886us/step - loss: 2.0639
16/16 [==============================] - 0s 2ms/step - loss: 2.0589
16/16 [==============================] - 0s 801us/step - loss: 2.0574
Epoch 36 of 60

Testing for epoch 36 index 1:
79/79 [==============================] - 0s 541us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0936
16/16 [==============================] - 0s 2ms/step - loss: 1.8110
16/16 [==============================] - 0s 2ms/step - loss: 2.1813
16/16 [==============================] - 0s 1ms/step - loss: 2.2172
16/16 [==============================] - 0s 2ms/step - loss: 2.1861
16/16 [==============================] - 0s 2ms/step - loss: 2.1521
16/16 [==============================] - 0s 1ms/step - loss: 2.1186
16/16 [==============================] - 0s 1ms/step - loss: 2.1038
16/16 [==============================] - 0s 1ms/step - loss: 2.0988
16/16 [==============================] - 0s 849us/step - loss: 2.0975

Testing for epoch 36 index 2:
79/79 [==============================] - 0s 906us/step
16/16 [==============================] - 0s 752us/step - loss: 0.0995
16/16 [==============================] - 0s 1ms/step - loss: 1.7250
16/16 [==============================] - 0s 2ms/step - loss: 2.0750
16/16 [==============================] - 0s 796us/step - loss: 2.1095
16/16 [==============================] - 0s 2ms/step - loss: 2.0832
16/16 [==============================] - 0s 2ms/step - loss: 2.0545
16/16 [==============================] - 0s 820us/step - loss: 2.0250
16/16 [==============================] - 0s 796us/step - loss: 2.0117
16/16 [==============================] - 0s 755us/step - loss: 2.0071
16/16 [==============================] - 0s 831us/step - loss: 2.0058

Testing for epoch 36 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 907us/step - loss: 0.0940
16/16 [==============================] - 0s 843us/step - loss: 1.7471
16/16 [==============================] - 0s 799us/step - loss: 2.1014
16/16 [==============================] - 0s 799us/step - loss: 2.1316
16/16 [==============================] - 0s 2ms/step - loss: 2.1030
16/16 [==============================] - 0s 785us/step - loss: 2.0721
16/16 [==============================] - 0s 2ms/step - loss: 2.0418
16/16 [==============================] - 0s 2ms/step - loss: 2.0283
16/16 [==============================] - 0s 1ms/step - loss: 2.0235
16/16 [==============================] - 0s 887us/step - loss: 2.0221

Testing for epoch 36 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0966
16/16 [==============================] - 0s 2ms/step - loss: 1.7748
16/16 [==============================] - 0s 937us/step - loss: 2.1434
16/16 [==============================] - 0s 1ms/step - loss: 2.1759
16/16 [==============================] - 0s 2ms/step - loss: 2.1474
16/16 [==============================] - 0s 2ms/step - loss: 2.1153
16/16 [==============================] - 0s 848us/step - loss: 2.0834
16/16 [==============================] - 0s 2ms/step - loss: 2.0694
16/16 [==============================] - 0s 837us/step - loss: 2.0647
16/16 [==============================] - 0s 1ms/step - loss: 2.0634

Testing for epoch 36 index 5:
79/79 [==============================] - 0s 537us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0947
16/16 [==============================] - 0s 2ms/step - loss: 1.8190
16/16 [==============================] - 0s 2ms/step - loss: 2.1952
16/16 [==============================] - 0s 2ms/step - loss: 2.2227
16/16 [==============================] - 0s 861us/step - loss: 2.1902
16/16 [==============================] - 0s 2ms/step - loss: 2.1543
16/16 [==============================] - 0s 862us/step - loss: 2.1194
16/16 [==============================] - 0s 2ms/step - loss: 2.1042
16/16 [==============================] - 0s 2ms/step - loss: 2.0992
16/16 [==============================] - 0s 837us/step - loss: 2.0979
Epoch 37 of 60

Testing for epoch 37 index 1:
79/79 [==============================] - 0s 527us/step
16/16 [==============================] - 0s 944us/step - loss: 0.0941
16/16 [==============================] - 0s 771us/step - loss: 1.8107
16/16 [==============================] - 0s 801us/step - loss: 2.1883
16/16 [==============================] - 0s 774us/step - loss: 2.2240
16/16 [==============================] - 0s 812us/step - loss: 2.1955
16/16 [==============================] - 0s 2ms/step - loss: 2.1628
16/16 [==============================] - 0s 1ms/step - loss: 2.1296
16/16 [==============================] - 0s 1ms/step - loss: 2.1149
16/16 [==============================] - 0s 828us/step - loss: 2.1099
16/16 [==============================] - 0s 1ms/step - loss: 2.1086

Testing for epoch 37 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0915
16/16 [==============================] - 0s 1ms/step - loss: 1.8503
16/16 [==============================] - 0s 1ms/step - loss: 2.2238
16/16 [==============================] - 0s 893us/step - loss: 2.2526
16/16 [==============================] - 0s 1ms/step - loss: 2.2199
16/16 [==============================] - 0s 2ms/step - loss: 2.1840
16/16 [==============================] - 0s 882us/step - loss: 2.1493
16/16 [==============================] - 0s 870us/step - loss: 2.1342
16/16 [==============================] - 0s 2ms/step - loss: 2.1290
16/16 [==============================] - 0s 2ms/step - loss: 2.1276

Testing for epoch 37 index 3:
79/79 [==============================] - 0s 887us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0927
16/16 [==============================] - 0s 842us/step - loss: 1.8043
16/16 [==============================] - 0s 1ms/step - loss: 2.1724
16/16 [==============================] - 0s 2ms/step - loss: 2.2066
16/16 [==============================] - 0s 1ms/step - loss: 2.1779
16/16 [==============================] - 0s 903us/step - loss: 2.1450
16/16 [==============================] - 0s 1ms/step - loss: 2.1122
16/16 [==============================] - 0s 2ms/step - loss: 2.0977
16/16 [==============================] - 0s 2ms/step - loss: 2.0926
16/16 [==============================] - 0s 2ms/step - loss: 2.0912

Testing for epoch 37 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0909
16/16 [==============================] - 0s 2ms/step - loss: 1.8511
16/16 [==============================] - 0s 2ms/step - loss: 2.2282
16/16 [==============================] - 0s 2ms/step - loss: 2.2602
16/16 [==============================] - 0s 916us/step - loss: 2.2292
16/16 [==============================] - 0s 1ms/step - loss: 2.1954
16/16 [==============================] - 0s 2ms/step - loss: 2.1615
16/16 [==============================] - 0s 2ms/step - loss: 2.1467
16/16 [==============================] - 0s 934us/step - loss: 2.1417
16/16 [==============================] - 0s 849us/step - loss: 2.1403

Testing for epoch 37 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 812us/step - loss: 0.0955
16/16 [==============================] - 0s 802us/step - loss: 1.7805
16/16 [==============================] - 0s 810us/step - loss: 2.1382
16/16 [==============================] - 0s 809us/step - loss: 2.1658
16/16 [==============================] - 0s 791us/step - loss: 2.1340
16/16 [==============================] - 0s 785us/step - loss: 2.1008
16/16 [==============================] - 0s 2ms/step - loss: 2.0679
16/16 [==============================] - 0s 802us/step - loss: 2.0538
16/16 [==============================] - 0s 887us/step - loss: 2.0490
16/16 [==============================] - 0s 784us/step - loss: 2.0478
Epoch 38 of 60

Testing for epoch 38 index 1:
79/79 [==============================] - 0s 799us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0896
16/16 [==============================] - 0s 1ms/step - loss: 1.8083
16/16 [==============================] - 0s 2ms/step - loss: 2.1768
16/16 [==============================] - 0s 1ms/step - loss: 2.2060
16/16 [==============================] - 0s 2ms/step - loss: 2.1741
16/16 [==============================] - 0s 859us/step - loss: 2.1388
16/16 [==============================] - 0s 2ms/step - loss: 2.1050
16/16 [==============================] - 0s 2ms/step - loss: 2.0904
16/16 [==============================] - 0s 2ms/step - loss: 2.0854
16/16 [==============================] - 0s 2ms/step - loss: 2.0840

Testing for epoch 38 index 2:
79/79 [==============================] - 0s 608us/step
16/16 [==============================] - 0s 808us/step - loss: 0.0932
16/16 [==============================] - 0s 2ms/step - loss: 1.8485
16/16 [==============================] - 0s 801us/step - loss: 2.2167
16/16 [==============================] - 0s 919us/step - loss: 2.2375
16/16 [==============================] - 0s 2ms/step - loss: 2.2004
16/16 [==============================] - 0s 2ms/step - loss: 2.1605
16/16 [==============================] - 0s 919us/step - loss: 2.1243
16/16 [==============================] - 0s 890us/step - loss: 2.1090
16/16 [==============================] - 0s 1ms/step - loss: 2.1040
16/16 [==============================] - 0s 2ms/step - loss: 2.1027

Testing for epoch 38 index 3:
79/79 [==============================] - 0s 888us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0916
16/16 [==============================] - 0s 2ms/step - loss: 1.8503
16/16 [==============================] - 0s 848us/step - loss: 2.2202
16/16 [==============================] - 0s 2ms/step - loss: 2.2484
16/16 [==============================] - 0s 794us/step - loss: 2.2153
16/16 [==============================] - 0s 801us/step - loss: 2.1797
16/16 [==============================] - 0s 2ms/step - loss: 2.1451
16/16 [==============================] - 0s 2ms/step - loss: 2.1302
16/16 [==============================] - 0s 1ms/step - loss: 2.1251
16/16 [==============================] - 0s 1ms/step - loss: 2.1237

Testing for epoch 38 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0914
16/16 [==============================] - 0s 1ms/step - loss: 1.8048
16/16 [==============================] - 0s 2ms/step - loss: 2.1693
16/16 [==============================] - 0s 821us/step - loss: 2.2033
16/16 [==============================] - 0s 842us/step - loss: 2.1747
16/16 [==============================] - 0s 1ms/step - loss: 2.1433
16/16 [==============================] - 0s 2ms/step - loss: 2.1114
16/16 [==============================] - 0s 884us/step - loss: 2.0974
16/16 [==============================] - 0s 815us/step - loss: 2.0926
16/16 [==============================] - 0s 788us/step - loss: 2.0913

Testing for epoch 38 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0898
16/16 [==============================] - 0s 821us/step - loss: 1.8266
16/16 [==============================] - 0s 768us/step - loss: 2.1814
16/16 [==============================] - 0s 2ms/step - loss: 2.2034
16/16 [==============================] - 0s 2ms/step - loss: 2.1676
16/16 [==============================] - 0s 1ms/step - loss: 2.1288
16/16 [==============================] - 0s 2ms/step - loss: 2.0926
16/16 [==============================] - 0s 984us/step - loss: 2.0771
16/16 [==============================] - 0s 796us/step - loss: 2.0719
16/16 [==============================] - 0s 2ms/step - loss: 2.0705
Epoch 39 of 60

Testing for epoch 39 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 847us/step - loss: 0.0904
16/16 [==============================] - 0s 2ms/step - loss: 1.8701
16/16 [==============================] - 0s 2ms/step - loss: 2.2383
16/16 [==============================] - 0s 2ms/step - loss: 2.2642
16/16 [==============================] - 0s 778us/step - loss: 2.2303
16/16 [==============================] - 0s 2ms/step - loss: 2.1939
16/16 [==============================] - 0s 907us/step - loss: 2.1592
16/16 [==============================] - 0s 2ms/step - loss: 2.1443
16/16 [==============================] - 0s 1ms/step - loss: 2.1393
16/16 [==============================] - 0s 805us/step - loss: 2.1380

Testing for epoch 39 index 2:
79/79 [==============================] - 0s 525us/step
16/16 [==============================] - 0s 797us/step - loss: 0.0897
16/16 [==============================] - 0s 806us/step - loss: 1.8896
16/16 [==============================] - 0s 805us/step - loss: 2.2555
16/16 [==============================] - 0s 787us/step - loss: 2.2798
16/16 [==============================] - 0s 778us/step - loss: 2.2434
16/16 [==============================] - 0s 808us/step - loss: 2.2046
16/16 [==============================] - 0s 789us/step - loss: 2.1682
16/16 [==============================] - 0s 829us/step - loss: 2.1528
16/16 [==============================] - 0s 1ms/step - loss: 2.1478
16/16 [==============================] - 0s 815us/step - loss: 2.1466

Testing for epoch 39 index 3:
79/79 [==============================] - 0s 580us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0903
16/16 [==============================] - 0s 1ms/step - loss: 1.8542
16/16 [==============================] - 0s 847us/step - loss: 2.2043
16/16 [==============================] - 0s 1ms/step - loss: 2.2266
16/16 [==============================] - 0s 1ms/step - loss: 2.1917
16/16 [==============================] - 0s 2ms/step - loss: 2.1551
16/16 [==============================] - 0s 838us/step - loss: 2.1206
16/16 [==============================] - 0s 813us/step - loss: 2.1062
16/16 [==============================] - 0s 2ms/step - loss: 2.1015
16/16 [==============================] - 0s 1ms/step - loss: 2.1003

Testing for epoch 39 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0893
16/16 [==============================] - 0s 2ms/step - loss: 1.8766
16/16 [==============================] - 0s 2ms/step - loss: 2.2291
16/16 [==============================] - 0s 1ms/step - loss: 2.2482
16/16 [==============================] - 0s 1ms/step - loss: 2.2101
16/16 [==============================] - 0s 849us/step - loss: 2.1701
16/16 [==============================] - 0s 2ms/step - loss: 2.1335
16/16 [==============================] - 0s 850us/step - loss: 2.1184
16/16 [==============================] - 0s 2ms/step - loss: 2.1136
16/16 [==============================] - 0s 2ms/step - loss: 2.1124

Testing for epoch 39 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 891us/step - loss: 0.0867
16/16 [==============================] - 0s 871us/step - loss: 1.8584
16/16 [==============================] - 0s 2ms/step - loss: 2.2157
16/16 [==============================] - 0s 1ms/step - loss: 2.2382
16/16 [==============================] - 0s 2ms/step - loss: 2.2020
16/16 [==============================] - 0s 901us/step - loss: 2.1634
16/16 [==============================] - 0s 2ms/step - loss: 2.1276
16/16 [==============================] - 0s 2ms/step - loss: 2.1126
16/16 [==============================] - 0s 884us/step - loss: 2.1077
16/16 [==============================] - 0s 2ms/step - loss: 2.1064
Epoch 40 of 60

Testing for epoch 40 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 842us/step - loss: 0.0872
16/16 [==============================] - 0s 844us/step - loss: 1.8698
16/16 [==============================] - 0s 804us/step - loss: 2.2247
16/16 [==============================] - 0s 768us/step - loss: 2.2441
16/16 [==============================] - 0s 1ms/step - loss: 2.2077
16/16 [==============================] - 0s 774us/step - loss: 2.1697
16/16 [==============================] - 0s 2ms/step - loss: 2.1347
16/16 [==============================] - 0s 774us/step - loss: 2.1201
16/16 [==============================] - 0s 2ms/step - loss: 2.1153
16/16 [==============================] - 0s 2ms/step - loss: 2.1141

Testing for epoch 40 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 825us/step - loss: 0.0887
16/16 [==============================] - 0s 2ms/step - loss: 1.9279
16/16 [==============================] - 0s 2ms/step - loss: 2.2914
16/16 [==============================] - 0s 2ms/step - loss: 2.3128
16/16 [==============================] - 0s 877us/step - loss: 2.2753
16/16 [==============================] - 0s 2ms/step - loss: 2.2351
16/16 [==============================] - 0s 2ms/step - loss: 2.1981
16/16 [==============================] - 0s 2ms/step - loss: 2.1826
16/16 [==============================] - 0s 2ms/step - loss: 2.1773
16/16 [==============================] - 0s 2ms/step - loss: 2.1759

Testing for epoch 40 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 979us/step - loss: 0.0863
16/16 [==============================] - 0s 2ms/step - loss: 1.8649
16/16 [==============================] - 0s 882us/step - loss: 2.2107
16/16 [==============================] - 0s 815us/step - loss: 2.2330
16/16 [==============================] - 0s 815us/step - loss: 2.1980
16/16 [==============================] - 0s 1ms/step - loss: 2.1596
16/16 [==============================] - 0s 797us/step - loss: 2.1247
16/16 [==============================] - 0s 799us/step - loss: 2.1099
16/16 [==============================] - 0s 2ms/step - loss: 2.1049
16/16 [==============================] - 0s 1ms/step - loss: 2.1035

Testing for epoch 40 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0867
16/16 [==============================] - 0s 2ms/step - loss: 1.8926
16/16 [==============================] - 0s 2ms/step - loss: 2.2387
16/16 [==============================] - 0s 1ms/step - loss: 2.2572
16/16 [==============================] - 0s 2ms/step - loss: 2.2203
16/16 [==============================] - 0s 1ms/step - loss: 2.1795
16/16 [==============================] - 0s 2ms/step - loss: 2.1427
16/16 [==============================] - 0s 2ms/step - loss: 2.1275
16/16 [==============================] - 0s 815us/step - loss: 2.1227
16/16 [==============================] - 0s 772us/step - loss: 2.1215

Testing for epoch 40 index 5:
79/79 [==============================] - 0s 588us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0845
16/16 [==============================] - 0s 2ms/step - loss: 1.9074
16/16 [==============================] - 0s 2ms/step - loss: 2.2525
16/16 [==============================] - 0s 950us/step - loss: 2.2665
16/16 [==============================] - 0s 1ms/step - loss: 2.2283
16/16 [==============================] - 0s 1ms/step - loss: 2.1883
16/16 [==============================] - 0s 1ms/step - loss: 2.1520
16/16 [==============================] - 0s 2ms/step - loss: 2.1369
16/16 [==============================] - 0s 2ms/step - loss: 2.1319
16/16 [==============================] - 0s 1ms/step - loss: 2.1307
Epoch 41 of 60

Testing for epoch 41 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 950us/step - loss: 0.0841
16/16 [==============================] - 0s 2ms/step - loss: 1.9306
16/16 [==============================] - 0s 984us/step - loss: 2.2909
16/16 [==============================] - 0s 2ms/step - loss: 2.3115
16/16 [==============================] - 0s 2ms/step - loss: 2.2725
16/16 [==============================] - 0s 871us/step - loss: 2.2312
16/16 [==============================] - 0s 2ms/step - loss: 2.1939
16/16 [==============================] - 0s 934us/step - loss: 2.1781
16/16 [==============================] - 0s 2ms/step - loss: 2.1728
16/16 [==============================] - 0s 854us/step - loss: 2.1713

Testing for epoch 41 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 911us/step - loss: 0.0870
16/16 [==============================] - 0s 826us/step - loss: 1.8677
16/16 [==============================] - 0s 2ms/step - loss: 2.2120
16/16 [==============================] - 0s 2ms/step - loss: 2.2279
16/16 [==============================] - 0s 2ms/step - loss: 2.1895
16/16 [==============================] - 0s 926us/step - loss: 2.1490
16/16 [==============================] - 0s 2ms/step - loss: 2.1126
16/16 [==============================] - 0s 2ms/step - loss: 2.0975
16/16 [==============================] - 0s 925us/step - loss: 2.0925
16/16 [==============================] - 0s 2ms/step - loss: 2.0912

Testing for epoch 41 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0831
16/16 [==============================] - 0s 1ms/step - loss: 1.8881
16/16 [==============================] - 0s 836us/step - loss: 2.2354
16/16 [==============================] - 0s 835us/step - loss: 2.2486
16/16 [==============================] - 0s 779us/step - loss: 2.2092
16/16 [==============================] - 0s 834us/step - loss: 2.1679
16/16 [==============================] - 0s 790us/step - loss: 2.1312
16/16 [==============================] - 0s 986us/step - loss: 2.1162
16/16 [==============================] - 0s 2ms/step - loss: 2.1113
16/16 [==============================] - 0s 848us/step - loss: 2.1101

Testing for epoch 41 index 4:
79/79 [==============================] - 0s 979us/step
16/16 [==============================] - 0s 813us/step - loss: 0.0874
16/16 [==============================] - 0s 1ms/step - loss: 1.9374
16/16 [==============================] - 0s 2ms/step - loss: 2.2990
16/16 [==============================] - 0s 2ms/step - loss: 2.3185
16/16 [==============================] - 0s 2ms/step - loss: 2.2794
16/16 [==============================] - 0s 836us/step - loss: 2.2378
16/16 [==============================] - 0s 1ms/step - loss: 2.2000
16/16 [==============================] - 0s 792us/step - loss: 2.1843
16/16 [==============================] - 0s 837us/step - loss: 2.1793
16/16 [==============================] - 0s 819us/step - loss: 2.1781

Testing for epoch 41 index 5:
79/79 [==============================] - 0s 526us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0842
16/16 [==============================] - 0s 2ms/step - loss: 1.9564
16/16 [==============================] - 0s 2ms/step - loss: 2.3112
16/16 [==============================] - 0s 899us/step - loss: 2.3275
16/16 [==============================] - 0s 791us/step - loss: 2.2860
16/16 [==============================] - 0s 2ms/step - loss: 2.2426
16/16 [==============================] - 0s 1ms/step - loss: 2.2043
16/16 [==============================] - 0s 1ms/step - loss: 2.1885
16/16 [==============================] - 0s 867us/step - loss: 2.1834
16/16 [==============================] - 0s 2ms/step - loss: 2.1821
Epoch 42 of 60

Testing for epoch 42 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0828
16/16 [==============================] - 0s 2ms/step - loss: 1.8963
16/16 [==============================] - 0s 2ms/step - loss: 2.2450
16/16 [==============================] - 0s 2ms/step - loss: 2.2656
16/16 [==============================] - 0s 887us/step - loss: 2.2272
16/16 [==============================] - 0s 838us/step - loss: 2.1849
16/16 [==============================] - 0s 2ms/step - loss: 2.1470
16/16 [==============================] - 0s 799us/step - loss: 2.1315
16/16 [==============================] - 0s 2ms/step - loss: 2.1264
16/16 [==============================] - 0s 804us/step - loss: 2.1250

Testing for epoch 42 index 2:
79/79 [==============================] - 0s 605us/step
16/16 [==============================] - 0s 804us/step - loss: 0.0808
16/16 [==============================] - 0s 773us/step - loss: 1.9638
16/16 [==============================] - 0s 2ms/step - loss: 2.3189
16/16 [==============================] - 0s 2ms/step - loss: 2.3349
16/16 [==============================] - 0s 911us/step - loss: 2.2927
16/16 [==============================] - 0s 2ms/step - loss: 2.2480
16/16 [==============================] - 0s 2ms/step - loss: 2.2085
16/16 [==============================] - 0s 2ms/step - loss: 2.1925
16/16 [==============================] - 0s 2ms/step - loss: 2.1874
16/16 [==============================] - 0s 973us/step - loss: 2.1862

Testing for epoch 42 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0846
16/16 [==============================] - 0s 2ms/step - loss: 1.8955
16/16 [==============================] - 0s 916us/step - loss: 2.2324
16/16 [==============================] - 0s 1ms/step - loss: 2.2467
16/16 [==============================] - 0s 946us/step - loss: 2.2042
16/16 [==============================] - 0s 798us/step - loss: 2.1607
16/16 [==============================] - 0s 790us/step - loss: 2.1227
16/16 [==============================] - 0s 798us/step - loss: 2.1076
16/16 [==============================] - 0s 2ms/step - loss: 2.1027
16/16 [==============================] - 0s 2ms/step - loss: 2.1016

Testing for epoch 42 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 905us/step - loss: 0.0836
16/16 [==============================] - 0s 2ms/step - loss: 1.9991
16/16 [==============================] - 0s 836us/step - loss: 2.3622
16/16 [==============================] - 0s 1ms/step - loss: 2.3816
16/16 [==============================] - 0s 790us/step - loss: 2.3384
16/16 [==============================] - 0s 845us/step - loss: 2.2929
16/16 [==============================] - 0s 1ms/step - loss: 2.2527
16/16 [==============================] - 0s 2ms/step - loss: 2.2364
16/16 [==============================] - 0s 2ms/step - loss: 2.2311
16/16 [==============================] - 0s 2ms/step - loss: 2.2298

Testing for epoch 42 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0845
16/16 [==============================] - 0s 2ms/step - loss: 1.9443
16/16 [==============================] - 0s 906us/step - loss: 2.2978
16/16 [==============================] - 0s 2ms/step - loss: 2.3189
16/16 [==============================] - 0s 2ms/step - loss: 2.2776
16/16 [==============================] - 0s 868us/step - loss: 2.2338
16/16 [==============================] - 0s 783us/step - loss: 2.1949
16/16 [==============================] - 0s 2ms/step - loss: 2.1792
16/16 [==============================] - 0s 875us/step - loss: 2.1741
16/16 [==============================] - 0s 794us/step - loss: 2.1728
Epoch 43 of 60

Testing for epoch 43 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0823
16/16 [==============================] - 0s 927us/step - loss: 1.9151
16/16 [==============================] - 0s 2ms/step - loss: 2.2581
16/16 [==============================] - 0s 784us/step - loss: 2.2767
16/16 [==============================] - 0s 802us/step - loss: 2.2351
16/16 [==============================] - 0s 784us/step - loss: 2.1921
16/16 [==============================] - 0s 787us/step - loss: 2.1545
16/16 [==============================] - 0s 788us/step - loss: 2.1390
16/16 [==============================] - 0s 796us/step - loss: 2.1340
16/16 [==============================] - 0s 813us/step - loss: 2.1327

Testing for epoch 43 index 2:
79/79 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0812
16/16 [==============================] - 0s 826us/step - loss: 1.9665
16/16 [==============================] - 0s 802us/step - loss: 2.3183
16/16 [==============================] - 0s 770us/step - loss: 2.3381
16/16 [==============================] - 0s 886us/step - loss: 2.2949
16/16 [==============================] - 0s 803us/step - loss: 2.2495
16/16 [==============================] - 0s 2ms/step - loss: 2.2099
16/16 [==============================] - 0s 801us/step - loss: 2.1937
16/16 [==============================] - 0s 780us/step - loss: 2.1884
16/16 [==============================] - 0s 796us/step - loss: 2.1870

Testing for epoch 43 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 971us/step - loss: 0.0828
16/16 [==============================] - 0s 1ms/step - loss: 1.9538
16/16 [==============================] - 0s 2ms/step - loss: 2.3013
16/16 [==============================] - 0s 893us/step - loss: 2.3215
16/16 [==============================] - 0s 2ms/step - loss: 2.2813
16/16 [==============================] - 0s 2ms/step - loss: 2.2395
16/16 [==============================] - 0s 2ms/step - loss: 2.2024
16/16 [==============================] - 0s 837us/step - loss: 2.1874
16/16 [==============================] - 0s 965us/step - loss: 2.1825
16/16 [==============================] - 0s 2ms/step - loss: 2.1813

Testing for epoch 43 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0801
16/16 [==============================] - 0s 808us/step - loss: 1.9759
16/16 [==============================] - 0s 796us/step - loss: 2.3167
16/16 [==============================] - 0s 789us/step - loss: 2.3298
16/16 [==============================] - 0s 785us/step - loss: 2.2839
16/16 [==============================] - 0s 797us/step - loss: 2.2360
16/16 [==============================] - 0s 860us/step - loss: 2.1951
16/16 [==============================] - 0s 2ms/step - loss: 2.1788
16/16 [==============================] - 0s 806us/step - loss: 2.1737
16/16 [==============================] - 0s 1ms/step - loss: 2.1725

Testing for epoch 43 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 925us/step - loss: 0.0786
16/16 [==============================] - 0s 1ms/step - loss: 1.9918
16/16 [==============================] - 0s 980us/step - loss: 2.3466
16/16 [==============================] - 0s 1ms/step - loss: 2.3675
16/16 [==============================] - 0s 2ms/step - loss: 2.3251
16/16 [==============================] - 0s 2ms/step - loss: 2.2796
16/16 [==============================] - 0s 859us/step - loss: 2.2397
16/16 [==============================] - 0s 1ms/step - loss: 2.2232
16/16 [==============================] - 0s 1ms/step - loss: 2.2179
16/16 [==============================] - 0s 876us/step - loss: 2.2165
Epoch 44 of 60

Testing for epoch 44 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0815
16/16 [==============================] - 0s 1ms/step - loss: 1.9740
16/16 [==============================] - 0s 922us/step - loss: 2.3169
16/16 [==============================] - 0s 2ms/step - loss: 2.3323
16/16 [==============================] - 0s 2ms/step - loss: 2.2878
16/16 [==============================] - 0s 801us/step - loss: 2.2418
16/16 [==============================] - 0s 900us/step - loss: 2.2026
16/16 [==============================] - 0s 2ms/step - loss: 2.1868
16/16 [==============================] - 0s 810us/step - loss: 2.1818
16/16 [==============================] - 0s 2ms/step - loss: 2.1806

Testing for epoch 44 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0805
16/16 [==============================] - 0s 2ms/step - loss: 2.0101
16/16 [==============================] - 0s 2ms/step - loss: 2.3641
16/16 [==============================] - 0s 892us/step - loss: 2.3810
16/16 [==============================] - 0s 812us/step - loss: 2.3374
16/16 [==============================] - 0s 2ms/step - loss: 2.2919
16/16 [==============================] - 0s 813us/step - loss: 2.2518
16/16 [==============================] - 0s 764us/step - loss: 2.2356
16/16 [==============================] - 0s 806us/step - loss: 2.2304
16/16 [==============================] - 0s 2ms/step - loss: 2.2291

Testing for epoch 44 index 3:
79/79 [==============================] - 0s 534us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0805
16/16 [==============================] - 0s 2ms/step - loss: 1.9682
16/16 [==============================] - 0s 2ms/step - loss: 2.3102
16/16 [==============================] - 0s 2ms/step - loss: 2.3230
16/16 [==============================] - 0s 2ms/step - loss: 2.2792
16/16 [==============================] - 0s 914us/step - loss: 2.2341
16/16 [==============================] - 0s 807us/step - loss: 2.1954
16/16 [==============================] - 0s 795us/step - loss: 2.1798
16/16 [==============================] - 0s 789us/step - loss: 2.1748
16/16 [==============================] - 0s 793us/step - loss: 2.1735

Testing for epoch 44 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 989us/step - loss: 0.0786
16/16 [==============================] - 0s 2ms/step - loss: 1.9769
16/16 [==============================] - 0s 912us/step - loss: 2.3185
16/16 [==============================] - 0s 821us/step - loss: 2.3281
16/16 [==============================] - 0s 808us/step - loss: 2.2839
16/16 [==============================] - 0s 773us/step - loss: 2.2375
16/16 [==============================] - 0s 810us/step - loss: 2.1975
16/16 [==============================] - 0s 798us/step - loss: 2.1816
16/16 [==============================] - 0s 782us/step - loss: 2.1765
16/16 [==============================] - 0s 787us/step - loss: 2.1752

Testing for epoch 44 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 873us/step - loss: 0.0812
16/16 [==============================] - 0s 874us/step - loss: 1.9463
16/16 [==============================] - 0s 822us/step - loss: 2.2893
16/16 [==============================] - 0s 2ms/step - loss: 2.3024
16/16 [==============================] - 0s 821us/step - loss: 2.2596
16/16 [==============================] - 0s 805us/step - loss: 2.2157
16/16 [==============================] - 0s 801us/step - loss: 2.1778
16/16 [==============================] - 0s 2ms/step - loss: 2.1624
16/16 [==============================] - 0s 2ms/step - loss: 2.1575
16/16 [==============================] - 0s 2ms/step - loss: 2.1563
Epoch 45 of 60

Testing for epoch 45 index 1:
79/79 [==============================] - 0s 884us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0783
16/16 [==============================] - 0s 2ms/step - loss: 2.0198
16/16 [==============================] - 0s 1ms/step - loss: 2.3791
16/16 [==============================] - 0s 1ms/step - loss: 2.3923
16/16 [==============================] - 0s 2ms/step - loss: 2.3469
16/16 [==============================] - 0s 903us/step - loss: 2.2994
16/16 [==============================] - 0s 1ms/step - loss: 2.2585
16/16 [==============================] - 0s 1ms/step - loss: 2.2422
16/16 [==============================] - 0s 814us/step - loss: 2.2371
16/16 [==============================] - 0s 2ms/step - loss: 2.2358

Testing for epoch 45 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 830us/step - loss: 0.0780
16/16 [==============================] - 0s 2ms/step - loss: 1.9802
16/16 [==============================] - 0s 839us/step - loss: 2.3284
16/16 [==============================] - 0s 2ms/step - loss: 2.3400
16/16 [==============================] - 0s 2ms/step - loss: 2.2966
16/16 [==============================] - 0s 2ms/step - loss: 2.2509
16/16 [==============================] - 0s 910us/step - loss: 2.2120
16/16 [==============================] - 0s 2ms/step - loss: 2.1964
16/16 [==============================] - 0s 827us/step - loss: 2.1915
16/16 [==============================] - 0s 788us/step - loss: 2.1903

Testing for epoch 45 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 828us/step - loss: 0.0798
16/16 [==============================] - 0s 865us/step - loss: 1.9756
16/16 [==============================] - 0s 1ms/step - loss: 2.3235
16/16 [==============================] - 0s 819us/step - loss: 2.3351
16/16 [==============================] - 0s 797us/step - loss: 2.2903
16/16 [==============================] - 0s 2ms/step - loss: 2.2432
16/16 [==============================] - 0s 1ms/step - loss: 2.2031
16/16 [==============================] - 0s 801us/step - loss: 2.1873
16/16 [==============================] - 0s 809us/step - loss: 2.1823
16/16 [==============================] - 0s 2ms/step - loss: 2.1811

Testing for epoch 45 index 4:
79/79 [==============================] - 0s 535us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0758
16/16 [==============================] - 0s 1ms/step - loss: 1.9627
16/16 [==============================] - 0s 2ms/step - loss: 2.3096
16/16 [==============================] - 0s 2ms/step - loss: 2.3244
16/16 [==============================] - 0s 1ms/step - loss: 2.2828
16/16 [==============================] - 0s 2ms/step - loss: 2.2391
16/16 [==============================] - 0s 2ms/step - loss: 2.2016
16/16 [==============================] - 0s 2ms/step - loss: 2.1862
16/16 [==============================] - 0s 3ms/step - loss: 2.1811
16/16 [==============================] - 0s 2ms/step - loss: 2.1798

Testing for epoch 45 index 5:
79/79 [==============================] - 0s 688us/step
16/16 [==============================] - 0s 835us/step - loss: 0.0776
16/16 [==============================] - 0s 2ms/step - loss: 2.0054
16/16 [==============================] - 0s 841us/step - loss: 2.3561
16/16 [==============================] - 0s 802us/step - loss: 2.3644
16/16 [==============================] - 0s 2ms/step - loss: 2.3185
16/16 [==============================] - 0s 2ms/step - loss: 2.2706
16/16 [==============================] - 0s 2ms/step - loss: 2.2302
16/16 [==============================] - 0s 2ms/step - loss: 2.2141
16/16 [==============================] - 0s 1ms/step - loss: 2.2091
16/16 [==============================] - 0s 867us/step - loss: 2.2078
Epoch 46 of 60

Testing for epoch 46 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0766
16/16 [==============================] - 0s 910us/step - loss: 2.0468
16/16 [==============================] - 0s 852us/step - loss: 2.4075
16/16 [==============================] - 0s 1ms/step - loss: 2.4124
16/16 [==============================] - 0s 859us/step - loss: 2.3621
16/16 [==============================] - 0s 1ms/step - loss: 2.3090
16/16 [==============================] - 0s 2ms/step - loss: 2.2651
16/16 [==============================] - 0s 867us/step - loss: 2.2476
16/16 [==============================] - 0s 1ms/step - loss: 2.2421
16/16 [==============================] - 0s 819us/step - loss: 2.2408

Testing for epoch 46 index 2:
79/79 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0757
16/16 [==============================] - 0s 874us/step - loss: 2.0077
16/16 [==============================] - 0s 2ms/step - loss: 2.3639
16/16 [==============================] - 0s 2ms/step - loss: 2.3732
16/16 [==============================] - 0s 2ms/step - loss: 2.3268
16/16 [==============================] - 0s 2ms/step - loss: 2.2781
16/16 [==============================] - 0s 2ms/step - loss: 2.2369
16/16 [==============================] - 0s 925us/step - loss: 2.2206
16/16 [==============================] - 0s 865us/step - loss: 2.2156
16/16 [==============================] - 0s 803us/step - loss: 2.2144

Testing for epoch 46 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0762
16/16 [==============================] - 0s 838us/step - loss: 2.0334
16/16 [==============================] - 0s 2ms/step - loss: 2.3980
16/16 [==============================] - 0s 2ms/step - loss: 2.4079
16/16 [==============================] - 0s 1ms/step - loss: 2.3617
16/16 [==============================] - 0s 2ms/step - loss: 2.3134
16/16 [==============================] - 0s 2ms/step - loss: 2.2729
16/16 [==============================] - 0s 2ms/step - loss: 2.2567
16/16 [==============================] - 0s 2ms/step - loss: 2.2516
16/16 [==============================] - 0s 860us/step - loss: 2.2503

Testing for epoch 46 index 4:
79/79 [==============================] - 0s 551us/step
16/16 [==============================] - 0s 994us/step - loss: 0.0765
16/16 [==============================] - 0s 2ms/step - loss: 1.9977
16/16 [==============================] - 0s 1ms/step - loss: 2.3481
16/16 [==============================] - 0s 2ms/step - loss: 2.3571
16/16 [==============================] - 0s 842us/step - loss: 2.3110
16/16 [==============================] - 0s 2ms/step - loss: 2.2619
16/16 [==============================] - 0s 1ms/step - loss: 2.2208
16/16 [==============================] - 0s 2ms/step - loss: 2.2046
16/16 [==============================] - 0s 865us/step - loss: 2.1997
16/16 [==============================] - 0s 1ms/step - loss: 2.1986

Testing for epoch 46 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0730
16/16 [==============================] - 0s 806us/step - loss: 2.0393
16/16 [==============================] - 0s 803us/step - loss: 2.3969
16/16 [==============================] - 0s 2ms/step - loss: 2.4039
16/16 [==============================] - 0s 2ms/step - loss: 2.3575
16/16 [==============================] - 0s 2ms/step - loss: 2.3071
16/16 [==============================] - 0s 2ms/step - loss: 2.2653
16/16 [==============================] - 0s 1ms/step - loss: 2.2487
16/16 [==============================] - 0s 2ms/step - loss: 2.2435
16/16 [==============================] - 0s 918us/step - loss: 2.2423
Epoch 47 of 60

Testing for epoch 47 index 1:
79/79 [==============================] - 0s 981us/step
16/16 [==============================] - 0s 798us/step - loss: 0.0779
16/16 [==============================] - 0s 796us/step - loss: 1.9997
16/16 [==============================] - 0s 815us/step - loss: 2.3521
16/16 [==============================] - 0s 808us/step - loss: 2.3601
16/16 [==============================] - 0s 786us/step - loss: 2.3139
16/16 [==============================] - 0s 2ms/step - loss: 2.2648
16/16 [==============================] - 0s 816us/step - loss: 2.2239
16/16 [==============================] - 0s 2ms/step - loss: 2.2078
16/16 [==============================] - 0s 2ms/step - loss: 2.2027
16/16 [==============================] - 0s 832us/step - loss: 2.2015

Testing for epoch 47 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 912us/step - loss: 0.0745
16/16 [==============================] - 0s 1ms/step - loss: 2.0626
16/16 [==============================] - 0s 1ms/step - loss: 2.4260
16/16 [==============================] - 0s 2ms/step - loss: 2.4307
16/16 [==============================] - 0s 810us/step - loss: 2.3819
16/16 [==============================] - 0s 2ms/step - loss: 2.3300
16/16 [==============================] - 0s 842us/step - loss: 2.2866
16/16 [==============================] - 0s 1ms/step - loss: 2.2695
16/16 [==============================] - 0s 2ms/step - loss: 2.2643
16/16 [==============================] - 0s 844us/step - loss: 2.2632

Testing for epoch 47 index 3:
79/79 [==============================] - 0s 534us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0758
16/16 [==============================] - 0s 2ms/step - loss: 2.0080
16/16 [==============================] - 0s 816us/step - loss: 2.3568
16/16 [==============================] - 0s 780us/step - loss: 2.3618
16/16 [==============================] - 0s 2ms/step - loss: 2.3151
16/16 [==============================] - 0s 1ms/step - loss: 2.2654
16/16 [==============================] - 0s 801us/step - loss: 2.2251
16/16 [==============================] - 0s 772us/step - loss: 2.2091
16/16 [==============================] - 0s 2ms/step - loss: 2.2042
16/16 [==============================] - 0s 881us/step - loss: 2.2030

Testing for epoch 47 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0747
16/16 [==============================] - 0s 2ms/step - loss: 2.0022
16/16 [==============================] - 0s 2ms/step - loss: 2.3530
16/16 [==============================] - 0s 2ms/step - loss: 2.3562
16/16 [==============================] - 0s 2ms/step - loss: 2.3092
16/16 [==============================] - 0s 1ms/step - loss: 2.2594
16/16 [==============================] - 0s 2ms/step - loss: 2.2185
16/16 [==============================] - 0s 2ms/step - loss: 2.2023
16/16 [==============================] - 0s 1ms/step - loss: 2.1973
16/16 [==============================] - 0s 2ms/step - loss: 2.1961

Testing for epoch 47 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0735
16/16 [==============================] - 0s 2ms/step - loss: 1.9776
16/16 [==============================] - 0s 2ms/step - loss: 2.3273
16/16 [==============================] - 0s 965us/step - loss: 2.3315
16/16 [==============================] - 0s 2ms/step - loss: 2.2852
16/16 [==============================] - 0s 836us/step - loss: 2.2358
16/16 [==============================] - 0s 908us/step - loss: 2.1957
16/16 [==============================] - 0s 1ms/step - loss: 2.1799
16/16 [==============================] - 0s 2ms/step - loss: 2.1750
16/16 [==============================] - 0s 792us/step - loss: 2.1739
Epoch 48 of 60

Testing for epoch 48 index 1:
79/79 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 858us/step - loss: 0.0767
16/16 [==============================] - 0s 2ms/step - loss: 1.9967
16/16 [==============================] - 0s 2ms/step - loss: 2.3544
16/16 [==============================] - 0s 2ms/step - loss: 2.3631
16/16 [==============================] - 0s 881us/step - loss: 2.3191
16/16 [==============================] - 0s 955us/step - loss: 2.2712
16/16 [==============================] - 0s 777us/step - loss: 2.2313
16/16 [==============================] - 0s 1ms/step - loss: 2.2155
16/16 [==============================] - 0s 2ms/step - loss: 2.2106
16/16 [==============================] - 0s 971us/step - loss: 2.2094

Testing for epoch 48 index 2:
79/79 [==============================] - 0s 544us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0744
16/16 [==============================] - 0s 793us/step - loss: 2.0462
16/16 [==============================] - 0s 2ms/step - loss: 2.4087
16/16 [==============================] - 0s 870us/step - loss: 2.4139
16/16 [==============================] - 0s 917us/step - loss: 2.3674
16/16 [==============================] - 0s 1ms/step - loss: 2.3175
16/16 [==============================] - 0s 2ms/step - loss: 2.2763
16/16 [==============================] - 0s 969us/step - loss: 2.2598
16/16 [==============================] - 0s 922us/step - loss: 2.2546
16/16 [==============================] - 0s 2ms/step - loss: 2.2534

Testing for epoch 48 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0725
16/16 [==============================] - 0s 807us/step - loss: 1.9861
16/16 [==============================] - 0s 774us/step - loss: 2.3321
16/16 [==============================] - 0s 2ms/step - loss: 2.3336
16/16 [==============================] - 0s 1ms/step - loss: 2.2873
16/16 [==============================] - 0s 2ms/step - loss: 2.2385
16/16 [==============================] - 0s 2ms/step - loss: 2.1987
16/16 [==============================] - 0s 2ms/step - loss: 2.1831
16/16 [==============================] - 0s 1ms/step - loss: 2.1782
16/16 [==============================] - 0s 2ms/step - loss: 2.1770

Testing for epoch 48 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0735
16/16 [==============================] - 0s 1ms/step - loss: 2.0634
16/16 [==============================] - 0s 1ms/step - loss: 2.4291
16/16 [==============================] - 0s 832us/step - loss: 2.4289
16/16 [==============================] - 0s 2ms/step - loss: 2.3797
16/16 [==============================] - 0s 2ms/step - loss: 2.3278
16/16 [==============================] - 0s 815us/step - loss: 2.2851
16/16 [==============================] - 0s 945us/step - loss: 2.2683
16/16 [==============================] - 0s 832us/step - loss: 2.2629
16/16 [==============================] - 0s 2ms/step - loss: 2.2616

Testing for epoch 48 index 5:
79/79 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0733
16/16 [==============================] - 0s 2ms/step - loss: 2.0079
16/16 [==============================] - 0s 2ms/step - loss: 2.3607
16/16 [==============================] - 0s 1ms/step - loss: 2.3650
16/16 [==============================] - 0s 1ms/step - loss: 2.3203
16/16 [==============================] - 0s 793us/step - loss: 2.2709
16/16 [==============================] - 0s 804us/step - loss: 2.2304
16/16 [==============================] - 0s 780us/step - loss: 2.2146
16/16 [==============================] - 0s 777us/step - loss: 2.2096
16/16 [==============================] - 0s 784us/step - loss: 2.2084
Epoch 49 of 60

Testing for epoch 49 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 810us/step - loss: 0.0732
16/16 [==============================] - 0s 771us/step - loss: 2.0067
16/16 [==============================] - 0s 803us/step - loss: 2.3527
16/16 [==============================] - 0s 775us/step - loss: 2.3471
16/16 [==============================] - 0s 2ms/step - loss: 2.2989
16/16 [==============================] - 0s 916us/step - loss: 2.2484
16/16 [==============================] - 0s 1ms/step - loss: 2.2073
16/16 [==============================] - 0s 2ms/step - loss: 2.1913
16/16 [==============================] - 0s 811us/step - loss: 2.1863
16/16 [==============================] - 0s 846us/step - loss: 2.1852

Testing for epoch 49 index 2:
79/79 [==============================] - 0s 917us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0743
16/16 [==============================] - 0s 846us/step - loss: 2.0124
16/16 [==============================] - 0s 932us/step - loss: 2.3659
16/16 [==============================] - 0s 2ms/step - loss: 2.3646
16/16 [==============================] - 0s 853us/step - loss: 2.3179
16/16 [==============================] - 0s 917us/step - loss: 2.2673
16/16 [==============================] - 0s 800us/step - loss: 2.2262
16/16 [==============================] - 0s 801us/step - loss: 2.2100
16/16 [==============================] - 0s 1ms/step - loss: 2.2049
16/16 [==============================] - 0s 2ms/step - loss: 2.2037

Testing for epoch 49 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 883us/step - loss: 0.0698
16/16 [==============================] - 0s 875us/step - loss: 2.0977
16/16 [==============================] - 0s 802us/step - loss: 2.4681
16/16 [==============================] - 0s 2ms/step - loss: 2.4630
16/16 [==============================] - 0s 821us/step - loss: 2.4103
16/16 [==============================] - 0s 2ms/step - loss: 2.3536
16/16 [==============================] - 0s 862us/step - loss: 2.3085
16/16 [==============================] - 0s 802us/step - loss: 2.2909
16/16 [==============================] - 0s 876us/step - loss: 2.2855
16/16 [==============================] - 0s 1ms/step - loss: 2.2842

Testing for epoch 49 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 825us/step - loss: 0.0715
16/16 [==============================] - 0s 797us/step - loss: 2.0768
16/16 [==============================] - 0s 788us/step - loss: 2.4382
16/16 [==============================] - 0s 812us/step - loss: 2.4322
16/16 [==============================] - 0s 797us/step - loss: 2.3825
16/16 [==============================] - 0s 819us/step - loss: 2.3286
16/16 [==============================] - 0s 2ms/step - loss: 2.2850
16/16 [==============================] - 0s 2ms/step - loss: 2.2680
16/16 [==============================] - 0s 956us/step - loss: 2.2627
16/16 [==============================] - 0s 1ms/step - loss: 2.2615

Testing for epoch 49 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 883us/step - loss: 0.0726
16/16 [==============================] - 0s 1ms/step - loss: 1.9929
16/16 [==============================] - 0s 862us/step - loss: 2.3413
16/16 [==============================] - 0s 2ms/step - loss: 2.3376
16/16 [==============================] - 0s 813us/step - loss: 2.2908
16/16 [==============================] - 0s 797us/step - loss: 2.2405
16/16 [==============================] - 0s 2ms/step - loss: 2.1999
16/16 [==============================] - 0s 820us/step - loss: 2.1841
16/16 [==============================] - 0s 785us/step - loss: 2.1791
16/16 [==============================] - 0s 1ms/step - loss: 2.1779
Epoch 50 of 60

Testing for epoch 50 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 984us/step - loss: 0.0698
16/16 [==============================] - 0s 879us/step - loss: 2.0829
16/16 [==============================] - 0s 841us/step - loss: 2.4574
16/16 [==============================] - 0s 2ms/step - loss: 2.4604
16/16 [==============================] - 0s 848us/step - loss: 2.4129
16/16 [==============================] - 0s 1ms/step - loss: 2.3622
16/16 [==============================] - 0s 836us/step - loss: 2.3207
16/16 [==============================] - 0s 1ms/step - loss: 2.3042
16/16 [==============================] - 0s 2ms/step - loss: 2.2990
16/16 [==============================] - 0s 849us/step - loss: 2.2977

Testing for epoch 50 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0696
16/16 [==============================] - 0s 2ms/step - loss: 2.0772
16/16 [==============================] - 0s 2ms/step - loss: 2.4379
16/16 [==============================] - 0s 1ms/step - loss: 2.4321
16/16 [==============================] - 0s 911us/step - loss: 2.3819
16/16 [==============================] - 0s 858us/step - loss: 2.3297
16/16 [==============================] - 0s 814us/step - loss: 2.2877
16/16 [==============================] - 0s 834us/step - loss: 2.2713
16/16 [==============================] - 0s 1ms/step - loss: 2.2663
16/16 [==============================] - 0s 2ms/step - loss: 2.2652

Testing for epoch 50 index 3:
79/79 [==============================] - 0s 636us/step
16/16 [==============================] - 0s 801us/step - loss: 0.0736
16/16 [==============================] - 0s 798us/step - loss: 2.0414
16/16 [==============================] - 0s 2ms/step - loss: 2.3966
16/16 [==============================] - 0s 2ms/step - loss: 2.3948
16/16 [==============================] - 0s 2ms/step - loss: 2.3477
16/16 [==============================] - 0s 2ms/step - loss: 2.2969
16/16 [==============================] - 0s 928us/step - loss: 2.2558
16/16 [==============================] - 0s 2ms/step - loss: 2.2397
16/16 [==============================] - 0s 849us/step - loss: 2.2347
16/16 [==============================] - 0s 829us/step - loss: 2.2335

Testing for epoch 50 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0732
16/16 [==============================] - 0s 2ms/step - loss: 2.0117
16/16 [==============================] - 0s 851us/step - loss: 2.3635
16/16 [==============================] - 0s 2ms/step - loss: 2.3617
16/16 [==============================] - 0s 808us/step - loss: 2.3142
16/16 [==============================] - 0s 1ms/step - loss: 2.2635
16/16 [==============================] - 0s 2ms/step - loss: 2.2230
16/16 [==============================] - 0s 935us/step - loss: 2.2070
16/16 [==============================] - 0s 812us/step - loss: 2.2018
16/16 [==============================] - 0s 1ms/step - loss: 2.2004

Testing for epoch 50 index 5:
79/79 [==============================] - 0s 560us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0689
16/16 [==============================] - 0s 2ms/step - loss: 2.0838
16/16 [==============================] - 0s 832us/step - loss: 2.4465
16/16 [==============================] - 0s 805us/step - loss: 2.4418
16/16 [==============================] - 0s 790us/step - loss: 2.3901
16/16 [==============================] - 0s 1ms/step - loss: 2.3353
16/16 [==============================] - 0s 2ms/step - loss: 2.2913
16/16 [==============================] - 0s 816us/step - loss: 2.2745
16/16 [==============================] - 0s 2ms/step - loss: 2.2694
16/16 [==============================] - 0s 2ms/step - loss: 2.2682
Epoch 51 of 60

Testing for epoch 51 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 785us/step - loss: 0.0731
16/16 [==============================] - 0s 2ms/step - loss: 2.0468
16/16 [==============================] - 0s 1ms/step - loss: 2.4122
16/16 [==============================] - 0s 2ms/step - loss: 2.4120
16/16 [==============================] - 0s 832us/step - loss: 2.3644
16/16 [==============================] - 0s 792us/step - loss: 2.3140
16/16 [==============================] - 0s 1ms/step - loss: 2.2734
16/16 [==============================] - 0s 2ms/step - loss: 2.2577
16/16 [==============================] - 0s 2ms/step - loss: 2.2528
16/16 [==============================] - 0s 875us/step - loss: 2.2516

Testing for epoch 51 index 2:
79/79 [==============================] - 0s 996us/step
16/16 [==============================] - 0s 822us/step - loss: 0.0697
16/16 [==============================] - 0s 788us/step - loss: 2.0365
16/16 [==============================] - 0s 2ms/step - loss: 2.3938
16/16 [==============================] - 0s 2ms/step - loss: 2.3895
16/16 [==============================] - 0s 814us/step - loss: 2.3405
16/16 [==============================] - 0s 1ms/step - loss: 2.2889
16/16 [==============================] - 0s 796us/step - loss: 2.2475
16/16 [==============================] - 0s 2ms/step - loss: 2.2314
16/16 [==============================] - 0s 812us/step - loss: 2.2264
16/16 [==============================] - 0s 767us/step - loss: 2.2251

Testing for epoch 51 index 3:
79/79 [==============================] - 0s 994us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0681
16/16 [==============================] - 0s 897us/step - loss: 2.0709
16/16 [==============================] - 0s 2ms/step - loss: 2.4350
16/16 [==============================] - 0s 872us/step - loss: 2.4303
16/16 [==============================] - 0s 2ms/step - loss: 2.3793
16/16 [==============================] - 0s 2ms/step - loss: 2.3248
16/16 [==============================] - 0s 2ms/step - loss: 2.2811
16/16 [==============================] - 0s 906us/step - loss: 2.2643
16/16 [==============================] - 0s 2ms/step - loss: 2.2593
16/16 [==============================] - 0s 2ms/step - loss: 2.2581

Testing for epoch 51 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0708
16/16 [==============================] - 0s 2ms/step - loss: 2.0492
16/16 [==============================] - 0s 2ms/step - loss: 2.4075
16/16 [==============================] - 0s 2ms/step - loss: 2.4020
16/16 [==============================] - 0s 2ms/step - loss: 2.3530
16/16 [==============================] - 0s 889us/step - loss: 2.3003
16/16 [==============================] - 0s 848us/step - loss: 2.2581
16/16 [==============================] - 0s 784us/step - loss: 2.2419
16/16 [==============================] - 0s 2ms/step - loss: 2.2368
16/16 [==============================] - 0s 2ms/step - loss: 2.2356

Testing for epoch 51 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0692
16/16 [==============================] - 0s 2ms/step - loss: 2.1075
16/16 [==============================] - 0s 2ms/step - loss: 2.4767
16/16 [==============================] - 0s 2ms/step - loss: 2.4664
16/16 [==============================] - 0s 2ms/step - loss: 2.4114
16/16 [==============================] - 0s 899us/step - loss: 2.3533
16/16 [==============================] - 0s 948us/step - loss: 2.3075
16/16 [==============================] - 0s 2ms/step - loss: 2.2900
16/16 [==============================] - 0s 924us/step - loss: 2.2846
16/16 [==============================] - 0s 2ms/step - loss: 2.2834
Epoch 52 of 60

Testing for epoch 52 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0685
16/16 [==============================] - 0s 2ms/step - loss: 2.1059
16/16 [==============================] - 0s 2ms/step - loss: 2.4929
16/16 [==============================] - 0s 2ms/step - loss: 2.4970
16/16 [==============================] - 0s 967us/step - loss: 2.4491
16/16 [==============================] - 0s 2ms/step - loss: 2.3965
16/16 [==============================] - 0s 1ms/step - loss: 2.3534
16/16 [==============================] - 0s 848us/step - loss: 2.3367
16/16 [==============================] - 0s 2ms/step - loss: 2.3315
16/16 [==============================] - 0s 825us/step - loss: 2.3301

Testing for epoch 52 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 826us/step - loss: 0.0681
16/16 [==============================] - 0s 826us/step - loss: 2.0712
16/16 [==============================] - 0s 2ms/step - loss: 2.4428
16/16 [==============================] - 0s 2ms/step - loss: 2.4404
16/16 [==============================] - 0s 2ms/step - loss: 2.3914
16/16 [==============================] - 0s 820us/step - loss: 2.3382
16/16 [==============================] - 0s 796us/step - loss: 2.2957
16/16 [==============================] - 0s 1ms/step - loss: 2.2793
16/16 [==============================] - 0s 839us/step - loss: 2.2742
16/16 [==============================] - 0s 2ms/step - loss: 2.2729

Testing for epoch 52 index 3:
79/79 [==============================] - 0s 546us/step
16/16 [==============================] - 0s 788us/step - loss: 0.0695
16/16 [==============================] - 0s 774us/step - loss: 2.0962
16/16 [==============================] - 0s 917us/step - loss: 2.4675
16/16 [==============================] - 0s 2ms/step - loss: 2.4621
16/16 [==============================] - 0s 2ms/step - loss: 2.4117
16/16 [==============================] - 0s 2ms/step - loss: 2.3581
16/16 [==============================] - 0s 980us/step - loss: 2.3151
16/16 [==============================] - 0s 2ms/step - loss: 2.2985
16/16 [==============================] - 0s 2ms/step - loss: 2.2934
16/16 [==============================] - 0s 1ms/step - loss: 2.2921

Testing for epoch 52 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0678
16/16 [==============================] - 0s 2ms/step - loss: 2.0956
16/16 [==============================] - 0s 930us/step - loss: 2.4642
16/16 [==============================] - 0s 915us/step - loss: 2.4530
16/16 [==============================] - 0s 809us/step - loss: 2.3982
16/16 [==============================] - 0s 814us/step - loss: 2.3407
16/16 [==============================] - 0s 808us/step - loss: 2.2950
16/16 [==============================] - 0s 857us/step - loss: 2.2774
16/16 [==============================] - 0s 815us/step - loss: 2.2720
16/16 [==============================] - 0s 2ms/step - loss: 2.2708

Testing for epoch 52 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0698
16/16 [==============================] - 0s 2ms/step - loss: 2.1065
16/16 [==============================] - 0s 1ms/step - loss: 2.4821
16/16 [==============================] - 0s 2ms/step - loss: 2.4692
16/16 [==============================] - 0s 876us/step - loss: 2.4147
16/16 [==============================] - 0s 2ms/step - loss: 2.3576
16/16 [==============================] - 0s 1ms/step - loss: 2.3128
16/16 [==============================] - 0s 872us/step - loss: 2.2956
16/16 [==============================] - 0s 795us/step - loss: 2.2903
16/16 [==============================] - 0s 799us/step - loss: 2.2891
Epoch 53 of 60

Testing for epoch 53 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 902us/step - loss: 0.0672
16/16 [==============================] - 0s 2ms/step - loss: 2.1232
16/16 [==============================] - 0s 2ms/step - loss: 2.5020
16/16 [==============================] - 0s 2ms/step - loss: 2.4944
16/16 [==============================] - 0s 2ms/step - loss: 2.4420
16/16 [==============================] - 0s 2ms/step - loss: 2.3869
16/16 [==============================] - 0s 925us/step - loss: 2.3429
16/16 [==============================] - 0s 836us/step - loss: 2.3260
16/16 [==============================] - 0s 803us/step - loss: 2.3208
16/16 [==============================] - 0s 989us/step - loss: 2.3195

Testing for epoch 53 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 837us/step - loss: 0.0671
16/16 [==============================] - 0s 1ms/step - loss: 2.1642
16/16 [==============================] - 0s 2ms/step - loss: 2.5565
16/16 [==============================] - 0s 1ms/step - loss: 2.5513
16/16 [==============================] - 0s 787us/step - loss: 2.4989
16/16 [==============================] - 0s 851us/step - loss: 2.4426
16/16 [==============================] - 0s 2ms/step - loss: 2.3977
16/16 [==============================] - 0s 2ms/step - loss: 2.3802
16/16 [==============================] - 0s 2ms/step - loss: 2.3747
16/16 [==============================] - 0s 2ms/step - loss: 2.3733

Testing for epoch 53 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0691
16/16 [==============================] - 0s 1ms/step - loss: 2.1175
16/16 [==============================] - 0s 926us/step - loss: 2.4916
16/16 [==============================] - 0s 2ms/step - loss: 2.4838
16/16 [==============================] - 0s 1ms/step - loss: 2.4293
16/16 [==============================] - 0s 2ms/step - loss: 2.3711
16/16 [==============================] - 0s 927us/step - loss: 2.3259
16/16 [==============================] - 0s 2ms/step - loss: 2.3088
16/16 [==============================] - 0s 947us/step - loss: 2.3035
16/16 [==============================] - 0s 1ms/step - loss: 2.3022

Testing for epoch 53 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0647
16/16 [==============================] - 0s 851us/step - loss: 2.1075
16/16 [==============================] - 0s 822us/step - loss: 2.4701
16/16 [==============================] - 0s 832us/step - loss: 2.4603
16/16 [==============================] - 0s 786us/step - loss: 2.4066
16/16 [==============================] - 0s 802us/step - loss: 2.3501
16/16 [==============================] - 0s 779us/step - loss: 2.3057
16/16 [==============================] - 0s 2ms/step - loss: 2.2888
16/16 [==============================] - 0s 1ms/step - loss: 2.2836
16/16 [==============================] - 0s 859us/step - loss: 2.2823

Testing for epoch 53 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0668
16/16 [==============================] - 0s 858us/step - loss: 2.1158
16/16 [==============================] - 0s 2ms/step - loss: 2.4846
16/16 [==============================] - 0s 790us/step - loss: 2.4771
16/16 [==============================] - 0s 779us/step - loss: 2.4247
16/16 [==============================] - 0s 784us/step - loss: 2.3707
16/16 [==============================] - 0s 2ms/step - loss: 2.3276
16/16 [==============================] - 0s 2ms/step - loss: 2.3107
16/16 [==============================] - 0s 2ms/step - loss: 2.3053
16/16 [==============================] - 0s 2ms/step - loss: 2.3039
Epoch 54 of 60

Testing for epoch 54 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0669
16/16 [==============================] - 0s 1ms/step - loss: 2.1070
16/16 [==============================] - 0s 958us/step - loss: 2.4657
16/16 [==============================] - 0s 861us/step - loss: 2.4552
16/16 [==============================] - 0s 1ms/step - loss: 2.4006
16/16 [==============================] - 0s 824us/step - loss: 2.3447
16/16 [==============================] - 0s 784us/step - loss: 2.3012
16/16 [==============================] - 0s 2ms/step - loss: 2.2846
16/16 [==============================] - 0s 1ms/step - loss: 2.2795
16/16 [==============================] - 0s 2ms/step - loss: 2.2784

Testing for epoch 54 index 2:
79/79 [==============================] - 0s 664us/step
16/16 [==============================] - 0s 792us/step - loss: 0.0690
16/16 [==============================] - 0s 2ms/step - loss: 2.1828
16/16 [==============================] - 0s 2ms/step - loss: 2.5562
16/16 [==============================] - 0s 2ms/step - loss: 2.5489
16/16 [==============================] - 0s 1ms/step - loss: 2.4953
16/16 [==============================] - 0s 828us/step - loss: 2.4394
16/16 [==============================] - 0s 777us/step - loss: 2.3954
16/16 [==============================] - 0s 2ms/step - loss: 2.3785
16/16 [==============================] - 0s 1ms/step - loss: 2.3734
16/16 [==============================] - 0s 819us/step - loss: 2.3721

Testing for epoch 54 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0674
16/16 [==============================] - 0s 934us/step - loss: 2.0479
16/16 [==============================] - 0s 2ms/step - loss: 2.3901
16/16 [==============================] - 0s 904us/step - loss: 2.3841
16/16 [==============================] - 0s 799us/step - loss: 2.3349
16/16 [==============================] - 0s 817us/step - loss: 2.2833
16/16 [==============================] - 0s 799us/step - loss: 2.2424
16/16 [==============================] - 0s 812us/step - loss: 2.2267
16/16 [==============================] - 0s 778us/step - loss: 2.2218
16/16 [==============================] - 0s 1ms/step - loss: 2.2207

Testing for epoch 54 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0671
16/16 [==============================] - 0s 880us/step - loss: 2.1221
16/16 [==============================] - 0s 2ms/step - loss: 2.4701
16/16 [==============================] - 0s 2ms/step - loss: 2.4558
16/16 [==============================] - 0s 878us/step - loss: 2.4003
16/16 [==============================] - 0s 812us/step - loss: 2.3425
16/16 [==============================] - 0s 788us/step - loss: 2.2978
16/16 [==============================] - 0s 814us/step - loss: 2.2808
16/16 [==============================] - 0s 796us/step - loss: 2.2756
16/16 [==============================] - 0s 898us/step - loss: 2.2743

Testing for epoch 54 index 5:
79/79 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0663
16/16 [==============================] - 0s 951us/step - loss: 2.1344
16/16 [==============================] - 0s 2ms/step - loss: 2.4931
16/16 [==============================] - 0s 2ms/step - loss: 2.4845
16/16 [==============================] - 0s 856us/step - loss: 2.4344
16/16 [==============================] - 0s 2ms/step - loss: 2.3803
16/16 [==============================] - 0s 826us/step - loss: 2.3370
16/16 [==============================] - 0s 805us/step - loss: 2.3205
16/16 [==============================] - 0s 2ms/step - loss: 2.3155
16/16 [==============================] - 0s 1ms/step - loss: 2.3143
Epoch 55 of 60

Testing for epoch 55 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0679
16/16 [==============================] - 0s 836us/step - loss: 2.0815
16/16 [==============================] - 0s 1ms/step - loss: 2.4278
16/16 [==============================] - 0s 789us/step - loss: 2.4172
16/16 [==============================] - 0s 746us/step - loss: 2.3647
16/16 [==============================] - 0s 769us/step - loss: 2.3094
16/16 [==============================] - 0s 869us/step - loss: 2.2667
16/16 [==============================] - 0s 2ms/step - loss: 2.2502
16/16 [==============================] - 0s 2ms/step - loss: 2.2451
16/16 [==============================] - 0s 2ms/step - loss: 2.2437

Testing for epoch 55 index 2:
79/79 [==============================] - 0s 935us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0648
16/16 [==============================] - 0s 846us/step - loss: 2.1377
16/16 [==============================] - 0s 818us/step - loss: 2.4996
16/16 [==============================] - 0s 802us/step - loss: 2.4929
16/16 [==============================] - 0s 797us/step - loss: 2.4417
16/16 [==============================] - 0s 2ms/step - loss: 2.3863
16/16 [==============================] - 0s 2ms/step - loss: 2.3429
16/16 [==============================] - 0s 2ms/step - loss: 2.3263
16/16 [==============================] - 0s 2ms/step - loss: 2.3214
16/16 [==============================] - 0s 927us/step - loss: 2.3203

Testing for epoch 55 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0655
16/16 [==============================] - 0s 1ms/step - loss: 2.1209
16/16 [==============================] - 0s 897us/step - loss: 2.4647
16/16 [==============================] - 0s 1ms/step - loss: 2.4525
16/16 [==============================] - 0s 893us/step - loss: 2.4002
16/16 [==============================] - 0s 2ms/step - loss: 2.3439
16/16 [==============================] - 0s 841us/step - loss: 2.2999
16/16 [==============================] - 0s 2ms/step - loss: 2.2832
16/16 [==============================] - 0s 842us/step - loss: 2.2781
16/16 [==============================] - 0s 795us/step - loss: 2.2769

Testing for epoch 55 index 4:
79/79 [==============================] - 0s 536us/step
16/16 [==============================] - 0s 790us/step - loss: 0.0656
16/16 [==============================] - 0s 772us/step - loss: 2.1164
16/16 [==============================] - 0s 884us/step - loss: 2.4588
16/16 [==============================] - 0s 1ms/step - loss: 2.4436
16/16 [==============================] - 0s 2ms/step - loss: 2.3897
16/16 [==============================] - 0s 876us/step - loss: 2.3342
16/16 [==============================] - 0s 1ms/step - loss: 2.2912
16/16 [==============================] - 0s 968us/step - loss: 2.2750
16/16 [==============================] - 0s 2ms/step - loss: 2.2701
16/16 [==============================] - 0s 2ms/step - loss: 2.2690

Testing for epoch 55 index 5:
79/79 [==============================] - 0s 820us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0652
16/16 [==============================] - 0s 2ms/step - loss: 2.1518
16/16 [==============================] - 0s 2ms/step - loss: 2.5130
16/16 [==============================] - 0s 2ms/step - loss: 2.4994
16/16 [==============================] - 0s 1ms/step - loss: 2.4455
16/16 [==============================] - 0s 930us/step - loss: 2.3889
16/16 [==============================] - 0s 1ms/step - loss: 2.3445
16/16 [==============================] - 0s 2ms/step - loss: 2.3273
16/16 [==============================] - 0s 2ms/step - loss: 2.3221
16/16 [==============================] - 0s 798us/step - loss: 2.3208
Epoch 56 of 60

Testing for epoch 56 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0643
16/16 [==============================] - 0s 2ms/step - loss: 2.1867
16/16 [==============================] - 0s 1ms/step - loss: 2.5477
16/16 [==============================] - 0s 2ms/step - loss: 2.5307
16/16 [==============================] - 0s 2ms/step - loss: 2.4748
16/16 [==============================] - 0s 846us/step - loss: 2.4170
16/16 [==============================] - 0s 2ms/step - loss: 2.3722
16/16 [==============================] - 0s 892us/step - loss: 2.3551
16/16 [==============================] - 0s 816us/step - loss: 2.3498
16/16 [==============================] - 0s 1ms/step - loss: 2.3486

Testing for epoch 56 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 900us/step - loss: 0.0658
16/16 [==============================] - 0s 2ms/step - loss: 2.1272
16/16 [==============================] - 0s 912us/step - loss: 2.4774
16/16 [==============================] - 0s 2ms/step - loss: 2.4623
16/16 [==============================] - 0s 2ms/step - loss: 2.4081
16/16 [==============================] - 0s 1ms/step - loss: 2.3514
16/16 [==============================] - 0s 813us/step - loss: 2.3074
16/16 [==============================] - 0s 791us/step - loss: 2.2906
16/16 [==============================] - 0s 2ms/step - loss: 2.2855
16/16 [==============================] - 0s 2ms/step - loss: 2.2843

Testing for epoch 56 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0636
16/16 [==============================] - 0s 1ms/step - loss: 2.1518
16/16 [==============================] - 0s 1ms/step - loss: 2.4905
16/16 [==============================] - 0s 825us/step - loss: 2.4634
16/16 [==============================] - 0s 2ms/step - loss: 2.4054
16/16 [==============================] - 0s 1ms/step - loss: 2.3458
16/16 [==============================] - 0s 793us/step - loss: 2.3005
16/16 [==============================] - 0s 820us/step - loss: 2.2834
16/16 [==============================] - 0s 2ms/step - loss: 2.2783
16/16 [==============================] - 0s 2ms/step - loss: 2.2771

Testing for epoch 56 index 4:
79/79 [==============================] - 0s 936us/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0625
16/16 [==============================] - 0s 826us/step - loss: 2.2182
16/16 [==============================] - 0s 828us/step - loss: 2.5822
16/16 [==============================] - 0s 838us/step - loss: 2.5602
16/16 [==============================] - 0s 794us/step - loss: 2.5020
16/16 [==============================] - 0s 857us/step - loss: 2.4396
16/16 [==============================] - 0s 854us/step - loss: 2.3916
16/16 [==============================] - 0s 831us/step - loss: 2.3735
16/16 [==============================] - 0s 831us/step - loss: 2.3679
16/16 [==============================] - 0s 2ms/step - loss: 2.3666

Testing for epoch 56 index 5:
79/79 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0646
16/16 [==============================] - 0s 1ms/step - loss: 2.1041
16/16 [==============================] - 0s 823us/step - loss: 2.4493
16/16 [==============================] - 0s 2ms/step - loss: 2.4361
16/16 [==============================] - 0s 2ms/step - loss: 2.3867
16/16 [==============================] - 0s 848us/step - loss: 2.3334
16/16 [==============================] - 0s 807us/step - loss: 2.2913
16/16 [==============================] - 0s 773us/step - loss: 2.2751
16/16 [==============================] - 0s 1ms/step - loss: 2.2701
16/16 [==============================] - 0s 802us/step - loss: 2.2689
Epoch 57 of 60

Testing for epoch 57 index 1:
79/79 [==============================] - 0s 563us/step
16/16 [==============================] - 0s 775us/step - loss: 0.0614
16/16 [==============================] - 0s 778us/step - loss: 2.1879
16/16 [==============================] - 0s 790us/step - loss: 2.5443
16/16 [==============================] - 0s 774us/step - loss: 2.5183
16/16 [==============================] - 0s 763us/step - loss: 2.4600
16/16 [==============================] - 0s 803us/step - loss: 2.3990
16/16 [==============================] - 0s 776us/step - loss: 2.3521
16/16 [==============================] - 0s 2ms/step - loss: 2.3345
16/16 [==============================] - 0s 2ms/step - loss: 2.3293
16/16 [==============================] - 0s 2ms/step - loss: 2.3280

Testing for epoch 57 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0642
16/16 [==============================] - 0s 2ms/step - loss: 2.1720
16/16 [==============================] - 0s 1ms/step - loss: 2.5330
16/16 [==============================] - 0s 823us/step - loss: 2.5108
16/16 [==============================] - 0s 2ms/step - loss: 2.4543
16/16 [==============================] - 0s 1ms/step - loss: 2.3953
16/16 [==============================] - 0s 763us/step - loss: 2.3507
16/16 [==============================] - 0s 1ms/step - loss: 2.3336
16/16 [==============================] - 0s 2ms/step - loss: 2.3284
16/16 [==============================] - 0s 1ms/step - loss: 2.3272

Testing for epoch 57 index 3:
79/79 [==============================] - 0s 571us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0665
16/16 [==============================] - 0s 847us/step - loss: 2.1306
16/16 [==============================] - 0s 793us/step - loss: 2.4777
16/16 [==============================] - 0s 810us/step - loss: 2.4554
16/16 [==============================] - 0s 2ms/step - loss: 2.4022
16/16 [==============================] - 0s 816us/step - loss: 2.3453
16/16 [==============================] - 0s 2ms/step - loss: 2.3014
16/16 [==============================] - 0s 853us/step - loss: 2.2845
16/16 [==============================] - 0s 2ms/step - loss: 2.2792
16/16 [==============================] - 0s 852us/step - loss: 2.2779

Testing for epoch 57 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 905us/step - loss: 0.0622
16/16 [==============================] - 0s 1ms/step - loss: 2.1649
16/16 [==============================] - 0s 2ms/step - loss: 2.5212
16/16 [==============================] - 0s 2ms/step - loss: 2.4932
16/16 [==============================] - 0s 2ms/step - loss: 2.4352
16/16 [==============================] - 0s 2ms/step - loss: 2.3743
16/16 [==============================] - 0s 2ms/step - loss: 2.3291
16/16 [==============================] - 0s 2ms/step - loss: 2.3120
16/16 [==============================] - 0s 1ms/step - loss: 2.3068
16/16 [==============================] - 0s 873us/step - loss: 2.3056

Testing for epoch 57 index 5:
79/79 [==============================] - 0s 876us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0616
16/16 [==============================] - 0s 768us/step - loss: 2.2366
16/16 [==============================] - 0s 1ms/step - loss: 2.6058
16/16 [==============================] - 0s 2ms/step - loss: 2.5771
16/16 [==============================] - 0s 794us/step - loss: 2.5177
16/16 [==============================] - 0s 785us/step - loss: 2.4556
16/16 [==============================] - 0s 773us/step - loss: 2.4087
16/16 [==============================] - 0s 812us/step - loss: 2.3907
16/16 [==============================] - 0s 784us/step - loss: 2.3851
16/16 [==============================] - 0s 2ms/step - loss: 2.3837
Epoch 58 of 60

Testing for epoch 58 index 1:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0639
16/16 [==============================] - 0s 1ms/step - loss: 2.1615
16/16 [==============================] - 0s 2ms/step - loss: 2.5153
16/16 [==============================] - 0s 895us/step - loss: 2.4855
16/16 [==============================] - 0s 952us/step - loss: 2.4284
16/16 [==============================] - 0s 2ms/step - loss: 2.3688
16/16 [==============================] - 0s 2ms/step - loss: 2.3240
16/16 [==============================] - 0s 1ms/step - loss: 2.3071
16/16 [==============================] - 0s 2ms/step - loss: 2.3021
16/16 [==============================] - 0s 2ms/step - loss: 2.3009

Testing for epoch 58 index 2:
79/79 [==============================] - 0s 547us/step
16/16 [==============================] - 0s 790us/step - loss: 0.0640
16/16 [==============================] - 0s 2ms/step - loss: 2.1783
16/16 [==============================] - 0s 2ms/step - loss: 2.5323
16/16 [==============================] - 0s 2ms/step - loss: 2.5076
16/16 [==============================] - 0s 2ms/step - loss: 2.4511
16/16 [==============================] - 0s 914us/step - loss: 2.3926
16/16 [==============================] - 0s 2ms/step - loss: 2.3478
16/16 [==============================] - 0s 917us/step - loss: 2.3309
16/16 [==============================] - 0s 831us/step - loss: 2.3259
16/16 [==============================] - 0s 819us/step - loss: 2.3248

Testing for epoch 58 index 3:
79/79 [==============================] - 0s 534us/step
16/16 [==============================] - 0s 804us/step - loss: 0.0641
16/16 [==============================] - 0s 2ms/step - loss: 2.2082
16/16 [==============================] - 0s 968us/step - loss: 2.5695
16/16 [==============================] - 0s 869us/step - loss: 2.5436
16/16 [==============================] - 0s 2ms/step - loss: 2.4863
16/16 [==============================] - 0s 2ms/step - loss: 2.4256
16/16 [==============================] - 0s 791us/step - loss: 2.3792
16/16 [==============================] - 0s 1ms/step - loss: 2.3618
16/16 [==============================] - 0s 914us/step - loss: 2.3566
16/16 [==============================] - 0s 796us/step - loss: 2.3554

Testing for epoch 58 index 4:
79/79 [==============================] - 0s 828us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0626
16/16 [==============================] - 0s 2ms/step - loss: 2.1917
16/16 [==============================] - 0s 892us/step - loss: 2.5341
16/16 [==============================] - 0s 808us/step - loss: 2.5009
16/16 [==============================] - 0s 853us/step - loss: 2.4437
16/16 [==============================] - 0s 833us/step - loss: 2.3835
16/16 [==============================] - 0s 803us/step - loss: 2.3382
16/16 [==============================] - 0s 810us/step - loss: 2.3212
16/16 [==============================] - 0s 2ms/step - loss: 2.3161
16/16 [==============================] - 0s 1ms/step - loss: 2.3150

Testing for epoch 58 index 5:
79/79 [==============================] - 0s 966us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0623
16/16 [==============================] - 0s 885us/step - loss: 2.1952
16/16 [==============================] - 0s 2ms/step - loss: 2.5553
16/16 [==============================] - 0s 816us/step - loss: 2.5323
16/16 [==============================] - 0s 785us/step - loss: 2.4776
16/16 [==============================] - 0s 800us/step - loss: 2.4194
16/16 [==============================] - 0s 965us/step - loss: 2.3746
16/16 [==============================] - 0s 2ms/step - loss: 2.3576
16/16 [==============================] - 0s 2ms/step - loss: 2.3524
16/16 [==============================] - 0s 839us/step - loss: 2.3512
Epoch 59 of 60

Testing for epoch 59 index 1:
79/79 [==============================] - 0s 983us/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0624
16/16 [==============================] - 0s 2ms/step - loss: 2.2209
16/16 [==============================] - 0s 2ms/step - loss: 2.5878
16/16 [==============================] - 0s 825us/step - loss: 2.5638
16/16 [==============================] - 0s 2ms/step - loss: 2.5067
16/16 [==============================] - 0s 2ms/step - loss: 2.4469
16/16 [==============================] - 0s 2ms/step - loss: 2.4021
16/16 [==============================] - 0s 2ms/step - loss: 2.3849
16/16 [==============================] - 0s 2ms/step - loss: 2.3796
16/16 [==============================] - 0s 1ms/step - loss: 2.3783

Testing for epoch 59 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0643
16/16 [==============================] - 0s 911us/step - loss: 2.1610
16/16 [==============================] - 0s 2ms/step - loss: 2.5001
16/16 [==============================] - 0s 927us/step - loss: 2.4717
16/16 [==============================] - 0s 2ms/step - loss: 2.4126
16/16 [==============================] - 0s 809us/step - loss: 2.3509
16/16 [==============================] - 0s 2ms/step - loss: 2.3049
16/16 [==============================] - 0s 824us/step - loss: 2.2877
16/16 [==============================] - 0s 2ms/step - loss: 2.2826
16/16 [==============================] - 0s 2ms/step - loss: 2.2814

Testing for epoch 59 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 876us/step - loss: 0.0630
16/16 [==============================] - 0s 2ms/step - loss: 2.1906
16/16 [==============================] - 0s 810us/step - loss: 2.5453
16/16 [==============================] - 0s 785us/step - loss: 2.5202
16/16 [==============================] - 0s 811us/step - loss: 2.4646
16/16 [==============================] - 0s 1ms/step - loss: 2.4054
16/16 [==============================] - 0s 2ms/step - loss: 2.3608
16/16 [==============================] - 0s 2ms/step - loss: 2.3437
16/16 [==============================] - 0s 2ms/step - loss: 2.3383
16/16 [==============================] - 0s 2ms/step - loss: 2.3369

Testing for epoch 59 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0609
16/16 [==============================] - 0s 802us/step - loss: 2.2288
16/16 [==============================] - 0s 813us/step - loss: 2.5893
16/16 [==============================] - 0s 2ms/step - loss: 2.5610
16/16 [==============================] - 0s 2ms/step - loss: 2.5004
16/16 [==============================] - 0s 2ms/step - loss: 2.4371
16/16 [==============================] - 0s 2ms/step - loss: 2.3899
16/16 [==============================] - 0s 857us/step - loss: 2.3722
16/16 [==============================] - 0s 2ms/step - loss: 2.3669
16/16 [==============================] - 0s 2ms/step - loss: 2.3656

Testing for epoch 59 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 824us/step - loss: 0.0613
16/16 [==============================] - 0s 838us/step - loss: 2.2875
16/16 [==============================] - 0s 2ms/step - loss: 2.6576
16/16 [==============================] - 0s 2ms/step - loss: 2.6298
16/16 [==============================] - 0s 2ms/step - loss: 2.5695
16/16 [==============================] - 0s 2ms/step - loss: 2.5058
16/16 [==============================] - 0s 841us/step - loss: 2.4581
16/16 [==============================] - 0s 2ms/step - loss: 2.4401
16/16 [==============================] - 0s 999us/step - loss: 2.4346
16/16 [==============================] - 0s 2ms/step - loss: 2.4333
Epoch 60 of 60

Testing for epoch 60 index 1:
79/79 [==============================] - 0s 2ms/step
16/16 [==============================] - 0s 865us/step - loss: 0.0597
16/16 [==============================] - 0s 845us/step - loss: 2.2392
16/16 [==============================] - 0s 2ms/step - loss: 2.5978
16/16 [==============================] - 0s 2ms/step - loss: 2.5659
16/16 [==============================] - 0s 1ms/step - loss: 2.5047
16/16 [==============================] - 0s 2ms/step - loss: 2.4410
16/16 [==============================] - 0s 2ms/step - loss: 2.3934
16/16 [==============================] - 0s 1ms/step - loss: 2.3755
16/16 [==============================] - 0s 849us/step - loss: 2.3702
16/16 [==============================] - 0s 824us/step - loss: 2.3690

Testing for epoch 60 index 2:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0642
16/16 [==============================] - 0s 855us/step - loss: 2.1887
16/16 [==============================] - 0s 827us/step - loss: 2.5416
16/16 [==============================] - 0s 2ms/step - loss: 2.5131
16/16 [==============================] - 0s 2ms/step - loss: 2.4568
16/16 [==============================] - 0s 1ms/step - loss: 2.3981
16/16 [==============================] - 0s 2ms/step - loss: 2.3537
16/16 [==============================] - 0s 1ms/step - loss: 2.3373
16/16 [==============================] - 0s 2ms/step - loss: 2.3327
16/16 [==============================] - 0s 2ms/step - loss: 2.3317

Testing for epoch 60 index 3:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0631
16/16 [==============================] - 0s 878us/step - loss: 2.2005
16/16 [==============================] - 0s 825us/step - loss: 2.5564
16/16 [==============================] - 0s 2ms/step - loss: 2.5270
16/16 [==============================] - 0s 905us/step - loss: 2.4684
16/16 [==============================] - 0s 804us/step - loss: 2.4070
16/16 [==============================] - 0s 2ms/step - loss: 2.3608
16/16 [==============================] - 0s 845us/step - loss: 2.3434
16/16 [==============================] - 0s 804us/step - loss: 2.3382
16/16 [==============================] - 0s 812us/step - loss: 2.3369

Testing for epoch 60 index 4:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 2ms/step - loss: 0.0611
16/16 [==============================] - 0s 854us/step - loss: 2.1832
16/16 [==============================] - 0s 2ms/step - loss: 2.5365
16/16 [==============================] - 0s 1ms/step - loss: 2.5057
16/16 [==============================] - 0s 2ms/step - loss: 2.4469
16/16 [==============================] - 0s 1ms/step - loss: 2.3865
16/16 [==============================] - 0s 847us/step - loss: 2.3412
16/16 [==============================] - 0s 2ms/step - loss: 2.3242
16/16 [==============================] - 0s 2ms/step - loss: 2.3192
16/16 [==============================] - 0s 856us/step - loss: 2.3180

Testing for epoch 60 index 5:
79/79 [==============================] - 0s 1ms/step
16/16 [==============================] - 0s 1ms/step - loss: 0.0615
16/16 [==============================] - 0s 840us/step - loss: 2.1932
16/16 [==============================] - 0s 2ms/step - loss: 2.5424
16/16 [==============================] - 0s 1ms/step - loss: 2.5080
16/16 [==============================] - 0s 803us/step - loss: 2.4476
16/16 [==============================] - 0s 2ms/step - loss: 2.3862
16/16 [==============================] - 0s 1ms/step - loss: 2.3406
16/16 [==============================] - 0s 1ms/step - loss: 2.3239
16/16 [==============================] - 0s 1ms/step - loss: 2.3190
16/16 [==============================] - 0s 2ms/step - loss: 2.3179
79/79 [==============================] - 0s 1ms/step</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="299">
<pre><code>MO_GAAL(contamination=0.05, k=10, lr_d=0.01, lr_g=0.0001, momentum=0.9,
    stop_epochs=20)</code></pre>
</div>
</div>
<div id="5133c291-8013-4136-b805-7b6fc64f6e42" class="cell" data-execution_count="300">
<div class="sourceCode cell-code" id="cb499"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true" tabindex="-1"></a>outlier_MO_GAAL_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="b5c8a2ce-8c33-4b6f-9699-86d67f05e54a" class="cell" data-execution_count="301">
<div class="sourceCode cell-code" id="cb500"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_MO_GAAL_one)</span>
<span id="cb500-2"><a href="#cb500-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"MO-GAAL (Liu et al., 2019)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-302-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.952
Precision: 0.000
Recall: 0.000
F1 Score: 0.000</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))</code></pre>
</div>
</div>
<div id="ae7d10d7-28c1-48b4-ae86-efe5146601c4" class="cell" data-execution_count="302">
<div class="sourceCode cell-code" id="cb503"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb503-2"><a href="#cb503-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb503-3"><a href="#cb503-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb503-4"><a href="#cb503-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb503-5"><a href="#cb503-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.383
Precision(TP / TP + FP): nan
Recall(TP / TP + FN): 0.000
F1 Score(2*precision*recall/precision+recall): nan</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_3852735/4166638268.py:3: RuntimeWarning: invalid value encountered in long_scalars
  print('Precision(TP / TP + FP): %.3f' % round(_conf.conf_matrix[1][1]/(_conf.conf_matrix[0][1] + _conf.conf_matrix[1][1]),3))
/tmp/ipykernel_3852735/4166638268.py:5: RuntimeWarning: invalid value encountered in long_scalars
  print('F1 Score(2*precision*recall/precision+recall): %.3f' % round((2*(_conf.conf_matrix[1][1]/(_conf.conf_matrix[0][1] + _conf.conf_matrix[1][1]))*(_conf.conf_matrix[1][1]/(_conf.conf_matrix[1][0] + _conf.conf_matrix[1][1]))) / (_conf.conf_matrix[1][1]/(_conf.conf_matrix[0][1] + _conf.conf_matrix[1][1]) + _conf.conf_matrix[1][1]/(_conf.conf_matrix[1][0] + _conf.conf_matrix[1][1])),3))</code></pre>
</div>
</div>
<div id="cf189f3e-4f07-4b65-bcb3-4b8de4b88a5a" class="cell" data-execution_count="303">
<div class="sourceCode cell-code" id="cb506"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>79/79 [==============================] - 0s 1ms/step</code></pre>
</div>
</div>
<div id="e437f684-a449-45ae-a863-e62ce10e3e63" class="cell" data-execution_count="304">
<div class="sourceCode cell-code" id="cb508"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="304">
<pre><code>0.6595030773534759</code></pre>
</div>
</div>
<div id="24b5bf8f-d636-4a64-a464-ed6d3b8e0572" class="cell" data-execution_count="305">
<div class="sourceCode cell-code" id="cb510"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb510-2"><a href="#cb510-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="305">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987215</td>
<td>0.849206</td>
<td>0.891667</td>
<td>0.869919</td>
<td>0.984438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.980823</td>
<td>0.785714</td>
<td>0.825000</td>
<td>0.804878</td>
<td>0.970545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.916500</td>
<td>0.322709</td>
<td>0.675000</td>
<td>0.436658</td>
<td>0.857550</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.978426</td>
<td>0.761905</td>
<td>0.800000</td>
<td>0.780488</td>
<td>0.972398</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.948861</td>
<td>0.468254</td>
<td>0.491667</td>
<td>0.479675</td>
<td>0.833809</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.979225</td>
<td>0.769841</td>
<td>0.808333</td>
<td>0.788618</td>
<td>0.971576</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.972034</td>
<td>0.698413</td>
<td>0.733333</td>
<td>0.715447</td>
<td>0.967954</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.932082</td>
<td>0.301587</td>
<td>0.316667</td>
<td>0.308943</td>
<td>0.859192</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.908909</td>
<td>0.071429</td>
<td>0.075000</td>
<td>0.073171</td>
<td>0.557431</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SO-GAAL (Liu et al., 2019)</td>
<td>0.952058</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.673010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MO-GAAL (Liu et al., 2019)</td>
<td>0.952058</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.659503</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="lscp_bunny" class="level2">
<h2 class="anchored" data-anchor-id="lscp_bunny">LSCP_Bunny</h2>
<div id="83d90734-181d-49fc-95d9-98475bbb34fb" class="cell" data-execution_count="306">
<div class="sourceCode cell-code" id="cb511"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true" tabindex="-1"></a>detectors <span class="op">=</span> [KNN(), LOF(), OCSVM()]</span>
<span id="cb511-2"><a href="#cb511-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LSCP(detectors,contamination<span class="op">=</span><span class="fl">0.05</span>, random_state<span class="op">=</span><span class="dv">77</span>)</span>
<span id="cb511-3"><a href="#cb511-3" aria-hidden="true" tabindex="-1"></a>clf.fit(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/pyod/models/lscp.py:382: UserWarning: The number of histogram bins is greater than the number of classifiers, reducing n_bins to n_clf.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="306">
<pre><code>LSCP(contamination=0.05,
   detector_list=[KNN(algorithm='auto', contamination=0.1, leaf_size=30, method='largest',
  metric='minkowski', metric_params=None, n_jobs=1, n_neighbors=5, p=2,
  radius=1.0), LOF(algorithm='auto', contamination=0.1, leaf_size=30, metric='minkowski',
  metric_params=None, n_jobs=1, n_neighbors=20, novelty=True, p=2), OCSVM(cache_size=200, coef0=0.0, contamination=0.1, degree=3, gamma='auto',
   kernel='rbf', max_iter=-1, nu=0.5, shrinking=True, tol=0.001,
   verbose=False)],
   local_max_features=1.0, local_region_size=30, n_bins=3,
   random_state=RandomState(MT19937) at 0x7FD5E1460D40)</code></pre>
</div>
</div>
<div id="fb422354-3917-45ff-9e70-e7817b28357a" class="cell" data-execution_count="307">
<div class="sourceCode cell-code" id="cb514"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a>outlier_LSCP_one <span class="op">=</span> <span class="bu">list</span>(clf.labels_)</span></code></pre></div>
</div>
<div id="21939827-c0f8-4af9-a332-5c3fea5304d2" class="cell" data-execution_count="308">
<div class="sourceCode cell-code" id="cb515"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a>_conf <span class="op">=</span> Conf_matrx(outlier_true_bunny,outlier_LSCP_one)</span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true" tabindex="-1"></a>_conf.conf(<span class="st">"LSCP (Zhao et al., 2019)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2023-10-20-final_GODE_code_files/figure-html/cell-309-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.982
Precision: 0.802
Recall: 0.842
F1 Score: 0.821</code></pre>
</div>
</div>
<div id="bd654650-dfe6-4cfa-8092-541f1f6a9fa4" class="cell" data-execution_count="309">
<div class="sourceCode cell-code" id="cb517"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb517-2"><a href="#cb517-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy(TP + TN / TP + TN + FP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">3</span>))</span>
<span id="cb517-3"><a href="#cb517-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision(TP / TP + FP): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb517-4"><a href="#cb517-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall(TP / TP + FN): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb517-5"><a href="#cb517-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1 Score(2*precision*recall/precision+recall): </span><span class="sc">%.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">round</span>((<span class="dv">2</span><span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))<span class="op">*</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]))) <span class="op">/</span> (_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]) <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">/</span>(_conf.conf_matrix[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> _conf.conf_matrix[<span class="dv">1</span>][<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy(TP + TN / TP + TN + FP + FN): 2.459
Precision(TP / TP + FP): 0.802
Recall(TP / TP + FN): 0.842
F1 Score(2*precision*recall/precision+recall): 0.821</code></pre>
</div>
</div>
<div id="1d78184d-59f7-41fd-a462-0c4aa367f866" class="cell" data-execution_count="310">
<div class="sourceCode cell-code" id="cb519"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresh <span class="op">=</span> roc_curve(outlier_true_bunny,clf.decision_function(_df[[<span class="st">'x'</span>, <span class="st">'y'</span>,<span class="st">'fnoise'</span>]]))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/pygsp/lib/python3.10/site-packages/scipy/stats/_stats_py.py:4068: PearsonRConstantInputWarning: An input array is constant; the correlation coefficient is not defined.
  warnings.warn(PearsonRConstantInputWarning())</code></pre>
</div>
</div>
<div id="f6c68ca8-ad02-4ac3-bd62-c8da23bec8d5" class="cell" data-execution_count="311">
<div class="sourceCode cell-code" id="cb521"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a>auc(fpr, tpr)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="311">
<pre><code>0.982259756609316</code></pre>
</div>
</div>
<div id="27db7e0a-32f6-4071-93cb-682453eef682" class="cell" data-execution_count="312">
<div class="sourceCode cell-code" id="cb523"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a>tab_bunny <span class="op">=</span> pd.concat([tab_bunny,</span>
<span id="cb523-2"><a href="#cb523-2" aria-hidden="true" tabindex="-1"></a>           pd.DataFrame({<span class="st">"Accuracy"</span>:[_conf.acc],<span class="st">"Precision"</span>:[_conf.pre],<span class="st">"Recall"</span>:[_conf.rec],<span class="st">"F1"</span>:[_conf.f1],<span class="st">"AUC"</span>:[auc(fpr, tpr)]},index <span class="op">=</span> [_conf.name])])<span class="op">;</span>tab_bunny</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="312">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988414</td>
<td>0.864000</td>
<td>0.900000</td>
<td>0.881633</td>
<td>0.996227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943268</td>
<td>0.412698</td>
<td>0.433333</td>
<td>0.422764</td>
<td>0.819111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987215</td>
<td>0.849206</td>
<td>0.891667</td>
<td>0.869919</td>
<td>0.984438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.980823</td>
<td>0.785714</td>
<td>0.825000</td>
<td>0.804878</td>
<td>0.970545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.916500</td>
<td>0.322709</td>
<td>0.675000</td>
<td>0.436658</td>
<td>0.857550</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.978426</td>
<td>0.761905</td>
<td>0.800000</td>
<td>0.780488</td>
<td>0.972398</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.948861</td>
<td>0.468254</td>
<td>0.491667</td>
<td>0.479675</td>
<td>0.833809</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.979225</td>
<td>0.769841</td>
<td>0.808333</td>
<td>0.788618</td>
<td>0.971576</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.972034</td>
<td>0.698413</td>
<td>0.733333</td>
<td>0.715447</td>
<td>0.967954</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.932082</td>
<td>0.301587</td>
<td>0.316667</td>
<td>0.308943</td>
<td>0.859192</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.908909</td>
<td>0.071429</td>
<td>0.075000</td>
<td>0.073171</td>
<td>0.557431</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SO-GAAL (Liu et al., 2019)</td>
<td>0.952058</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.673010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MO-GAAL (Liu et al., 2019)</td>
<td>0.952058</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.659503</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LSCP (Zhao et al., 2019)</td>
<td>0.982421</td>
<td>0.801587</td>
<td>0.841667</td>
<td>0.821138</td>
<td>0.982260</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="tab_bunny" class="level2">
<h2 class="anchored" data-anchor-id="tab_bunny">tab_bunny</h2>
<div id="d5131068-e547-460a-b957-7f2f8b6e2c36" class="cell" data-execution_count="313">
<div class="sourceCode cell-code" id="cb524"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="bu">round</span>(tab_bunny,<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="313">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GODE</td>
<td>0.988</td>
<td>0.864</td>
<td>0.900</td>
<td>0.882</td>
<td>0.996</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LOF (Breunig et al., 2000)</td>
<td>0.943</td>
<td>0.413</td>
<td>0.433</td>
<td>0.423</td>
<td>0.819</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">kNN (Ramaswamy et al., 2000)</td>
<td>0.987</td>
<td>0.849</td>
<td>0.892</td>
<td>0.870</td>
<td>0.984</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CBLOF (He et al., 2003)</td>
<td>0.981</td>
<td>0.786</td>
<td>0.825</td>
<td>0.805</td>
<td>0.971</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCSVM (Sch ̈olkopf et al., 2001)</td>
<td>0.917</td>
<td>0.323</td>
<td>0.675</td>
<td>0.437</td>
<td>0.858</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MCD (Hardin and Rocke, 2004)</td>
<td>0.978</td>
<td>0.762</td>
<td>0.800</td>
<td>0.780</td>
<td>0.972</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Feature Bagging (Lazarevic and Kumar, 2005)</td>
<td>0.949</td>
<td>0.468</td>
<td>0.492</td>
<td>0.480</td>
<td>0.834</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABOD (Kriegel et al., 2008)</td>
<td>0.979</td>
<td>0.770</td>
<td>0.808</td>
<td>0.789</td>
<td>0.972</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Isolation Forest (Liu et al., 2008)</td>
<td>0.972</td>
<td>0.698</td>
<td>0.733</td>
<td>0.715</td>
<td>0.968</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HBOS (Goldstein and Dengel, 2012)</td>
<td>0.932</td>
<td>0.302</td>
<td>0.317</td>
<td>0.309</td>
<td>0.859</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SOS (Janssens et al., 2012)</td>
<td>0.909</td>
<td>0.071</td>
<td>0.075</td>
<td>0.073</td>
<td>0.557</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SO-GAAL (Liu et al., 2019)</td>
<td>0.952</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.673</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MO-GAAL (Liu et al., 2019)</td>
<td>0.952</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.660</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LSCP (Zhao et al., 2019)</td>
<td>0.982</td>
<td>0.802</td>
<td>0.842</td>
<td>0.821</td>
<td>0.982</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="seoyeonc/blog" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>