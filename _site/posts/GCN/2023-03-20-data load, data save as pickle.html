<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="SEOYEON CHOI">
<meta name="dcterms.date" content="2023-03-20">

<title>Seoyeon’s Blog for study - data load, data save as pickle</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Seoyeon’s Blog for study</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../about.html" aria-current="page">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/seoyeonc/blog/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">data load, data save as pickle</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">data load, data save as pickle</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">data</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>SEOYEON CHOI </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 20, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Posts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/GCN/index.html" class="sidebar-item-text sidebar-link">GCN</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-29-STGCN-tutorial.html" class="sidebar-item-text sidebar-link"><strong>[IT-STGCN]</strong> STGCN 튜토리얼</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-20-ESTGCN_GNAR_edit_guebin.html" class="sidebar-item-text sidebar-link">1st ITSTGCN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-20-Algorithm_traintest.html" class="sidebar-item-text sidebar-link">1st ST-GCN Example dividing train and test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-20-ESTGCN_GNAR_edit_guebin2.html" class="sidebar-item-text sidebar-link">2nd ITSTGCN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-18-Algorithm_traintest_2.html" class="sidebar-item-text sidebar-link">2nd ST-GCN Example dividing train and test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-27-AddingtheRecurrentGCNmodels.html" class="sidebar-item-text sidebar-link">Adding the RecurrentGCN models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-26-guebin.html" class="sidebar-item-text sidebar-link">Class of Method</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-21-Class.html" class="sidebar-item-text sidebar-link">Class of Method</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-26-ESTGCN_GNAR_DATA.html" class="sidebar-item-text sidebar-link">Class of Method(GNAR) lag 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-06-ESTGCN_GNAR_DATA_3.html" class="sidebar-item-text sidebar-link">Class of Method(GNAR) lag 1 80% Missing repeat</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-06-ESTGCN_GNAR_DATA_2.html" class="sidebar-item-text sidebar-link">Class of Method(GNAR) lag 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-07-ESTGCN_WIKI_DATA_2.html" class="sidebar-item-text sidebar-link">Class of Method(WikiMath) lag 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-26-ESTGCN_WIKI_DATA.html" class="sidebar-item-text sidebar-link">Class of Method(WikiMath) lag 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-20-data load, data save as pickle.html" class="sidebar-item-text sidebar-link active">data load, data save as pickle</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-20-EbayesThresh toy ex.html" class="sidebar-item-text sidebar-link">EbayesThresh Toy ex</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-11-Algorithm_EX_1.html" class="sidebar-item-text sidebar-link">GCN Algorithm Example 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-17-GCONVGRU_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">GConvGRU_Simulation Tables_reshape</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-05-GNAR.html" class="sidebar-item-text sidebar-link">GNAR data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-13-Other Method (SEOYEON CHOI's conflicted copy 2023-05-27).html" class="sidebar-item-text sidebar-link">ITSTGCN add Model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-13-Other Method.html" class="sidebar-item-text sidebar-link">ITSTGCN add Model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-06-article_refer.html" class="sidebar-item-text sidebar-link">ITSTGCN Article Refernece</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-05-ITSTGCN_LOADER.html" class="sidebar-item-text sidebar-link">ITSTGCN LOADERS Version</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-17-ITSTGCN-Tutorial.html" class="sidebar-item-text sidebar-link">ITSTGCN-Tutorial</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-06-METRLADatasetLoader.html" class="sidebar-item-text sidebar-link">METRLADatasetLoader-Tutorial</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-25-note_matrix.html" class="sidebar-item-text sidebar-link">Note_weight amatrix</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-29-pedalme_GSO_st.html" class="sidebar-item-text sidebar-link">Padalme GSO_st</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-11-CPUvsGPU.html" class="sidebar-item-text sidebar-link">PyG Geometric Temporal CPU vs GPU</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-11-PyGGeometricTemporalEx.html" class="sidebar-item-text sidebar-link">PyG Geometric Temporal Examples</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-21-ST-GCN_Dataset.html" class="sidebar-item-text sidebar-link">PyTorch ST-GCN Dataset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-04-questions of pytorch geometric temporal.html" class="sidebar-item-text sidebar-link">Questions of PyTorch Geometric Temporal</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-18-Self Consistency toy ex.html" class="sidebar-item-text sidebar-link">Self Consistency Toy ex</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-18-SimulationPlanner-Tutorial.html" class="sidebar-item-text sidebar-link">SimualtionPlanner-Tutorial</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-22-SimulationPlanner-Tutorial_test_test.html" class="sidebar-item-text sidebar-link">SimualtionPlanner-Tutorial</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-05-Simulation_boxplot.html" class="sidebar-item-text sidebar-link">Simulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-05-Simulation.html" class="sidebar-item-text sidebar-link">Simulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-28-gcn_simulation.html" class="sidebar-item-text sidebar-link">Simulation of geometric-temporal</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-27-simulation_table.html" class="sidebar-item-text sidebar-link">Simulation Tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-17-itstgcntry)fail_version__Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">Simulation_reshape</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-25-GCONVGRU_snd_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">Simulation_reshape</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-03-ESTGCN_GNAR_edit_guebin2_seoyeon.html" class="sidebar-item-text sidebar-link">SY 1st ITSTGCN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-07-torchgcn.html" class="sidebar-item-text sidebar-link">TORCH_GEOMETRIC.NN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-27-toy_example_figure.html" class="sidebar-item-text sidebar-link">Toy Example Figure(Intro)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-27-toy_example_notes.html" class="sidebar-item-text sidebar-link">Toy Example Note</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/Untitled.html" class="sidebar-item-text sidebar-link">Untitled</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/GODE/index.html" class="sidebar-item-text sidebar-link">GODE</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-11-19-class_code_for_paper.html" class="sidebar-item-text sidebar-link">Class code for Comparison Study</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-12-27-DFT_study.html" class="sidebar-item-text sidebar-link">Discrete Fourier Transform</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-10-02-Earthquake_real.html" class="sidebar-item-text sidebar-link">Earthquake</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-12-01-graph_code_guebin.html" class="sidebar-item-text sidebar-link">Graph code</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-09-02-paper_simulation.html" class="sidebar-item-text sidebar-link">Simulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/Untitled.html" class="sidebar-item-text sidebar-link">Untitled</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/Quarto_tip/index.html" class="sidebar-item-text sidebar-link">Quarto tip</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Quarto_tip/2023-01-02-quarto_tips.html" class="sidebar-item-text sidebar-link">quarto blog tips</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/Study/index.html" class="sidebar-item-text sidebar-link">Study</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-02-05-ch12_2_3_Power Spectral Density and its Estimators.html" class="sidebar-item-text sidebar-link">Chap 12.2 ~ 3: Power Spectral Density and its Estimators</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-02-02-ch12.2_Weakly Stationary Graph Processes.html" class="sidebar-item-text sidebar-link">Chap 12.2: Weakly Stationary Graph Processes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-02-01-ch8_DFT.html" class="sidebar-item-text sidebar-link">Chap 8.3: Discrete Fourier Transform</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-05-10-EbayesThreshold.html" class="sidebar-item-text sidebar-link">EbayesThresh: R Programs for Empirical Bayes Thresholding, Review</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-10-GCRN_riview.html" class="sidebar-item-text sidebar-link">GCRN Review</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-05-21-Graph Attention Networks (GATs).html" class="sidebar-item-text sidebar-link">Graph Attention Networks (GATs)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2022-03-28-(4주차) 3월28일.html" class="sidebar-item-text sidebar-link">Introduction to Python 4wk</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2022-04-03-(5주차) 4월2일.html" class="sidebar-item-text sidebar-link">Introduction to Python 5wk</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-08-wrting_down_algorithm.html" class="sidebar-item-text sidebar-link">ITSTGCN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-23-lebesque_decompposition_therem.html" class="sidebar-item-text sidebar-link">Lebesgue’s decomposition theorem</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-04-nomalized graph laplacian.html" class="sidebar-item-text sidebar-link">Nomalized Graph Laplacian</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-05-20-RGNN_pyg_official.html" class="sidebar-item-text sidebar-link">Recurrent Graph Neural Network</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-12-.html" class="sidebar-item-text sidebar-link">Self-onsistent estimator</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-10-STGCN_Existing_Method_Review.html" class="sidebar-item-text sidebar-link">STGCN Existing Method Review</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-03-16-stgcn_paper_review_1.html" class="sidebar-item-text sidebar-link">STGCN papers review</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2022-12-31-Space-study.html" class="sidebar-item-text sidebar-link">Study for Spaces</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import" id="toc-import" class="nav-link active" data-scroll-target="#import">Import</a>
  <ul class="collapse">
  <li><a href="#chickenpoxdatasetloader" id="toc-chickenpoxdatasetloader" class="nav-link" data-scroll-target="#chickenpoxdatasetloader">ChickenpoxDatasetLoader</a></li>
  <li><a href="#pedalmedatasetloader" id="toc-pedalmedatasetloader" class="nav-link" data-scroll-target="#pedalmedatasetloader">PedalMeDatasetLoader</a></li>
  <li><a href="#wikimathsdatasetloader" id="toc-wikimathsdatasetloader" class="nav-link" data-scroll-target="#wikimathsdatasetloader">WikiMathsDatasetLoader</a></li>
  <li><a href="#windmilloutputlargedatasetloader" id="toc-windmilloutputlargedatasetloader" class="nav-link" data-scroll-target="#windmilloutputlargedatasetloader">WindmillOutputLargeDatasetLoader</a></li>
  <li><a href="#windmilloutputmediumdatasetloader" id="toc-windmilloutputmediumdatasetloader" class="nav-link" data-scroll-target="#windmilloutputmediumdatasetloader">WindmillOutputMediumDatasetLoader</a></li>
  <li><a href="#windmilloutputsmalldatasetloader" id="toc-windmilloutputsmalldatasetloader" class="nav-link" data-scroll-target="#windmilloutputsmalldatasetloader">WindmillOutputSmallDatasetLoader</a></li>
  </ul></li>
  <li><a href="#windmill-비교" id="toc-windmill-비교" class="nav-link" data-scroll-target="#windmill-비교">Windmill 비교</a>
  <ul class="collapse">
  <li><a href="#metrladatasetloader_real-world-traffic-dataset" id="toc-metrladatasetloader_real-world-traffic-dataset" class="nav-link" data-scroll-target="#metrladatasetloader_real-world-traffic-dataset">METRLADatasetLoader_real world traffic dataset</a></li>
  <li><a href="#pemsbaydatasetloader" id="toc-pemsbaydatasetloader" class="nav-link" data-scroll-target="#pemsbaydatasetloader">PemsBayDatasetLoader</a></li>
  <li><a href="#englandcoviddatasetloader" id="toc-englandcoviddatasetloader" class="nav-link" data-scroll-target="#englandcoviddatasetloader">EnglandCovidDatasetLoader</a></li>
  <li><a href="#montevideobusdatasetloader" id="toc-montevideobusdatasetloader" class="nav-link" data-scroll-target="#montevideobusdatasetloader">MontevideoBusDatasetLoader</a></li>
  <li><a href="#twittertennisdatasetloader" id="toc-twittertennisdatasetloader" class="nav-link" data-scroll-target="#twittertennisdatasetloader">TwitterTennisDatasetLoader</a></li>
  <li><a href="#mtmdatasetloader" id="toc-mtmdatasetloader" class="nav-link" data-scroll-target="#mtmdatasetloader">MTMDatasetLoader</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<blockquote class="blockquote">
<p>data load, data save as pickle</p>
</blockquote>
<p>https://pytorch-geometric-temporal.readthedocs.io/en/latest/_modules/index.html</p>
<ul>
<li>GNAR warning message 위한 uppressWarnings</li>
</ul>
<p>1st</p>
<ul>
<li><code>ChickenpoxDatasetLoader</code>
<ul>
<li>get_dataset(self, lags: int = 4) -&gt; StaticGraphTemporalSignal:</li>
</ul></li>
<li><code>PedalMeDatasetLoader</code>
<ul>
<li>get_dataset(self, lags: int = 4) -&gt; StaticGraphTemporalSignal:</li>
</ul></li>
<li><code>WikiMathsDatasetLoader</code>
<ul>
<li>get_dataset(self, lags: int = 8) -&gt; StaticGraphTemporalSignal:</li>
</ul></li>
<li><code>WindmillOutputLargeDatasetLoader</code>, <code>WindmillOutputMediumDatasetLoader</code>, <code>WindmillOutputSmallDatasetLoader</code>
<ul>
<li>get_dataset(self, lags: int = 8) -&gt; StaticGraphTemporalSignal:</li>
</ul></li>
<li><code>MontevideoBusDatasetLoader</code>
<ul>
<li>get_dataset(self, lags: int = 4, target_var: str = “y”, feature_vars: List[str] = [“y”]) -&gt; StaticGraphTemporalSignal:</li>
</ul></li>
<li>dataset = StaticGraphTemporalSignal(self._edges, self._edge_weights, self.features, self.targets)</li>
</ul>
<p>2nd</p>
<ul>
<li><code>EnglandCovidDatasetLoader</code>
<ul>
<li>get_dataset(self, lags: int = 8) -&gt; DynamicGraphTemporalSignal:</li>
<li>dataset = DynamicGraphTemporalSignal(self._edges, self._edge_weights, self.features, self.targets)</li>
</ul></li>
</ul>
<p>3rd</p>
<ul>
<li><code>METRLADatasetLoader</code>
<ul>
<li>get_dataset(self, num_timesteps_in: int = 12, num_timesteps_out: int = 12) -&gt; StaticGraphTemporalSignal:</li>
</ul></li>
<li><code>PemsBayDatasetLoader</code>
<ul>
<li>get_dataset(self, num_timesteps_in: int = 12, num_timesteps_out: int = 12) -&gt; StaticGraphTemporalSignal:</li>
</ul></li>
<li>dataset = StaticGraphTemporalSignal(self.edges, self.edge_weights, self.features, self.targets)</li>
</ul>
<p>4rd</p>
<ul>
<li><code>MTMDatasetLoader</code>
<ul>
<li>get_dataset(self, frames: int = 16) -&gt; StaticGraphTemporalSignal:</li>
<li>dataset = StaticGraphTemporalSignal(=self._edges, self._edge_weights, self.features, self.targets)</li>
</ul></li>
</ul>
<p>5th - <code>TwitterTennisDatasetLoader</code>(원핫 인코딩 함수도 별도로 있음) - get_dataset(self) -&gt; DynamicGraphTemporalSignal: - dataset = DynamicGraphTemporalSignal(self.edges, self.edge_weights, self.features, self.target</p>
<section id="import" class="level1">
<h1>Import</h1>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span></code></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> urllib</span></code></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span></code></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_data(fname):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(fname, <span class="st">'rb'</span>) <span class="im">as</span> outfile:</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        data_dict <span class="op">=</span> pickle.load(outfile)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data_dict</span></code></pre></div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> save_data(data_dict,fname):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(fname,<span class="st">'wb'</span>) <span class="im">as</span> outfile:</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        pickle.dump(data_dict,outfile)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn.functional <span class="im">as</span> F</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.nn.recurrent <span class="im">import</span> GConvGRU</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RecurrentGCN(torch.nn.Module):</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, node_features, filters):</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(RecurrentGCN, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.recurrent <span class="op">=</span> GConvGRU(node_features, filters, <span class="dv">2</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.linear <span class="op">=</span> torch.nn.Linear(filters, <span class="dv">1</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x, edge_index, edge_weight):</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        h <span class="op">=</span> <span class="va">self</span>.recurrent(x, edge_index, edge_weight)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        h <span class="op">=</span> F.relu(h)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        h <span class="op">=</span> <span class="va">self</span>.linear(h)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> h</span></code></pre></div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>save_data(df_gnar, <span class="st">'./data/EnglandCovid_gnar_randomly_by_rate.pkl'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>load_data(<span class="st">'./data/GNAR_stgcn_randomly_by_rate.pkl'</span>)</span></code></pre></div>
</div>
<pre><code>!git add .
!git commit -m .
!git push 
!quarto publish --no-browser --no-prompt </code></pre>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>_data <span class="op">=</span> load_data(<span class="st">'./_data/fivenodes.pkl'</span>)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span></code></pre></div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>_edges <span class="op">=</span> torch.tensor(_data[<span class="st">'edges'</span>]).nonzero().tolist()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>_FX <span class="op">=</span> _data[<span class="st">'f'</span>].tolist()</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>_node_ids <span class="op">=</span> {<span class="st">'node1'</span>:<span class="dv">0</span>, <span class="st">'node2'</span>:<span class="dv">1</span>, <span class="st">'node3'</span>:<span class="dv">2</span>, <span class="st">'node4'</span>:<span class="dv">3</span>, <span class="st">'node5'</span>:<span class="dv">4</span>} </span></code></pre></div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_dict <span class="op">=</span> {<span class="st">'edges'</span>:_edges, <span class="st">'node_ids'</span>:_node_ids, <span class="st">'FX'</span>:_FX}</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#data_dict = itstgcn.load_data('./data/fivenodes.pkl')</span></span></code></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_dict[<span class="st">'edges'</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>[[0, 3],
 [0, 4],
 [1, 2],
 [1, 3],
 [2, 1],
 [2, 3],
 [3, 0],
 [3, 1],
 [3, 2],
 [4, 0]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>np.array(data_dict[<span class="st">'edges'</span>]).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>(10, 2)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data_dict[<span class="st">'node_ids'</span>] <span class="co"># node 수</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>{'node1': 0, 'node2': 1, 'node3': 2, 'node4': 3, 'node5': 4}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>np.array(data_dict[<span class="st">'FX'</span>]).shape <span class="co"># time by node</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>(200, 5)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>save_data(data_dict, <span class="st">'./data/fivenodes.pkl'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>load_data(<span class="st">'./data/GNAR_stgcn_randomly_by_rate.pkl'</span>)</span></code></pre></div>
</div>
<section id="chickenpoxdatasetloader" class="level2">
<h2 class="anchored" data-anchor-id="chickenpoxdatasetloader">ChickenpoxDatasetLoader</h2>
<p>Chickenpox Hungary</p>
<ul>
<li>A dataset of county level chicken pox cases in Hungary between 2004 and 2014. We made it public during the development of PyTorch Geometric Temporal. The underlying graph is static - vertices are counties and edges are neighbourhoods. Vertex features are lagged weekly counts of the chickenpox cases (we included 4 lags). The target is the weekly number of cases for the upcoming week (signed integers). Our dataset consist of more than 500 snapshots (weeks).</li>
<li>2004년부터 2014년 사이 헝가리의 지역별 수두증 발생 데이터셋</li>
<li>그래프는 정적</li>
<li>node 지역</li>
<li>edge 이웃 관계</li>
<li>node 특성은 수두증 발생의 지연된 주간 횟수(4주의 지연이 포함되어 있음)</li>
<li>target는 다음 주에 대한 주간 사례 수</li>
<li>500개 이상의 스냅샷(주간)</li>
</ul>
<p>데이터정리</p>
<ul>
<li>T = 519</li>
<li>N = 20 # number of nodes</li>
<li>E = 102 # edges</li>
<li><span class="math inline">\(f(v,t)\)</span>의 차원? (1,)</li>
<li>시간에 따라서 Number of nodes가 변하는지? False</li>
<li>시간에 따라서 Number of nodes가 변하는지? False</li>
<li>X: (20,4) (N,4), <span class="math inline">\(f(v,t_0),f(v,t_1),f(v,t_2),f(v,t_3)\)</span></li>
<li>y: (20,) (N,), <span class="math inline">\(f(v,t_4)\)</span></li>
<li>예제코드적용가능여부: Yes</li>
</ul>
<p><code>-</code> Nodes : <code>20</code></p>
<ul>
<li>vertices are counties</li>
</ul>
<p><code>-</code>Edges : <code>102</code></p>
<ul>
<li>edges are neighbourhoods</li>
</ul>
<p><code>-</code> Time : <code>517</code></p>
<ul>
<li>between 2004 and 2014</li>
<li>per weeks</li>
</ul>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.dataset <span class="im">import</span> ChickenpoxDatasetLoader</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>loader1 <span class="op">=</span> ChickenpoxDatasetLoader()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> loader1.get_dataset()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>np.array(a.features).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>(517, 20, 4)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_index).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>(2, 102)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_weight).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>(102,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="1050">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>a.edge_weight</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1050">
<pre><code>array([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
       1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
       1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
       1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
       1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
       1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="1051">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>a.edge_index</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1051">
<pre><code>array([[ 0,  0,  0,  0,  0,  0,  0,  1,  1,  1,  1,  2,  2,  2,  2,  3,
         3,  3,  3,  3,  3,  4,  4,  5,  5,  5,  5,  6,  6,  6,  6,  6,
         6,  6,  7,  7,  7,  7,  8,  8,  8,  8,  8,  9,  9,  9,  9,  9,
        10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 12, 12, 12,
        12, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 15,
        15, 15, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 18,
        18, 18, 19, 19, 19, 19],
       [10,  6, 13,  1,  0,  5, 16,  0, 16,  1, 14, 10,  8,  2,  5,  8,
        15, 12,  9, 10,  3,  4, 13,  0, 10,  2,  5,  0, 16,  6, 14, 13,
        11, 18,  7, 17, 11, 18,  3,  2, 15,  8, 10,  9, 13,  3, 12, 10,
         5,  9,  8,  3, 10,  2, 13,  0,  6, 11,  7, 13, 18,  3,  9, 13,
        12, 13,  9,  6,  4, 12,  0, 11, 10, 18, 19,  1, 14,  6, 16,  3,
        15,  8, 16, 14,  1,  0,  6,  7, 19, 17, 18, 14, 18, 17,  7,  6,
        19, 11, 18, 14, 19, 17]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="1053">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.Graph()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="1054">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>G.add_edges_from(a.edge_index.T)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="1055">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>nx.draw(G,with_labels<span class="op">=</span><span class="va">True</span>,font_weight<span class="op">=</span><span class="st">'bold'</span>,node_color<span class="op">=</span><span class="st">'green'</span>,node_size<span class="op">=</span><span class="dv">350</span>,font_color<span class="op">=</span><span class="st">'white'</span>,width<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-31-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="1056">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>node_list <span class="op">=</span> []</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">20</span>):</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    node_list.append(i)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="1057">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">20</span>,<span class="dv">1</span>,figsize<span class="op">=</span>(<span class="dv">30</span>,<span class="dv">70</span>))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">20</span>):</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader1.targets).reshape(<span class="dv">20</span>,<span class="op">-</span><span class="dv">1</span>)[k][:],alpha<span class="op">=</span><span class="dv">1</span>,label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[k]))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-33-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="pedalmedatasetloader" class="level2">
<h2 class="anchored" data-anchor-id="pedalmedatasetloader">PedalMeDatasetLoader</h2>
<p>Pedal Me Deliveries</p>
<ul>
<li>A dataset of PedalMe Bicycle deliver orders in London between 2020 and 2021. We made it public during the development of PyTorch Geometric Temporal. The underlying graph is static - vertices are localities and edges are spatial_connections. Vertex features are lagged weekly counts of the delivery demands (we included 4 lags). The target is the weekly number of deliveries the upcoming week. Our dataset consist of more than 30 snapshots (weeks)</li>
<li>2020년과 2021년 사이 런던에서 PedalMe 자전거 배송 주문 데이터셋</li>
<li>그래프는 정적</li>
<li>node 장소</li>
<li>edge 공간 연결</li>
<li>node 특성은 배송 수요의 지연된 주간 횟수(4주의 지연이 포함되어 있음)</li>
<li>target 다음 주에 대한 주간 배송 횟수</li>
<li>30개 이상의 스냅샷(주간)</li>
</ul>
<p>데이터정리</p>
<ul>
<li>T = 31</li>
<li>V = 지역의 집합</li>
<li>N = 15 # number of nodes</li>
<li>E = 225 # edges</li>
<li><span class="math inline">\(f(v,t)\)</span>의 차원? (1,) # number of deliveries</li>
<li>시간에 따라서 N이 변하는지? False</li>
<li>시간에 따라서 E가 변하는지? False</li>
<li>X: (15,4) (N,4), <span class="math inline">\(f(v,t_0),f(v,t_1),f(v,t_2),f(v,t_3)\)</span></li>
<li>y: (15,) (N,), <span class="math inline">\(f(v,t_4)\)</span></li>
<li>예제코드적용가능여부: Yes</li>
</ul>
<p><code>-</code> Nodes : <code>15</code></p>
<ul>
<li>vertices are localities</li>
</ul>
<p><code>-</code>Edges : <code>225</code></p>
<ul>
<li>edges are spatial_connections</li>
</ul>
<p><code>-</code> Time : <code>31</code></p>
<ul>
<li>between 2020 and 2021</li>
<li>per weeks</li>
</ul>
<div class="cell" data-execution_count="313">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.dataset <span class="im">import</span> PedalMeDatasetLoader</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>loader2 <span class="op">=</span> PedalMeDatasetLoader()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="906">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> loader2.get_dataset()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="907">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>np.array(a.features).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="907">
<pre><code>(31, 15, 4)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="908">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_index).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="908">
<pre><code>(2, 225)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="909">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_weight).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="909">
<pre><code>(225,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="910">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.Graph()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="911">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>G.add_edges_from(a.edge_index.T)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="912">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>nx.draw(G,with_labels<span class="op">=</span><span class="va">True</span>,font_weight<span class="op">=</span><span class="st">'bold'</span>,node_color<span class="op">=</span><span class="st">'green'</span>,node_size<span class="op">=</span><span class="dv">350</span>,font_color<span class="op">=</span><span class="st">'white'</span>,width<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-41-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="718">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>node_list <span class="op">=</span> []</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">15</span>):</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    node_list.append(i)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="719">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">15</span>,<span class="dv">1</span>,figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">50</span>))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">15</span>):</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader2.targets).reshape(<span class="dv">15</span>,<span class="op">-</span><span class="dv">1</span>)[k][:],label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[k]))</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-43-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="wikimathsdatasetloader" class="level2">
<h2 class="anchored" data-anchor-id="wikimathsdatasetloader">WikiMathsDatasetLoader</h2>
<p>Wikipedia Math</p>
<ul>
<li>A dataset of vital mathematics articles from Wikipedia. We made it public during the development of PyTorch Geometric Temporal. The underlying graph is static - vertices are Wikipedia pages and edges are links between them. The graph is directed and weighted. Weights represent the number of links found at the source Wikipedia page linking to the target Wikipedia page. The target is the daily user visits to the Wikipedia pages between March 16th 2019 and March 15th 2021 which results in 731 periods.</li>
<li>위키피디아에서 중요한 수학 기사들로 이루어진 데이터셋</li>
<li>그래프는 정적</li>
<li>node 위키피디아 페이지</li>
<li>edge 페이지 간의 링크</li>
<li>그래프는 방향성이 있으며 가중치가 있음</li>
<li>가중치는 소스 위키피디아 페이지에서 대상 위키피디아 페이지로 연결된 링크 수</li>
<li>target 2019년 3월 16일부터 2021년 3월 15일까지 위키피디아 페이지의 일일 사용자 방문 수</li>
<li>기간은 731개의 기간으로 구성됩니다.</li>
</ul>
<p>데이터정리</p>
<ul>
<li>T = 723</li>
<li>V = 위키피디아 페이지</li>
<li>N = 1068 # number of nodes</li>
<li>E = 27079 # edges</li>
<li><span class="math inline">\(f(v,t)\)</span>의 차원? (1,) # 해당페이지를 유저가 방문한 횟수</li>
<li>시간에 따라서 N이 변하는지? False</li>
<li>시간에 따라서 E가 변하는지? False</li>
<li>X: (1068,8) (N,8), <span class="math inline">\(f(v,t_0),f(v,t_1),f(v,t_2),f(v,t_3),f(v,t_4),f(v,t_5),f(v,t_6),f(v,t_7)\)</span></li>
<li>y: (1068,) (N,), <span class="math inline">\(f(v,t_8)\)</span></li>
<li>예제코드적용가능여부: Yes</li>
</ul>
<p><code>-</code> Nodes : <code>1068</code></p>
<ul>
<li>vertices are Wikipedia pages</li>
</ul>
<p><code>-</code>Edges : <code>27079</code></p>
<ul>
<li>edges are links between them</li>
</ul>
<p><code>-</code> Time : <code>723</code></p>
<ul>
<li>Wikipedia pages between March 16th 2019 and March 15th 2021</li>
<li>per weeks</li>
</ul>
<div class="cell" data-execution_count="1014">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.dataset <span class="im">import</span> WikiMathsDatasetLoader</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>loader3 <span class="op">=</span> WikiMathsDatasetLoader()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="1015">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> loader3.get_dataset()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="1016">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>np.array(a.features).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1016">
<pre><code>(723, 1068, 8)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="1017">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_index).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1017">
<pre><code>(2, 27079)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="1018">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_weight).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1018">
<pre><code>(27079,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="1019">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.Graph()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="1020">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>G.add_edges_from(a.edge_index.T)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="1021">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>nx.draw(G,with_labels<span class="op">=</span><span class="va">True</span>,font_weight<span class="op">=</span><span class="st">'bold'</span>,node_color<span class="op">=</span><span class="st">'green'</span>,node_size<span class="op">=</span><span class="dv">350</span>,font_color<span class="op">=</span><span class="st">'white'</span>,width<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-51-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="1022">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>node_list <span class="op">=</span> []</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">1068</span>):</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    node_list.append(i)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="1026">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">20</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">70</span>))</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">1068</span>), <span class="dv">20</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, idx <span class="kw">in</span> <span class="bu">enumerate</span>(indices):</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader3.targets).reshape(<span class="dv">1068</span>,<span class="op">-</span><span class="dv">1</span>)[idx][:], label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[idx]))</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-53-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="windmilloutputlargedatasetloader" class="level2">
<h2 class="anchored" data-anchor-id="windmilloutputlargedatasetloader">WindmillOutputLargeDatasetLoader</h2>
<ul>
<li>Hourly energy output of windmills from a European country for more than 2 years. Vertices represent 319 windmills and weighted edges describe the strength of relationships. The target variable allows for regression tasks</li>
<li>유럽 국가의 풍력 발전소에서 2년 이상에 걸쳐 발생한 시간별 에너지 출력 데이터</li>
<li>node 319개의 풍력 발전소</li>
<li>가중치가 있는 edge는 관계의 강도</li>
<li>회귀 분석 작업에 적합한 목표 변수를 제공</li>
</ul>
<p>데이터정리</p>
<ul>
<li>T = 17464</li>
<li>V = 풍력발전소</li>
<li>N = 319 # number of nodes</li>
<li>E = 101761 = N^2 # edges</li>
<li><span class="math inline">\(f(v,t)\)</span>의 차원? (1,) # Hourly energy output</li>
<li>시간에 따라서 N이 변하는지? False</li>
<li>시간에 따라서 E가 변하는지? False</li>
<li>X: (319,4) (N,4), <span class="math inline">\(f(v,t_0),f(v,t_1),f(v,t_2),f(v,t_3)\)</span></li>
<li>y: (319,) (N,), <span class="math inline">\(f(v,t_4)\)</span></li>
<li>예제코드적용가능여부: Yes</li>
</ul>
<p><code>-</code> Nodes : <code>319</code></p>
<ul>
<li>vertices represent 319 windmills</li>
</ul>
<p><code>-</code>Edges : <code>101761</code></p>
<ul>
<li>weighted edges describe the strength of relationships.</li>
</ul>
<p><code>-</code> Time : <code>17464</code></p>
<ul>
<li>more than 2 years</li>
</ul>
<div class="cell" data-execution_count="961">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.dataset <span class="im">import</span> WindmillOutputLargeDatasetLoader</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>loader4 <span class="op">=</span> WindmillOutputLargeDatasetLoader()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="962">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> loader4.get_dataset()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="963">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>np.array(a.features).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="963">
<pre><code>(17464, 319, 8)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="964">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_index).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="964">
<pre><code>(2, 101761)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="965">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_weight).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="965">
<pre><code>(101761,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="966">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.Graph()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="967">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>G.add_edges_from(a.edge_index.T)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="968">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>nx.draw(G,with_labels<span class="op">=</span><span class="va">True</span>,font_weight<span class="op">=</span><span class="st">'bold'</span>,node_color<span class="op">=</span><span class="st">'green'</span>,node_size<span class="op">=</span><span class="dv">350</span>,font_color<span class="op">=</span><span class="st">'white'</span>,width<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-61-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="990">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span> np.arange(<span class="dv">1</span>,<span class="dv">100</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="990">
<pre><code>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
       35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51,
       52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68,
       69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85,
       86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="991">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>a[::<span class="dv">10</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="991">
<pre><code>array([ 1, 11, 21, 31, 41, 51, 61, 71, 81, 91])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="997">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>np.array(loader4.targets).reshape(<span class="dv">319</span>,<span class="op">-</span><span class="dv">1</span>)[idx][::<span class="dv">100</span>].shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="997">
<pre><code>(175,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="969">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>node_list <span class="op">=</span> []</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">319</span>):</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    node_list.append(i)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="1006">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">20</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">50</span>))</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">319</span>), <span class="dv">20</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, idx <span class="kw">in</span> <span class="bu">enumerate</span>(indices):</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader4.targets).reshape(<span class="dv">319</span>,<span class="op">-</span><span class="dv">1</span>)[idx][:<span class="dv">1000</span>], label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[idx]))</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-66-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="783">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">20</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">50</span>))</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">319</span>), <span class="dv">20</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, idx <span class="kw">in</span> <span class="bu">enumerate</span>(indices):</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader4.targets).reshape(<span class="dv">319</span>,<span class="op">-</span><span class="dv">1</span>)[idx][:], label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[idx]))</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-67-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="windmilloutputmediumdatasetloader" class="level2">
<h2 class="anchored" data-anchor-id="windmilloutputmediumdatasetloader">WindmillOutputMediumDatasetLoader</h2>
<ul>
<li>Hourly energy output of windmills from a European country for more than 2 years. Vertices represent 26 windmills and weighted edges describe the strength of relationships. The target variable allows for regression tasks.</li>
<li>유럽 국가의 풍력 발전소에서 2년 이상에 걸쳐 발생한 시간별 에너지 출력 데이터셋</li>
<li>node 26개의 풍력 발전소</li>
<li>가중치가 있는 edge는 관계의 강도</li>
<li>회귀 분석 작업에 적합한 목표 변수를 제공</li>
</ul>
<p>데이터정리</p>
<ul>
<li>T = 17464</li>
<li>V = 풍력발전소</li>
<li>N = 26 # number of nodes</li>
<li>E = 676 = N^2 # edges</li>
<li><span class="math inline">\(f(v,t)\)</span>의 차원? (1,) # Hourly energy output</li>
<li>시간에 따라서 N이 변하는지? False</li>
<li>시간에 따라서 E가 변하는지? False</li>
<li>X: (26,4) (N,8), <span class="math inline">\(f(v,t_0),f(v,t_1),f(v,t_2),f(v,t_3)\)</span></li>
<li>y: (26,) (N,), <span class="math inline">\(f(v,t_4)\)</span></li>
<li>예제코드적용가능여부: Yes</li>
</ul>
<p><code>-</code> Nodes : <code>26</code></p>
<ul>
<li>vertices represent 26 windmills</li>
</ul>
<p><code>-</code>Edges : <code>676</code></p>
<ul>
<li>weighted edges describe the strength of relationships</li>
</ul>
<p><code>-</code> Time : <code>17464</code></p>
<ul>
<li>more than 2 years</li>
</ul>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.dataset <span class="im">import</span> WindmillOutputMediumDatasetLoader</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>loader5 <span class="op">=</span> WindmillOutputMediumDatasetLoader()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> loader5.get_dataset()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>np.array(a.features).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>(17464, 26, 8)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_index).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>(2, 676)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_weight).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(676,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.Graph()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>G.add_edges_from(a.edge_index.T)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>nx.draw(G,with_labels<span class="op">=</span><span class="va">True</span>,font_weight<span class="op">=</span><span class="st">'bold'</span>,node_color<span class="op">=</span><span class="st">'green'</span>,node_size<span class="op">=</span><span class="dv">350</span>,font_color<span class="op">=</span><span class="st">'white'</span>,width<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-75-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>node_list <span class="op">=</span> []</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">26</span>):</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    node_list.append(i)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">26</span>,<span class="dv">1</span>,figsize<span class="op">=</span>(<span class="dv">30</span>,<span class="dv">70</span>))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">26</span>):</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader5.targets).reshape(<span class="dv">26</span>,<span class="op">-</span><span class="dv">1</span>)[k],label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[k]))</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-77-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="1013">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">26</span>,<span class="dv">1</span>,figsize<span class="op">=</span>(<span class="dv">30</span>,<span class="dv">70</span>))</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">26</span>):</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader5.targets).reshape(<span class="dv">26</span>,<span class="op">-</span><span class="dv">1</span>)[k][:<span class="dv">1000</span>],label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[k]))</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-78-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="windmilloutputsmalldatasetloader" class="level2">
<h2 class="anchored" data-anchor-id="windmilloutputsmalldatasetloader">WindmillOutputSmallDatasetLoader</h2>
<ul>
<li>Hourly energy output of windmills from a European country for more than 2 years. Vertices represent 11 windmills and weighted edges describe the strength of relationships. The target variable allows for regression tasks.</li>
<li>유럽 국가의 풍력 발전소에서 2년 이상에 걸쳐 발생한 시간별 에너지 출력 데이터셋</li>
<li>node 11개의 풍력 발전소</li>
<li>가중치가 있는 edge는 관계의 강도</li>
<li>회귀 분석 작업에 적합한 목표 변수를 제공합니다.</li>
</ul>
<p>데이터정리</p>
<ul>
<li>T = 17464</li>
<li>V = 풍력발전소</li>
<li>N = 11 # number of nodes</li>
<li>E = 121 = N^2 # edges</li>
<li><span class="math inline">\(f(v,t)\)</span>의 차원? (1,) # Hourly energy output</li>
<li>시간에 따라서 N이 변하는지? False</li>
<li>시간에 따라서 E가 변하는지? False</li>
<li>X: (11,4) (N,4), <span class="math inline">\(f(v,t_0),f(v,t_1),f(v,t_2),f(v,t_3)\)</span></li>
<li>y: (11,) (N,), <span class="math inline">\(f(v,t_4)\)</span></li>
<li>예제코드적용가능여부: Yes</li>
</ul>
<p><code>-</code> Nodes : <code>11</code></p>
<ul>
<li>vertices represent 11 windmills</li>
</ul>
<p><code>-</code>Edges : <code>121</code></p>
<ul>
<li>weighted edges describe the strength of relationships</li>
</ul>
<p><code>-</code> Time : <code>17464</code></p>
<ul>
<li>more than 2 years</li>
</ul>
<div class="cell" data-execution_count="876">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.dataset <span class="im">import</span> WindmillOutputSmallDatasetLoader</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>loader6 <span class="op">=</span> WindmillOutputSmallDatasetLoader()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="877">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> loader6.get_dataset()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="878">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>np.array(a.features).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="878">
<pre><code>(17464, 11, 8)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="879">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_index).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="879">
<pre><code>(2, 121)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="880">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_weight).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="880">
<pre><code>(121,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="881">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.Graph()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="882">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>G.add_edges_from(a.edge_index.T)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="883">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>nx.draw(G,with_labels<span class="op">=</span><span class="va">True</span>,font_weight<span class="op">=</span><span class="st">'bold'</span>,node_color<span class="op">=</span><span class="st">'green'</span>,node_size<span class="op">=</span><span class="dv">350</span>,font_color<span class="op">=</span><span class="st">'white'</span>,width<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-86-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="807">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>node_list <span class="op">=</span> []</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">11</span>):</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    node_list.append(i)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="809">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">11</span>,<span class="dv">1</span>,figsize<span class="op">=</span>(<span class="dv">30</span>,<span class="dv">50</span>))</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">11</span>):</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader6.targets).reshape(<span class="dv">11</span>,<span class="op">-</span><span class="dv">1</span>)[k][:],label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[k]))</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-88-output-1.png" class="img-fluid"></p>
</div>
</div>
<hr>
</section>
</section>
<section id="windmill-비교" class="level1">
<h1>Windmill 비교</h1>
<p>차이점</p>
<ol type="1">
<li>관측소 수 차이</li>
</ol>
<ul>
<li>하지만 어떤 노드가 겹치는지 알 수 없음</li>
</ul>
<div class="cell" data-execution_count="844">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">20</span>))</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(np.array(loader4.targets).reshape(<span class="dv">319</span>,<span class="op">-</span><span class="dv">1</span>)[<span class="dv">0</span>][:],label<span class="op">=</span><span class="st">'observed'</span>) <span class="co"># laarge</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(np.array(loader5.targets).reshape(<span class="dv">26</span>,<span class="op">-</span><span class="dv">1</span>)[<span class="dv">0</span>][:],label<span class="op">=</span><span class="st">'observed'</span>) <span class="co"># medium</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(np.array(loader6.targets).reshape(<span class="dv">11</span>,<span class="op">-</span><span class="dv">1</span>)[<span class="dv">0</span>][:],label<span class="op">=</span><span class="st">'observed'</span>) <span class="co"># small</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-89-output-1.png" class="img-fluid"></p>
</div>
</div>
<hr>
<section id="metrladatasetloader_real-world-traffic-dataset" class="level2">
<h2 class="anchored" data-anchor-id="metrladatasetloader_real-world-traffic-dataset">METRLADatasetLoader_real world traffic dataset</h2>
<p>A traffic forecasting dataset based on Los Angeles Metropolitan traffic conditions. The dataset contains traffic readings collected from 207 loop detectors on highways in Los Angeles County in aggregated 5 minute intervals for 4 months between March 2012 to June 2012.</p>
<p>데이터정리</p>
<ul>
<li>T = 33</li>
<li>V = 구역</li>
<li>N = 207 # number of nodes</li>
<li>E = 225</li>
<li><span class="math inline">\(f(v,t)\)</span>의 차원? (3,) # Hourly energy output</li>
<li>시간에 따라서 N이 변하는지? False</li>
<li>시간에 따라서 E가 변하는지? False</li>
<li>X: (207,4) (N,2,12), <span class="math inline">\(x_0,x_1,x_2,x_3,x_4,x_5,x_6,x_7,x_8,x_9,x_{10},x_{11},z_0,z_1,z_2,z_3,z_4,z_5,z_6,z_7,z_8,z_9,z_{10},z_{11}\)</span></li>
<li>y: (207,) (N,), <span class="math inline">\((x_{12})\)</span></li>
<li>예제코드적용가능여부: No</li>
</ul>
<p>https://arxiv.org/pdf/1707.01926.pdf</p>
<p><code>-</code> Nodes : <code>207</code></p>
<ul>
<li>vertices are localities</li>
</ul>
<p><code>-</code>Edges : <code>225</code></p>
<ul>
<li>edges are spatial_connections</li>
</ul>
<p><code>-</code> Time : <code>33</code></p>
<ul>
<li>between 2020 and 2021</li>
<li>per weeks</li>
</ul>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.dataset <span class="im">import</span> METRLADatasetLoader</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>loader7 <span class="op">=</span> METRLADatasetLoader()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> loader7.get_dataset(num_timesteps_in<span class="op">=</span><span class="dv">1</span>,num_timesteps_out<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_index).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="167">
<pre><code>(2, 1722)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_weight).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="168">
<pre><code>(1722,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>np.array(a.targets).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="169">
<pre><code>(34271, 207, 1)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="930">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.Graph()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="931">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>G.add_edges_from(a.edge_index.T)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="932">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>nx.draw(G,with_labels<span class="op">=</span><span class="va">True</span>,font_weight<span class="op">=</span><span class="st">'bold'</span>,node_color<span class="op">=</span><span class="st">'green'</span>,node_size<span class="op">=</span><span class="dv">350</span>,font_color<span class="op">=</span><span class="st">'white'</span>,width<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-97-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>node_list <span class="op">=</span> []</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">207</span>):</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>    node_list.append(i)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">20</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">50</span>))</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">207</span>), <span class="dv">20</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, idx <span class="kw">in</span> <span class="bu">enumerate</span>(indices):</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader7.targets).reshape(<span class="dv">207</span>,<span class="op">-</span><span class="dv">1</span>)[idx], label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[idx]))</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-99-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="pemsbaydatasetloader" class="level2">
<h2 class="anchored" data-anchor-id="pemsbaydatasetloader">PemsBayDatasetLoader</h2>
<p>https://onlinelibrary.wiley.com/doi/pdf/10.1111/tgis.12644</p>
<ul>
<li><p>A traffic forecasting dataset as described in Diffusion Convolution Layer Paper.</p></li>
<li><p>A traffic forecasting dataset as described in Diffusion Convolution Layer Paper.</p></li>
<li><p>This traffic dataset is collected by California Transportation Agencies (CalTrans) Performance Measurement System (PeMS). It is represented by a network of 325 traffic sensors in the Bay Area with 6 months of traffic readings ranging from Jan 1st 2017 to May 31th 2017 in 5 minute intervals.</p></li>
<li><p>For details see: <code>"Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting" &lt;https://arxiv.org/abs/1707.01926&gt;</code></p></li>
<li><p>캘리포니아 교통국(CalTrans) 성능 측정 시스템(PeMS)에서 수집</p></li>
<li><p>2017년 1월 1일부터 2017년 5월 31일까지 6개월 동안 5분 간격으로 트래픽 판독치가 포함된 베이 지역의 325개 교통 센서 네트워크로 표시</p></li>
</ul>
<p>데이터정리</p>
<ul>
<li>T = 17470</li>
<li>V = 교통센서</li>
<li>N = 325 # number of nodes</li>
<li>E = 2694 = N^2 # edges</li>
<li><span class="math inline">\(f(v,t)\)</span>의 차원? (1,) # Hourly energy output</li>
<li>시간에 따라서 N이 변하는지? False</li>
<li>시간에 따라서 E가 변하는지? No</li>
<li>X: (325,2,12) (N,2,12),
<ul>
<li><span class="math inline">\(x_0,x_1,x_2,x_3,x_4,x_5,x_6,x_7,x_8,x_9,x_{10},x_{11}\)</span></li>
<li><span class="math inline">\(z_0,z_1,z_2,z_3,z_4,z_5,z_6,z_7,z_8,z_9,z_{10},z_{11}\)</span></li>
</ul></li>
<li>y: (325,) (N,2,12),
<ul>
<li><span class="math inline">\(x_{13},x_{14},x_{15},x_{16},x_{17},x_{18},x_{19},x_{20},x_{21},x_{22},x_{23},x_{24}\)</span></li>
<li><span class="math inline">\(z_{13},z_{14},z_{15},z_{16},z_{17},z_{18},z_{19},z_{20},z_{21},z_{22},z_{23},z_{24}\)</span></li>
</ul></li>
<li>예제코드적용가능여부: No</li>
</ul>
<p><code>-</code> Nodes : <code>325</code></p>
<ul>
<li>vertices are sensors</li>
</ul>
<p><code>-</code>Edges : <code>2694</code></p>
<ul>
<li>weighted edges are between seonsor paris measured by the road nretwork distance</li>
</ul>
<p><code>-</code> Time : <code>52081</code></p>
<ul>
<li>6 months of traffic readings ranging from Jan 1st 2017 to May 31th 2017 in 5 minute intervals</li>
</ul>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.dataset <span class="im">import</span> PemsBayDatasetLoader</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>loader8 <span class="op">=</span> PemsBayDatasetLoader()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="291">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> loader8.get_dataset(num_timesteps_in<span class="op">=</span><span class="dv">1</span>,num_timesteps_out<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="292">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_index).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="292">
<pre><code>(2, 2694)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="293">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>a.edge_index</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="293">
<pre><code>array([[  0,   1,   2, ..., 324, 324, 324],
       [  0,   1,   2, ..., 257, 310, 324]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="288">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_weight).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="288">
<pre><code>(2694,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="206">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>np.array(a.targets).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="206">
<pre><code>(52104, 325, 2, 1)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="208">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>a.targets[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="208">
<pre><code>array([0.99281436], dtype=float32)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="209">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>node_list <span class="op">=</span> []</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">325</span>):</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>    node_list.append(i)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="210">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">20</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">50</span>))</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">325</span>), <span class="dv">20</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, idx <span class="kw">in</span> <span class="bu">enumerate</span>(indices):</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader8.targets).reshape(<span class="dv">325</span>,<span class="op">-</span><span class="dv">1</span>)[idx], label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[idx]))</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-108-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="englandcoviddatasetloader" class="level2">
<h2 class="anchored" data-anchor-id="englandcoviddatasetloader">EnglandCovidDatasetLoader</h2>
<p>Covid19 England</p>
<ul>
<li>A dataset about mass mobility between regions in England and the number of confirmed COVID-19 cases from March to May 2020 [38]. Each day contains a different mobility graph and node features corresponding to the number of cases in the previous days. Mobility stems from Facebook Data For Good 1 and cases from gov.uk 2</li>
</ul>
<p>https://arxiv.org/pdf/2009.08388.pdf</p>
<p>데이터정리</p>
<ul>
<li>T = 60</li>
<li>V = 지역</li>
<li>N = 129 # number of nodes</li>
<li>E = 2158</li>
<li><span class="math inline">\(f(v,t)\)</span>의 차원? (1,) # 코로나확진자수</li>
<li>시간에 따라서 Number of nodes가 변하는지? False</li>
<li>시간에 따라서 Number of edge가 변하는지? TRUE</li>
<li>X: (20,4) (N,4), <span class="math inline">\(f(v,t_0),f(v,t_1),f(v,t_2),f(v,t_3)\)</span></li>
<li>y: (20,) (N,), <span class="math inline">\(f(v,t_4)\)</span></li>
<li>예제코드적용가능여부: Yes</li>
</ul>
<p><code>-</code> Nodes : <code>129</code></p>
<ul>
<li>vertices are correspond to the number of COVID-19 cases in the region in the past window days.</li>
</ul>
<p><code>-</code>Edges : <code>2158</code></p>
<ul>
<li>the spatial edges capture county-to-county movement at a specific date, and a county is connected to a number of past instances of itself with temporal edges.</li>
</ul>
<p><code>-</code> Time : <code>61</code></p>
<ul>
<li>from 3 March to 12 of May</li>
</ul>
<div class="cell" data-execution_count="350">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.dataset <span class="im">import</span> EnglandCovidDatasetLoader</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>loader9 <span class="op">=</span> EnglandCovidDatasetLoader()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="351">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.signal <span class="im">import</span> temporal_signal_split</span></code></pre></div>
</div>
<div class="cell" data-execution_count="373">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> loader9.get_dataset(lags<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="371">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>a, _a <span class="op">=</span> temporal_signal_split(a, train_ratio<span class="op">=</span><span class="fl">0.8</span>)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="374">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>a.snapshot_count,_a.snapshot_count</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="374">
<pre><code>(60, 12)</code></pre>
</div>
</div>
<p>원래 60</p>
<div class="cell" data-execution_count="356">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>a.edge_indices[<span class="dv">59</span>]</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>IndexError: list index out of range</code></pre>
</div>
</div>
<div class="cell" data-execution_count="333">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_indices[<span class="dv">59</span>]).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="333">
<pre><code>(2, 1476)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="334">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>a.edge_weights[<span class="dv">59</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="334">
<pre><code>array([2.96600e+03, 1.88595e+05, 1.30000e+02, ..., 1.10000e+01,
       1.80000e+01, 1.00000e+01])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="335">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_weights[<span class="dv">59</span>]).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="335">
<pre><code>(1476,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="218">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>a.snapshot_count</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="218">
<pre><code>60</code></pre>
</div>
</div>
<div class="cell" data-execution_count="219">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>np.array(a.features).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="219">
<pre><code>(60, 129, 1)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="220">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>np.array(a.targets).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="220">
<pre><code>(60, 129)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="326">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.Graph()</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>G.add_edges_from(a.edge_indices[<span class="dv">0</span>].T)</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>nx.draw(G,with_labels<span class="op">=</span><span class="va">True</span>,font_weight<span class="op">=</span><span class="st">'bold'</span>,node_color<span class="op">=</span><span class="st">'green'</span>,node_size<span class="op">=</span><span class="dv">350</span>,font_color<span class="op">=</span><span class="st">'white'</span>,width<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-121-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="327">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.Graph()</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>G.add_edges_from(a.edge_indices[<span class="dv">58</span>].T)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>nx.draw(G,with_labels<span class="op">=</span><span class="va">True</span>,font_weight<span class="op">=</span><span class="st">'bold'</span>,node_color<span class="op">=</span><span class="st">'green'</span>,node_size<span class="op">=</span><span class="dv">350</span>,font_color<span class="op">=</span><span class="st">'white'</span>,width<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-122-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="224">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>node_list <span class="op">=</span> []</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">129</span>):</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>    node_list.append(i)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="225">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">20</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">50</span>))</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">129</span>), <span class="dv">20</span>)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, idx <span class="kw">in</span> <span class="bu">enumerate</span>(indices):</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader9.targets).reshape(<span class="dv">129</span>,<span class="op">-</span><span class="dv">1</span>)[idx], label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[idx]))</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-124-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="montevideobusdatasetloader" class="level2">
<h2 class="anchored" data-anchor-id="montevideobusdatasetloader">MontevideoBusDatasetLoader</h2>
<p>Montevideo Buses</p>
<ul>
<li>A dataset of inflow passenger at bus stop level from Montevideo city. This dataset comprises hourly inflow passenger data at bus stop level for 11 bus lines during October 2020 from Montevideo city (Uruguay). The bus lines selected are the ones that carry people to the center of the city and they load more than 25% of the total daily inflow traffic. Vertices are bus stops, edges are links between bus stops when a bus line connects them and the weight represent the road distance. The target is the passenger inflow. This is a curated dataset made from different data sources of the Metropolitan Transportation System (STM) of Montevideo. These datasets are freely available to anyone in the National Catalog of Open Data from the government of Uruguay (https://catalogodatos.gub.uy/)</li>
<li>몬테비데오 시티에서 버스 정류장 층으로 유입된 승객의 데이터 셋</li>
<li>2020년 10월 동안 몬테비데오 시티(우루과이)에서 11개 버스 노선에 대한 버스 정류장 수준의 시간당 유입 승객 데이터</li>
<li>선정된 버스 노선은 도심까지 사람을 실어 나르는 노선으로 하루 총 유입량의 25% 이상을 적재</li>
<li>node는 버스 정류장</li>
<li>edge는 버스 노선이 버스 정류장을 연결할 때 버스 정류장 사이의 링크</li>
<li>weight는 도로 거리</li>
<li>target은 승객 유입</li>
<li>몬테비데오의 메트로폴리탄 교통 시스템(STM)의 서로 다른 데이터 소스로 만들어진 큐레이션된 데이터 셋</li>
</ul>
<p>데이터정리</p>
<ul>
<li>T = 743</li>
<li>V = 버스정류장</li>
<li>N = 675 # number of nodes</li>
<li>E = 101761 = N^2 # edges</li>
<li><span class="math inline">\(f(v,t)\)</span>의 차원? (1,) # passenger inflow</li>
<li>시간에 따라서 Number of nodes가 변하는지? False</li>
<li>시간에 따라서 Number of nodes가 변하는지? False</li>
<li>X: (675,4) (N,4), <span class="math inline">\(f(v,t_0),f(v,t_1),f(v,t_2),f(v,t_3)\)</span></li>
<li>y: (675,,) (N,), <span class="math inline">\(f(v,t_4)\)</span></li>
<li>예제코드적용가능여부: Yes</li>
</ul>
<p><code>-</code> Nodes : <code>675</code></p>
<ul>
<li>vertices are bus stops</li>
</ul>
<p><code>-</code>Edges : <code>690</code></p>
<ul>
<li>edges are links between bus stops when a bus line connects them and the weight represent the road distance</li>
</ul>
<p><code>-</code> Time : <code>743</code></p>
<ul>
<li>hourly inflow passenger data at bus stop level for 11 bus lines during October 2020 from Montevideo city (Uruguay).</li>
</ul>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.dataset <span class="im">import</span> MontevideoBusDatasetLoader</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>loader10 <span class="op">=</span> MontevideoBusDatasetLoader()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> loader10.get_dataset(lags<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_index).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>(2, 690)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_weight).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>(690,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>np.array(a.features).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>(743, 675, 1)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.Graph()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>G.add_edges_from(a.edge_index.T)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>nx.draw(G,with_labels<span class="op">=</span><span class="va">True</span>,font_weight<span class="op">=</span><span class="st">'bold'</span>,node_color<span class="op">=</span><span class="st">'green'</span>,node_size<span class="op">=</span><span class="dv">350</span>,font_color<span class="op">=</span><span class="st">'white'</span>,width<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-132-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>node_list <span class="op">=</span> []</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">675</span>):</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>    node_list.append(i)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">20</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">50</span>))</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">319</span>), <span class="dv">20</span>)</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, idx <span class="kw">in</span> <span class="bu">enumerate</span>(indices):</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader10.targets).reshape(<span class="dv">675</span>,<span class="op">-</span><span class="dv">1</span>)[idx], label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[idx]))</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-134-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="twittertennisdatasetloader" class="level2">
<h2 class="anchored" data-anchor-id="twittertennisdatasetloader">TwitterTennisDatasetLoader</h2>
<p>https://appliednetsci.springeropen.com/articles/10.1007/s41109-018-0080-5?ref=https://githubhelp.com</p>
<p>Twitter Tennis RG and UO</p>
<ul>
<li>Twitter mention graphs of major tennis tournaments from 2017. Each snapshot contains the graph of popular player or sport news accounts and mentions between them [5, 6]. Node labels encode the number of mentions received and vertex features are structural properties</li>
</ul>
<p>데이터정리</p>
<ul>
<li>T = 52081</li>
<li>V = 트위터계정<br>
</li>
<li>N = 1000 # number of nodes</li>
<li>E = 119 = N^2 # edges</li>
<li><span class="math inline">\(f(v,t)\)</span>의 차원? (1,) # passenger inflow</li>
<li>시간에 따라서 N이 변하는지? ??</li>
<li>시간에 따라서 E가 변하는지? True</li>
<li>X: ?</li>
<li>y: ?</li>
<li>예제코드적용가능여부: No</li>
</ul>
<p><code>-</code> Nodes : <code>1000</code></p>
<ul>
<li>vertices are Twitter accounts</li>
</ul>
<p><code>-</code>Edges : <code>119</code></p>
<ul>
<li>edges are mentions between them</li>
</ul>
<p><code>-</code> Time : <code>52081</code></p>
<ul>
<li>Twitter mention graphs related to major tennis tournaments from 2017</li>
</ul>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.dataset <span class="im">import</span> TwitterTennisDatasetLoader</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>loader11 <span class="op">=</span> TwitterTennisDatasetLoader()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> loader11.get_dataset()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>a.edge_indices[<span class="dv">119</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>array([[900, 347, 347, 407, 407, 407, 407, 407, 407,   0,  35, 448, 407,
        396, 396, 370, 233, 233, 357,  15,  15, 135, 135, 358, 233, 233,
        243, 115, 115, 667, 667, 667, 667, 440, 440, 440, 101, 650, 309,
        309, 309, 233, 347, 347, 974, 161, 218, 309, 309,  93,  93, 813,
        101, 417,  69,  69, 480, 480, 416, 272, 813, 813, 813, 379, 903,
        903, 903,  95, 309, 309, 309, 144, 890, 890, 484, 484, 484, 653,
        653, 234, 234, 234, 253, 253, 630, 769, 769, 156, 156, 156, 892,
        912, 912,   0, 278, 896, 896, 896, 233,  92,  69, 802, 324, 324,
        574,  87,  87,  87, 365, 365,  87, 522, 611, 427, 427, 427, 110,
        246, 246, 445, 156, 156, 133, 133, 217, 217,   4,   4, 105, 105,
        105, 105, 630, 630, 630, 792,  84, 452,  51,  84, 445, 613, 985,
        290, 290, 290, 290, 290, 290, 420, 420, 420, 420, 420, 420, 420,
        420, 420,   0, 626, 626, 519, 519, 519, 519, 519, 519, 519, 519,
        519, 217, 437, 437, 437, 309, 309, 217, 666,   4, 637, 540,  38,
         38, 605, 605, 605, 605, 605, 215],
       [  0,   0, 152,  41, 590,   0, 133, 116, 731,   1,   1,   1,   2,
          0,   1,   0,   0, 982,   2,   1,   0,   0,   1,  51,   1, 427,
          2,  74,   0,   1,  97,   0,   5,   0,   1, 614,  99,   0, 427,
          0,   1, 203,   2,   1, 731,   1,   1,   2,  15,   0, 152,   1,
          1,   0,   0,   1,   1,   0,   0,   0,  81,  97,   0,   0,   0,
        416,  69,   1, 317,  67, 438,   0,   0,   1,   0,   1, 234,  15,
          0,   1, 484,   0,   0, 141,   0,   1,  97, 221,   0, 540, 445,
          1,   0,   2,   0,   0, 132, 438, 745,  92,   2,  80,   0, 152,
          0,   0,   1,   4, 129, 338, 170,   0,   1, 123,   1,   0,   1,
          1,   0,   1,   1, 427,   0,   1,   1, 217,   0,   1,   1,  97,
          0, 226, 123,   1, 427,   0,   0,   1,   1,   1,   0,   1,   1,
          5, 121,   0,  99,  15, 226,   5,   2, 221,  97,   6,  99, 226,
        121,   0, 706,   0, 211,  99,   0,   5,  97, 226, 121,   6, 221,
          2,   0,   1,   0, 217,  69, 416, 210,   0, 634, 291, 236,   1,
          0, 234, 437, 286,   1, 745,  56]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>a.edge_weights[<span class="dv">119</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>array([1, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 6, 2, 2, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 2, 2, 1, 1, 1, 1, 1, 1, 3, 3, 1, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 3, 1, 1, 2, 2, 2, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 2, 1, 1, 3, 3, 1,
       3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>a.features[<span class="dv">119</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [1., 0., 0., ..., 0., 0., 0.],
       [1., 0., 0., ..., 0., 0., 0.],
       [1., 0., 0., ..., 0., 0., 0.]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>a.snapshot_count</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>120</code></pre>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>np.array(a.targets).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>(120, 1000)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>node_list <span class="op">=</span> []</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">1000</span>):</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>    node_list.append(i)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">20</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">50</span>))</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">1000</span>), <span class="dv">20</span>)</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, idx <span class="kw">in</span> <span class="bu">enumerate</span>(indices):</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>    ax[k].plot(np.array(loader11.targets).reshape(<span class="dv">1000</span>,<span class="op">-</span><span class="dv">1</span>)[idx], label<span class="op">=</span><span class="st">'observed'</span>)</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>    ax[k].set_title(<span class="st">'node: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(node_list[idx]))</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>    ax[k].legend()</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-03-20-data load, data save as pickle_files/figure-html/cell-143-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transform_degree(x, cutoff<span class="op">=</span><span class="dv">4</span>):</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>    log_deg <span class="op">=</span> np.ceil(np.log(x <span class="op">+</span> <span class="fl">1.0</span>))</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.minimum(log_deg, cutoff)</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transform_transitivity(x):</span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>    trans <span class="op">=</span> x <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.floor(trans)</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> onehot_encoding(x, unique_vals):</span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a>    E <span class="op">=</span> np.zeros((<span class="bu">len</span>(x), <span class="bu">len</span>(unique_vals)))</span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, val <span class="kw">in</span> <span class="bu">enumerate</span>(x):</span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true" tabindex="-1"></a>        E[i, unique_vals.index(val)] <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb195-15"><a href="#cb195-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> E</span>
<span id="cb195-16"><a href="#cb195-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-17"><a href="#cb195-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-18"><a href="#cb195-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> encode_features(X, log_degree_cutoff<span class="op">=</span><span class="dv">4</span>):</span>
<span id="cb195-19"><a href="#cb195-19" aria-hidden="true" tabindex="-1"></a>    X_arr <span class="op">=</span> np.array(X)</span>
<span id="cb195-20"><a href="#cb195-20" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> transform_degree(X_arr[:, <span class="dv">0</span>], log_degree_cutoff)</span>
<span id="cb195-21"><a href="#cb195-21" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> transform_transitivity(X_arr[:, <span class="dv">1</span>])</span>
<span id="cb195-22"><a href="#cb195-22" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> onehot_encoding(a, <span class="bu">range</span>(log_degree_cutoff <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb195-23"><a href="#cb195-23" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> onehot_encoding(b, <span class="bu">range</span>(<span class="dv">11</span>))</span>
<span id="cb195-24"><a href="#cb195-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.concatenate((A, B), axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
</section>
<section id="mtmdatasetloader" class="level2">
<h2 class="anchored" data-anchor-id="mtmdatasetloader">MTMDatasetLoader</h2>
<p>MTM-1 Hand Motions</p>
<ul>
<li>A dataset of <code>Methods-Time Measurement-1 &lt;https://en.wikipedia.org/wiki/Methods-time_measurement&gt;</code><em>(MTM-1) motions, signalled as consecutive video frames of 21 3D hand keypoints, acquired via <code>MediaPipe Hands &lt;https://google.github.io/mediapipe/solutions/hands.html&gt;</code></em> from RGB-Video material. Vertices are the finger joints of the human hand and edges are the bones connecting them. The targets are manually labeled for each frame, according to one of the five MTM-1 motions (classes :math:<code>C</code>): Grasp, Release, Move, Reach, Position plus a negative class for frames without graph signals (no hand present). This is a classification task where :math:<code>T</code> consecutive frames need to be assigned to the corresponding class :math:<code>C</code>. The data x is returned in shape :obj:<code>(3, 21, T)</code>, the target is returned one-hot-encoded in shape :obj:<code>(T, 6)</code>.</li>
</ul>
<p>데이터정리</p>
<ul>
<li>T = 14452</li>
<li>V = 손의 shape에 대응하는 dot<br>
</li>
<li>N = 325 # number of nodes</li>
<li>E = 19 = N^2 # edges</li>
<li><span class="math inline">\(f(v,t)\)</span>의 차원? (Grasp, Release, Move, Reach, Poision, -1)</li>
<li>시간에 따라서 N이 변하는지? ??</li>
<li>시간에 따라서 E가 변하는지? ??</li>
<li>X: ?</li>
<li>y: ?</li>
<li>예제코드적용가능여부: No</li>
</ul>
<p><code>-</code> Nodes : <code>325</code></p>
<ul>
<li>vertices are are the finger joints of the human hand</li>
</ul>
<p><code>-</code>Edges : <code>19</code></p>
<ul>
<li>edges are the bones connecting them</li>
</ul>
<p><code>-</code> Time : <code>14452</code></p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># target eoncoding: {0 : 'Grasp', 1 : 'Move', 2 : 'Negative',</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                   3 : 'Position', 4 : 'Reach', 5 : 'Release'}</span></span></code></pre></div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric_temporal.dataset <span class="im">import</span> MTMDatasetLoader</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>loader12 <span class="op">=</span> MTMDatasetLoader()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> loader12.get_dataset(frames<span class="op">=</span><span class="dv">16</span>)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>np.array(a.edge_index).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>(2, 19)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>np.shape(a.edge_weight)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>(19,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>np.array(a.features).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>(14453, 3, 21, 16)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>a.snapshot_count</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>14453</code></pre>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>np.array(a.targets).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>(14453, 16, 6)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>a.targets[<span class="dv">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>array([[0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span>[]</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(a.snapshot_count):</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>    b.append(np.argmax(a.targets[i]))</span></code></pre></div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(b)[<span class="dv">0</span>].unique()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>array([2, 4, 0, 1, 3, 5])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(b).value_counts()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>0    3910
1    3189
3    3069
4    2480
2    1266
5     539
dtype: int64</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>