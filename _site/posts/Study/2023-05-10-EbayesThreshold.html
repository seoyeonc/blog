<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="SEOYEON CHOI">
<meta name="dcterms.date" content="2023-05-10">

<title>Seoyeon’s Blog for study - EbayesThresh: R Programs for Empirical Bayes Thresholding, Review</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Seoyeon’s Blog for study</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../about.html" aria-current="page">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/seoyeonc/blog/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">EbayesThresh: R Programs for Empirical Bayes Thresholding, Review</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">EbayesThresh: R Programs for Empirical Bayes Thresholding, Review</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">EbayesThresh</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>SEOYEON CHOI </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 10, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Posts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/GCN/index.html" class="sidebar-item-text sidebar-link">GCN</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-29-STGCN-tutorial.html" class="sidebar-item-text sidebar-link"><strong>[IT-STGCN]</strong> STGCN 튜토리얼</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-20-ESTGCN_GNAR_edit_guebin.html" class="sidebar-item-text sidebar-link">1st ITSTGCN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-20-Algorithm_traintest.html" class="sidebar-item-text sidebar-link">1st ST-GCN Example dividing train and test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-20-ESTGCN_GNAR_edit_guebin2.html" class="sidebar-item-text sidebar-link">2nd ITSTGCN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-18-Algorithm_traintest_2.html" class="sidebar-item-text sidebar-link">2nd ST-GCN Example dividing train and test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-27-AddingtheRecurrentGCNmodels.html" class="sidebar-item-text sidebar-link">Adding the RecurrentGCN models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-26-guebin.html" class="sidebar-item-text sidebar-link">Class of Method</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-21-Class.html" class="sidebar-item-text sidebar-link">Class of Method</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-26-ESTGCN_GNAR_DATA.html" class="sidebar-item-text sidebar-link">Class of Method(GNAR) lag 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-06-ESTGCN_GNAR_DATA_3.html" class="sidebar-item-text sidebar-link">Class of Method(GNAR) lag 1 80% Missing repeat</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-06-ESTGCN_GNAR_DATA_2.html" class="sidebar-item-text sidebar-link">Class of Method(GNAR) lag 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-02-07-ESTGCN_WIKI_DATA_2.html" class="sidebar-item-text sidebar-link">Class of Method(WikiMath) lag 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-26-ESTGCN_WIKI_DATA.html" class="sidebar-item-text sidebar-link">Class of Method(WikiMath) lag 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-20-data load, data save as pickle.html" class="sidebar-item-text sidebar-link">data load, data save as pickle</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-20-EbayesThresh toy ex.html" class="sidebar-item-text sidebar-link">EbayesThresh Toy ex</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-06-GCLSTM_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">GCLSTM_Simulation Tables_reshape</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-06-GCLSTM_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">GCLSTM_Simulation_reshape</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-11-Algorithm_EX_1.html" class="sidebar-item-text sidebar-link">GCN Algorithm Example 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-25-GCONVGRU_snd_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">GConvGRU_Simulation Boxplot_reshape</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-25-GCONVGRU_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">GConvGRU_Simulation Tables_reshape</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-17-xx_GCONVGRU_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">GConvGRU_Simulation Tables_reshape</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-30-GConvLSTM_simulation_table_reshape.html" class="sidebar-item-text sidebar-link">GConvLSTM_Simulation Tables_reshape</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-30-GConvLSTM_Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">GConvLSTM_Simulation_reshape</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-05-GNAR.html" class="sidebar-item-text sidebar-link">GNAR data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-31-Other Method.html" class="sidebar-item-text sidebar-link">ITSTGCN add Model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-06-article_refer.html" class="sidebar-item-text sidebar-link">ITSTGCN Article Refernece</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-17-ITSTGCN-Tutorial.html" class="sidebar-item-text sidebar-link">ITSTGCN-Tutorial</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-06-METRLADatasetLoader.html" class="sidebar-item-text sidebar-link">METRLADatasetLoader-Tutorial</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-25-note_matrix.html" class="sidebar-item-text sidebar-link">Note_weight amatrix</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-29-pedalme_GSO_st.html" class="sidebar-item-text sidebar-link">Padalme GSO_st</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-11-CPUvsGPU.html" class="sidebar-item-text sidebar-link">PyG Geometric Temporal CPU vs GPU</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-11-PyGGeometricTemporalEx.html" class="sidebar-item-text sidebar-link">PyG Geometric Temporal Examples</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-21-ST-GCN_Dataset.html" class="sidebar-item-text sidebar-link">PyTorch ST-GCN Dataset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-04-questions of pytorch geometric temporal.html" class="sidebar-item-text sidebar-link">Questions of PyTorch Geometric Temporal</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-18-Self Consistency toy ex.html" class="sidebar-item-text sidebar-link">Self Consistency Toy ex</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-18-SimulationPlanner-Tutorial.html" class="sidebar-item-text sidebar-link">SimualtionPlanner-Tutorial</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-22-SimulationPlanner-Tutorial_test_test.html" class="sidebar-item-text sidebar-link">SimualtionPlanner-Tutorial</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-05-Simulation_boxplot.html" class="sidebar-item-text sidebar-link">Simulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-05-Simulation.html" class="sidebar-item-text sidebar-link">Simulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-28-gcn_simulation.html" class="sidebar-item-text sidebar-link">Simulation of geometric-temporal</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-27-simulation_table.html" class="sidebar-item-text sidebar-link">Simulation Tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-05-17-itstgcntry)fail_version__Simulation_boxplot_reshape.html" class="sidebar-item-text sidebar-link">Simulation_reshape</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-06-04-Sparse_matrix.html" class="sidebar-item-text sidebar-link">Sparse matrix</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-03-03-ESTGCN_GNAR_edit_guebin2_seoyeon.html" class="sidebar-item-text sidebar-link">SY 1st ITSTGCN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-07-torchgcn.html" class="sidebar-item-text sidebar-link">TORCH_GEOMETRIC.NN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-27-toy_example_figure.html" class="sidebar-item-text sidebar-link">Toy Example Figure(Intro)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-04-27-toy_example_notes.html" class="sidebar-item-text sidebar-link">Toy Example Note</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/GODE/index.html" class="sidebar-item-text sidebar-link">GODE</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-11-19-class_code_for_paper.html" class="sidebar-item-text sidebar-link">Class code for Comparison Study</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-12-27-DFT_study.html" class="sidebar-item-text sidebar-link">Discrete Fourier Transform</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-10-02-Earthquake_real.html" class="sidebar-item-text sidebar-link">Earthquake</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-12-01-graph_code_guebin.html" class="sidebar-item-text sidebar-link">Graph code</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-09-02-paper_simulation.html" class="sidebar-item-text sidebar-link">Simulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/Untitled.html" class="sidebar-item-text sidebar-link">Untitled</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/Quarto_tip/index.html" class="sidebar-item-text sidebar-link">Quarto tip</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Quarto_tip/2023-01-02-quarto_tips.html" class="sidebar-item-text sidebar-link">quarto blog tips</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/Study/index.html" class="sidebar-item-text sidebar-link">Study</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-02-05-ch12_2_3_Power Spectral Density and its Estimators.html" class="sidebar-item-text sidebar-link">Chap 12.2 ~ 3: Power Spectral Density and its Estimators</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-02-02-ch12.2_Weakly Stationary Graph Processes.html" class="sidebar-item-text sidebar-link">Chap 12.2: Weakly Stationary Graph Processes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-02-01-ch8_DFT.html" class="sidebar-item-text sidebar-link">Chap 8.3: Discrete Fourier Transform</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-05-10-EbayesThreshold.html" class="sidebar-item-text sidebar-link active">EbayesThresh: R Programs for Empirical Bayes Thresholding, Review</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-10-GCRN_rivew.html" class="sidebar-item-text sidebar-link">GCRN Review</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-05-21-Graph Attention Networks (GATs).html" class="sidebar-item-text sidebar-link">Graph Attention Networks (GATs)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2022-03-28-(4주차) 3월28일.html" class="sidebar-item-text sidebar-link">Introduction to Python 4wk</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2022-04-03-(5주차) 4월2일.html" class="sidebar-item-text sidebar-link">Introduction to Python 5wk</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-08-wrting_down_algorithm.html" class="sidebar-item-text sidebar-link">ITSTGCN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-23-lebesque_decompposition_therem.html" class="sidebar-item-text sidebar-link">Lebesgue’s decomposition theorem</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-04-nomalized graph laplacian.html" class="sidebar-item-text sidebar-link">Nomalized Graph Laplacian</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-05-20-RGNN_pyg_official.html" class="sidebar-item-text sidebar-link">Recurrent Graph Neural Network</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-12-.html" class="sidebar-item-text sidebar-link">Self-onsistent estimator</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-10-STGCN_Existing_Method_Review.html" class="sidebar-item-text sidebar-link">STGCN Existing Method Review</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-03-16-stgcn_paper_review_1.html" class="sidebar-item-text sidebar-link">STGCN papers review</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2022-12-31-Space-study.html" class="sidebar-item-text sidebar-link">Study for Spaces</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#my-own-summary" id="toc-my-own-summary" class="nav-link active" data-scroll-target="#my-own-summary">My own Summary</a></li>
  <li><a href="#import" id="toc-import" class="nav-link" data-scroll-target="#import">Import</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  <li><a href="#description-of-the-method" id="toc-description-of-the-method" class="nav-link" data-scroll-target="#description-of-the-method">Description of the method</a>
  <ul class="collapse">
  <li><a href="#the-bayesian-model" id="toc-the-bayesian-model" class="nav-link" data-scroll-target="#the-bayesian-model">The Bayesian model</a></li>
  <li><a href="#thresholding-rules" id="toc-thresholding-rules" class="nav-link" data-scroll-target="#thresholding-rules">Thresholding rules</a></li>
  <li><a href="#choosing-the-threshold" id="toc-choosing-the-threshold" class="nav-link" data-scroll-target="#choosing-the-threshold">Choosing the threshold</a></li>
  <li><a href="#wavelet-thresholding-and-other-extensions" id="toc-wavelet-thresholding-and-other-extensions" class="nav-link" data-scroll-target="#wavelet-thresholding-and-other-extensions">Wavelet thresholding and other extensions</a></li>
  </ul></li>
  <li><a href="#examples-and-aspects-of-the-package" id="toc-examples-and-aspects-of-the-package" class="nav-link" data-scroll-target="#examples-and-aspects-of-the-package">Examples and aspects of the package</a>
  <ul class="collapse">
  <li><a href="#a-simple-illustrative-example" id="toc-a-simple-illustrative-example" class="nav-link" data-scroll-target="#a-simple-illustrative-example">A simple illustrative example</a></li>
  <li><a href="#varying-sparsity-in-a-larger-sample" id="toc-varying-sparsity-in-a-larger-sample" class="nav-link" data-scroll-target="#varying-sparsity-in-a-larger-sample">Varying sparsity in a larger sample</a></li>
  <li><a href="#the-posterior-median-thresholding-function" id="toc-the-posterior-median-thresholding-function" class="nav-link" data-scroll-target="#the-posterior-median-thresholding-function">The posterior median thresholding function</a></li>
  <li><a href="#other-control-parameters-in-the-packages-routines" id="toc-other-control-parameters-in-the-packages-routines" class="nav-link" data-scroll-target="#other-control-parameters-in-the-packages-routines">Other control parameters in the package’s routines</a></li>
  </ul></li>
  <li><a href="#wavelet-thresholding" id="toc-wavelet-thresholding" class="nav-link" data-scroll-target="#wavelet-thresholding">Wavelet thresholding</a>
  <ul class="collapse">
  <li><a href="#empirical-bayes-thresholding-of-the-discrete-wavelet-transform" id="toc-empirical-bayes-thresholding-of-the-discrete-wavelet-transform" class="nav-link" data-scroll-target="#empirical-bayes-thresholding-of-the-discrete-wavelet-transform">Empirical Bayes thresholding of the discrete wavelet transform</a></li>
  <li><a href="#the-estimated-thresholds" id="toc-the-estimated-thresholds" class="nav-link" data-scroll-target="#the-estimated-thresholds">The estimated thresholds</a></li>
  <li><a href="#the-stationary-noise-model" id="toc-the-stationary-noise-model" class="nav-link" data-scroll-target="#the-stationary-noise-model">The stationary noise model</a></li>
  <li><a href="#the-translation-invariant-wavelet-transform" id="toc-the-translation-invariant-wavelet-transform" class="nav-link" data-scroll-target="#the-translation-invariant-wavelet-transform">The translation-invariant wavelet transform</a></li>
  <li><a href="#smoothing-an-image" id="toc-smoothing-an-image" class="nav-link" data-scroll-target="#smoothing-an-image">Smoothing an image</a></li>
  </ul></li>
  <li><a href="#more-general-mixture-weight-structure" id="toc-more-general-mixture-weight-structure" class="nav-link" data-scroll-target="#more-general-mixture-weight-structure">More general mixture weight structure</a>
  <ul class="collapse">
  <li><a href="#increasing-sparsity-along-the-sequence" id="toc-increasing-sparsity-along-the-sequence" class="nav-link" data-scroll-target="#increasing-sparsity-along-the-sequence">Increasing sparsity along the sequence</a></li>
  <li><a href="#parametric-dependence" id="toc-parametric-dependence" class="nav-link" data-scroll-target="#parametric-dependence">Parametric dependence</a></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<blockquote class="blockquote">
<p>EbayesThresh</p>
</blockquote>
<p>refer: <a href="http://CRAN.R-project.org/">CRAN</a>, <a href="https://miruetoto.github.io/yechan3/posts/2_Studies/Reviews/2022-12-23-Ebayesthresh.html#cb2-3">교수님 블로그</a></p>
<section id="my-own-summary" class="level1">
<h1>My own Summary</h1>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>prior distribution에 의해 모델링되는 베이지안 모델 사용</li>
<li>여기서 말하는 <span class="math inline">\(\mu_i\)</span>는 계수
<ul>
<li><span class="math inline">\(y =\mu_1 x + \mu_2 x_2+ \dots\)</span></li>
<li>function에서 step function을 골라내는 과정(nonzero)</li>
<li>function에서 constitutional function은 남김(zero)</li>
</ul></li>
<li><span class="math inline">\(X\)</span>는 독립적이라고 가정, 완전히 독립적이지 않더라도 의존이 없으면 최소한 합리적인 결과 제공</li>
<li><span class="math inline">\(\hat{\mu}\)</span>을 posterior distribution을 <span class="math inline">\(|x| \le t(w)\)</span>일 경우에만 0이 되도록 monotonic function을 잡고, 베이지안 모델을 반복 적용하여 <span class="math inline">\(\mu\)</span> 추정치 구하기</li>
<li>prior distribution이 dependent 하다면 marginal MLE로 추정된 weight이 <span class="math inline">\(\mu\)</span>에 영향을 줄 것이고, posterior distribution의 중앙값이 영향을 받아 다음 베이지안 모델링에도 영향을 미침</li>
<li>white noise 보다 stationary noise 에서 더 잘 작동</li>
<li>변환 잘 하면 어느 도메인에서도 동일하게 적용 가능</li>
<li>웨이블릿에서 white noise 보다 stationary noise으로 이베이즈 봤을때 stationary noise가 white noise보다 더 잘 peak를 골라내므로 stationary noise를 가정한다.</li>
</ul>
</div>
</div>
</section>
<section id="import" class="level1">
<h1>Import</h1>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EbayesThresh)</span></code></pre></div>
</div>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Single observation <span class="math inline">\(X_i\)</span>가 있을 때,</p>
<p><span class="math display">\[X_i = \mu_i + \epsilon_i\]</span></p>
<p>로 가정하고, <span class="math inline">\(\epsilon_i\)</span>는 random variable이면서</p>
<p><span class="math display">\[\epsilon_i \sim N(0,1)\]</span></p>
<p>라고 하자.</p>
<p>예를 들어 <span class="math inline">\(\mu_i\)</span>가 sparse 하는 경우가 있을 수 있는데, 이 때 sequence <span class="math inline">\(mu_i\)</span>의 more efficient estimators를 구하기 위해 EbayesThresh 패키지는 possible sparsity의 advantage를 취한다.(Empirical Bayes approach has excellent adaptivity properties, in particular by adjusting stably to the sparsity or otherwise of the underlying signal, by choosing an appropriate threshold from the data.)</p>
<p>만약 특정 <span class="math inline">\(X_i\)</span>의 절댓값이 threshold 임계값 t를 초과하면 0이 아니라 <span class="math inline">\(\mu_i\)</span>에 해당한다고 간주하고, 그렇지 않으면 0으로 간주함으로써 구별할 수 있다.</p>
<p>EbayesTHresh에서 사용된 <strong>경험적 베이즈 접근법Empirical Bayes approach</strong>은 Johnstone의 다른 논문에서 언급됨<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>위 논문에 따르면, 경험적 베이즈 방법은 underline signal 기본신호의 희소한 방법sparsity나 다른 방법들에 대해 안정적으로 조정하고, 데이터에서 적절한 임계값을 선택함으로써 훌륭한 적응성adaptivity 특성을 가진다.</p>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/9fc97143-957b-4a95-bf9c-72a9ec34dd85-1-1e9adf0f-04d0-44bc-a94b-77dfe7c48699.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image.png</figcaption><p></p>
</figure>
</div>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>) <span class="sc">+</span> <span class="fu">sample</span>(<span class="fu">c</span>( <span class="fu">runif</span>(<span class="dv">25</span>,<span class="sc">-</span><span class="dv">7</span>,<span class="dv">7</span>), <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">975</span>)))</span></code></pre></div>
</div>
<p><span class="math inline">\(X_i\)</span>에서 <span class="math inline">\(\mu_i\)</span> 추출 가능하는 것을 증명할 예제</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="at">type=</span><span class="st">'l'</span>);<span class="fu">plot</span>(<span class="fu">ebayesthresh</span>(x, <span class="at">sdev=</span><span class="dv">1</span>))</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/cell-4-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>데이터 설명</p>
<ul>
<li>n = 1000</li>
<li>25개의 nonzero entries uniformly distributed on(-7,7)</li>
</ul>
<p>하지만 완전히 <span class="math inline">\(\mu_i\)</span>를 분리해내는 것은 아님!</p>
<ul>
<li>Sparse signal
<ul>
<li>임계값이 높으면 975개 중 4개를 제외한 모든 <span class="math inline">\(\mu_i\)</span>가 0으로 추정됨.</li>
<li>0이 아닌 25개 parameter 중 9개가 0으로 추정됨.(36% error rate)</li>
<li><span class="math inline">\(\to\)</span> <em>threshold 적용하지 않은 경우보다 오류가 더 날 수 있다.</em></li>
</ul></li>
<li>Dense signal
<ul>
<li>750개 중 89개를 제외한 모든 <span class="math inline">\(\mu_i\)</span>가 0으로 추정됨,</li>
<li>0이 아닌 250개 parameter 중 51개가 0으로 추정됨.(20.4% error rate)</li>
</ul></li>
</ul>
<p><em>check</em></p>
<ul>
<li>parameter <span class="math inline">\(\mu_i\)</span>에 베이지안 모델 사용
<ul>
<li>이 모델 아래 각 <span class="math inline">\(\mu_i\)</span>는 <span class="math inline">\((1-w)\)</span>확률로 <span class="math inline">\(0\)</span>이고, a symmetric heavy-tailed density <span class="math inline">\(\gamma\)</span>로부터 확률 <span class="math inline">\(w\)</span>로 <span class="math inline">\(\mu_i\)</span>가 나옴.</li>
</ul></li>
<li><span class="math inline">\(w\)</span>는 key parameter로서 marginal maximum likelihood 접근법으로 데이터에서 자동 선택되어 다음 베이지안 모델에서 바뀜.</li>
</ul>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">ebayesthresh</span>(x)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ebayesthresh</span>(x, <span class="at">prior =</span> <span class="st">"laplace"</span>, <span class="at">a =</span> <span class="fl">0.5</span>, <span class="at">bayesfac =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">sdev =</span> <span class="cn">NA</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">threshrule =</span> <span class="st">"median"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>-6.9695560617371</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>-6.22417960636411</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>2.12041215294439</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>-0.0530948431730376</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>⋯</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>8.00425661803756</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>-5.29707681558067</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>-7.57152593109795</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>4.00198670738785</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li></ol>
</div>
</div>
<ul>
<li><code>sdev</code>: 잔차 <span class="math inline">\(X_i - \mu_i\)</span>의 표준편차</li>
<li><code>verbose</code>: 기록용</li>
</ul>
<p><strong>motivation</strong></p>
<ul>
<li>만약 <span class="math inline">\(\mu_i\)</span>가 합리적으로 sparse 하더라도, 중앙값의 절댓값이 0이 아닌 평균 <span class="math inline">\(\mu_i\)</span>를 가진 관찰값에 영향을 끼치지 않을 것이다.</li>
<li>하지만 신호가 너무 sparse하면 에러 발생할 수 있기 때문에 주의해야 함.</li>
</ul>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n) <span class="sc">+</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">runif</span>(<span class="dv">25</span>,<span class="sc">-</span><span class="dv">7</span>,<span class="dv">7</span>), <span class="fu">rep</span>(<span class="dv">0</span>,n<span class="dv">-25</span>)))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(x))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">median</span>(<span class="fu">abs</span>(x)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.187169
[1] 0.6598395</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>우리는 보통 noise의 sd를 모름.</p>
<p>이때 Ebayes는 sd를 사후분포의 median 값으로 가정하는데, 예제는 위와 같음</p>
</div>
</div>
</section>
<section id="description-of-the-method" class="level1">
<h1>Description of the method</h1>
<section id="the-bayesian-model" class="level2">
<h2 class="anchored" data-anchor-id="the-bayesian-model">The Bayesian model</h2>
<p><span class="math inline">\(X_i \sim N(\mu_i,1)\)</span>의 관측값이 있음.</p>
<p>베이지안 context에서 sparsity희소성의 개념은 parameter <span class="math inline">\(\mu_i\)</span>의 사전 분포prior distribution에 의해 모델링됨.</p>
<p>논문에서는 독립적인 사전 분포를 가진 이 <span class="math inline">\(\mu_i\)</span>를 모델링하는데, 각각 가지고 있는 mixture는 다음과 같음.</p>
<p><span class="math display">\[f_{prior}(\mu) = (1- w) \delta_0 (\mu) + w \gamma(\mu)\]</span></p>
<p><span class="math inline">\(\gamma\)</span>는 0이 아닌 부분으로 fixed unimodal symmetric density<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>로 가정한다.</p>
<ol type="1">
<li><code>prior</code>=“lapace”를 설정하면 척도 매개변수scale parameter a &gt; 0의 Laplace 밀도를 사용.</li>
<li>아래의 식(<span class="math inline">\(\mu_i\)</span>의 density function)에서 a는 기본 0.5로 지정되고, 변경도 가능</li>
</ol>
<p><span class="math display">\[\gamma_a(\mu) = \frac{1}{2} a \exp(-a|\mu|)\]</span></p>
<p>prior=“schy”로 설정하면 a는 무시되고 <span class="math inline">\(\mu\)</span>에 대한 <span class="math inline">\(\gamma\)</span>의 분포가 아래와 같음</p>
<p><span class="math display">\[\mu|Θ = \theta \sim N(0,\theta^{-1} -1) \text{with} Θ \sim \text{Beta}(\frac{1}{2},1)\]</span></p>
<p><span class="math inline">\(u^{-2}\)</span>는 코시 분포 Cauchy dustribution<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>와 같은 weight를 가짐 - 아래 density를 quasi-Cauchy density라 부름<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. - the combination of heavy tails<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p><span class="math display">\[\gamma(\mu) = (2\pi)^{-1/2} \{ 1-|mu| \tilde{\phi}(\mu)\emptyset(\mu)\}\]</span></p>
</section>
<section id="thresholding-rules" class="level2">
<h2 class="anchored" data-anchor-id="thresholding-rules">Thresholding rules</h2>
<p><span class="math inline">\(X \sim N(\mu,1)\)</span>라 가정할 때, <span class="math inline">\(X=x\)</span>에서 <span class="math inline">\(\mu\)</span> 조건부 posterior 분포를 찾을 수 있음.</p>
<p><span class="math inline">\(\hat{\mu}(x;w)\)</span>를 사후분포posterior distribution의 중앙값이라고 정의하자.</p>
<p>모든 고정된 <span class="math inline">\(w\)</span>에 대해 <span class="math inline">\(\hat{\mu}(x;w)\)</span>의 추정규칙은 <span class="math inline">\(|x| \le t(w)\)</span>인 경우에만 <span class="math inline">\(\hat{\mu}(x;w)= 0\)</span>이 되도록 임계값 속성을 갖는 <span class="math inline">\(x\)</span>의 monotonic function이다.</p>
<p>observation이 있을때, 각 observation <span class="math inline">\(X_i\)</span>에 각각 베이지안 절차를 적용해서 corresponding parameter <span class="math inline">\(\mu_i\)</span>의 추정치를 구할 수 있다.</p>
<p>default set <code>threshrule</code>=“dll”은 이 추정치로 사후 중위수 <span class="math inline">\(\hat{\mu}(x;w)\)</span>을 사용</p>
<ul>
<li><span class="math inline">\(X_i\)</span>가 독립적인 경우 정확한 베이지안 절차</li>
<li><em><span class="math inline">\(X_i\)</span>가 정확하게 독립적이지 않으면 추정 절차에서 정보의 손실이 있지만, 너무 많은 의존성dependence이 없다면 방법은 최소한 합리적인 결과at least reasonable results를 제공할 것임.</em></li>
</ul>
</section>
<section id="choosing-the-threshold" class="level2">
<h2 class="anchored" data-anchor-id="choosing-the-threshold">Choosing the threshold</h2>
<p><em>Emperical Bayes approach의 핵심은 weight <span class="math inline">\(w\)</span>를 mixing 하거나 임계값 <span class="math inline">\(t(w)\)</span>와 동일하게 선택하는 것</em></p>
<p><span class="math inline">\(X_i\)</span>가 독립적이라고 가정하면 marginal maximum likelihood approach에 의해 <span class="math inline">\(w\)</span> 추정할 수 있음.</p>
<p><span class="math inline">\(g = \gamma \star \emptyset\)</span>가 있을때, <span class="math inline">\(\star\)</span>는 convolution 임. observation <span class="math inline">\(X_i\)</span>의 주변 밀도는 아래와 같음</p>
<p><span class="math display">\[(1-w)\emptyset(x) + wg\]</span></p>
<p><span class="math inline">\(w\)</span>의 marginal maximum likelihood estimator <span class="math inline">\(\hat{w}\)</span>를 marginal log likelihood 의 maximizer로 정의하고, 이는 임계값이 <span class="math inline">\(t(w) \le \sqrt{2 logn}\)</span>을 만족하는 w에 대한 제약 조건에 따름.</p>
<p><span class="math display">\[\ell(w) = \sum^n_{i=1} \log \{ (1-w) \emptyset (X_i) + wg(X_i)\}\]</span></p>
<p>derivative도함수 <span class="math inline">\(\ell'(w)\)</span>은 <span class="math inline">\(w\)</span>의 monotonic function이므로 함수 g가 각각의 경우에 대해 다루기 쉽기 때문에 그 근은 수치적으로 매우 쉽게 찾을 수 있음.</p>
<p>임계값에서 Bound <span class="math inline">\(\sqrt{2 log n}\)</span>는 표본 크기 n의 샘플에 대하여 universal threshold라고 부른다.</p>
<p>점근적으로, n개의 독립적인 <span class="math inline">\(N(0,1)\)</span> 확률변수random variable 시퀀스의 최대 절대값임.</p>
<p>universal threshold를 사용하는 경우 높은 확률로 모든 영점 신호 값이 정확하게 추정.</p>
<p><em>임계값을 통해 가능한 신호의 경제성을 활용하려면 일반 임계값보다 더 큰 임계값을 고려할 필요가 없음.</em></p>
<p>사후 중위수 임계값에 대한 대안은 다음과 같이 <span class="math inline">\(\tau_b(w) &gt; 0\)</span> 값으로 정의되는 베이즈 인자 임계값을 사용할 수 있음.</p>
<p><span class="math display">\[P(\mu \ne 0 |X = \tau_b(w)) = 0.5\]</span></p>
</section>
<section id="wavelet-thresholding-and-other-extensions" class="level2">
<h2 class="anchored" data-anchor-id="wavelet-thresholding-and-other-extensions">Wavelet thresholding and other extensions</h2>
<p>논문의 동기는 웨이블릿을 사용한 함수 추정</p>
<p>일반적으로 실제 신호의 웨이블릿 계수는 미세 해상도 척도에서는 희소하고 거친 척도에서는 밀도가벼운 척도에서는 밀도가 높음.</p>
<p>따라서 레벨별 임계값 레벨을 조정하는 임계값 선택 방법을 개발하는 것이 바람직함.</p>
<p>웨이블릿 사례에서 EbayedThresh는 경험적 베이즈 방법을 변환의 각 레벨에 개별적으로 적용하는 것임.</p>
</section>
</section>
<section id="examples-and-aspects-of-the-package" class="level1">
<h1>Examples and aspects of the package</h1>
<section id="a-simple-illustrative-example" class="level2">
<h2 class="anchored" data-anchor-id="a-simple-illustrative-example">A simple illustrative example</h2>
<ul>
<li>n = 100</li>
<li>10개는 3.5이고 나머지는 0으로 가정.</li>
<li>신호에 normal independent noise 추가</li>
<li>Ebayesthresh사용해서 underlying mean vector 추정</li>
</ul>
<p><span class="math inline">\(\to\)</span> Ebayes 결과는 아래의 line처럼 나타남.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">90</span>), <span class="fu">rep</span>(<span class="fl">3.5</span>, <span class="dv">10</span>) )</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, mu)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ebayesthresh</span>(x))</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>90개의 0 중 대부분은 정확하게 추정되지만 3개는 영점으로 추정되지 않았음.</li>
<li>반대로 3.5와 같아야 하는 10개의 값(마지막으로 표시할 10개)은 모두 영점이 아닌 것으로 추정</li>
<li>그림을 자세히 조사하면 그림의 첫 번째 부분에서 가장 큰 두 데이터 점이 마지막 세그먼트에서 가장 작은 두 데이터 점과 값이 매우 유사해 보임.</li>
<li>오른쪽 패널에는 마지막 다섯 점의 평균만 0이 아닌 희소 표본sparse sample에 대한 동일한 절차의 효과가 표시됨</li>
<li>이 방법의 적응성adaptivity은 이제 모든 0 평균이 정확하게 추정된다는 사실에 의해 입증 가능.</li>
<li>the price paid는 영이 아닌 값의 더 큰 축소와 평활화가 이루어진다는 것이고, 그 중 두 값은 0으로 추정</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/a3e7502b-c71c-4a2e-88fb-60daaaeba8ec-1-7173f25d-9859-4058-b1e0-5ace4ed60a9d.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image.png</figcaption><p></p>
</figure>
</div>
</section>
<section id="varying-sparsity-in-a-larger-sample" class="level2">
<h2 class="anchored" data-anchor-id="varying-sparsity-in-a-larger-sample">Varying sparsity in a larger sample</h2>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">sample</span>( <span class="fu">c</span>( <span class="fu">runif</span>(m,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10000</span><span class="sc">-</span>m) ) ) </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, mu)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">tfromx</span>(x)</span></code></pre></div>
</div>
<p><em>routine 인 tformx는 노이즈 표준 편차를 1로 가정하여 threshold의 empirical bayes를 찾음.</em></p>
<p>임계값이 발견되면 임계값 루틴(tformx)을 사용하여 원래 데이터의 임계값을 하드 임계값hard threshold<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>으로 설정하여 <span class="math inline">\(\mu\)</span>의 추정치를 찾을 수 있음</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>muhat <span class="ot">&lt;-</span> <span class="fu">threshld</span>(x,tt)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(muhat,<span class="at">type=</span><span class="st">'l'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>단일 호출single call <code>ebayeshresh(x, sdev=1, threshrule="hard")</code>를 통해 얻을 수 있는 동일한 추정 muhat을 보면, 뚜렷하게 threshold를 알 수 있는 것은 아님</p>
<ul>
<li>선택한 임계값을 가장 작은 평균 제곱 오차를 생성하는 임계값과 비교</li>
<li>다음 루틴에서는 길이 10000의 신호를 0이 아닌 값이 균일하게 분포된 (-5,5)로 구성</li>
<li>임계값의 경험적 베이즈 선택 tebayes와 비교하여 하드 임계값에 대한 최소 평균 제곱 오차를 달성하는 임계값 tbest를 반환</li>
<li>제곱합 오차 rebayes 및 rbest도 반환</li>
<li>EbayesThresh에서 사용된 두 가지 루틴
<ul>
<li>경험적 베이즈 임계값을 찾기 위한 루틴 tfromx</li>
<li>하드 임계값을 적용하는 루틴 임계값</li>
</ul></li>
</ul>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ebdem1 <span class="ot">&lt;-</span> <span class="cf">function</span>(m)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>zz <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fu">runif</span>(m,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10000</span><span class="sc">-</span>m) )</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span>mu<span class="sc">+</span>zz</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">tfromx</span>(x)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>tvec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>rvec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">51</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( j <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">51</span>)) rvec[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>( (<span class="fu">threshld</span>(x, tvec[j]) <span class="sc">-</span> mu )<span class="sc">^</span><span class="dv">2</span> ) </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    reb <span class="ot">&lt;-</span> <span class="fu">sum</span>( (<span class="fu">threshld</span>(x, tt) <span class="sc">-</span> mu )<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>rbest <span class="ot">&lt;-</span> <span class="fu">min</span>(rvec)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>tbest <span class="ot">&lt;-</span> <span class="fu">mean</span> ( tvec[rvec<span class="sc">==</span>rbest] )</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">tebayes=</span>tt, <span class="at">rebayes=</span>reb, <span class="at">tbest=</span>tbest, <span class="at">rbest=</span>rbest))</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>예를 들어, 매개 변수 m은 매우 희박한sparse(m = 5) 신호를 완전히 조밀한dense(m = 10000) 신호를 생성하도록 변경될 수 있음.</p>
<ul>
<li>루틴 ebdem1의 출력에 대한 두 개의 플롯</li>
<li>왼쪽 그림은 경험적 베이즈 선택 tabayes를 이상적이지만 실제로는 도달할 수 없는 임계값 tbest와 비교</li>
<li>오른쪽 그림에서는 하드 임계값 추정치의 제곱합 오차를 두 임계값과 비교</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/b1420d0f-59c9-43db-838a-f0757d0343d2-1-c50fb7a9-0e59-4d7e-aaac-e1f3361c98a4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image.png</figcaption><p></p>
</figure>
</div>
<p>Hard threshold 사용하는 이유</p>
<ul>
<li>The reason that we use hard thresholding for the Empirical Bayes threshold, rather than the default posterior median estimator, is that allows an honest comparison with the threshold chosen to minimize error under hard thresholding.
<ul>
<li>하드 임계값에서 오류를 최소화하기 위해 선택한 임계값과 honest comparison 을 허락하기 때문</li>
</ul></li>
</ul>
</section>
<section id="the-posterior-median-thresholding-function" class="level2">
<h2 class="anchored" data-anchor-id="the-posterior-median-thresholding-function">The posterior median thresholding function</h2>
<p>routine<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> postmed를 사용하여 임계값 함수를 그릴 수 있는데, 이 루틴은 주어진 데이터와 prior distribution에서 주어진 mixing weight에서 posterior median function을 찾음</p>
<p><span class="math inline">\(w\)</span> 0.02에 대해, quasi-Cauchy prior를 사용하여 아래처럼 계산할 수 있음</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">postmed</span>( <span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="dv">8</span>, <span class="at">to=</span><span class="dv">8</span>, <span class="at">by=</span><span class="fl">0.1</span>), <span class="at">w=</span><span class="fl">0.02</span>, <span class="at">prior=</span><span class="st">"cauchy"</span>),<span class="at">type=</span><span class="st">'l'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/cell-13-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="other-control-parameters-in-the-packages-routines" class="level2">
<h2 class="anchored" data-anchor-id="other-control-parameters-in-the-packages-routines">Other control parameters in the package’s routines</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ebayesthresh</span>(x, <span class="at">a=</span><span class="cn">NA</span>)           <span class="co"># Laplace prior, scale factor also estimated</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ebayesthresh</span>(x, <span class="at">prior=</span><span class="st">"cauchy"</span>) <span class="co"># quasi-Cauchy prior</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ebayesthresh</span>(x, <span class="at">a=</span><span class="cn">NA</span>, <span class="at">threshrule=</span><span class="st">"mean"</span>) <span class="co"># Laplace prior, scale factor estimated</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ebayesthresh</span>(x, <span class="at">a=</span><span class="cn">NA</span>, <span class="at">threshrule=</span><span class="st">"hard"</span>) <span class="co"># use posterior mean as estimator</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ebayesthresh</span>(x) <span class="co"># Laplace prior, scale factor estimated</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ebayesthresh</span>(x, <span class="at">a=</span><span class="fl">0.2</span>) <span class="co"># use hard threshold with estimated threshold</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>tuniv <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">length</span>(x)) <span class="co"># Laplace prior with a=0.5 (default)</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">threshld</span>(x, tuniv) <span class="co"># Laplace prior with a=0.2</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">threshld</span>(x, tuniv, <span class="at">hard=</span><span class="cn">FALSE</span>)  <span class="co"># soft thresholding with universal threshold</span></span></code></pre></div>
</section>
</section>
<section id="wavelet-thresholding" class="level1">
<h1>Wavelet thresholding</h1>
<section id="empirical-bayes-thresholding-of-the-discrete-wavelet-transform" class="level2">
<h2 class="anchored" data-anchor-id="empirical-bayes-thresholding-of-the-discrete-wavelet-transform">Empirical Bayes thresholding of the discrete wavelet transform</h2>
<p><em>해당 패키지 지원이 되지 않음..이 버전에</em></p>
<p>The default action of the routine ebayesthresh.wavelet is to assume that the original signal is observed with independent Gaussian noise with mean zero and constant variance.</p>
<p>ebayeshresh.wavelet 루틴의 기본 동작은 원래 신호가 평균 0 및 상수 분산을 갖는 독립적인 가우스 노이즈로 관찰된다고 가정하는 것</p>
</section>
<section id="the-estimated-thresholds" class="level2">
<h2 class="anchored" data-anchor-id="the-estimated-thresholds">The estimated thresholds</h2>
<p><span class="math inline">\(N(0,\hat{\sigma^2_i})\)</span>를 가정했을때, 분포가 0에 가까울때(6번), std를 0이 아니라 1로 설정하는 게 합리적.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/353bb319-0e0b-4012-8a2e-ecbcf2488ec9-1-1b341302-0ee6-4a50-aac3-07f24fc7d457.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image.png</figcaption><p></p>
</figure>
</div>
</section>
<section id="the-stationary-noise-model" class="level2">
<h2 class="anchored" data-anchor-id="the-stationary-noise-model">The stationary noise model</h2>
<p>Johnstone과 Silverman(1997)에 따르면 원래 노이즈가 정상성을 띄고 있지만 상관관계가 있는 데이터에 웨이블릿 임계값 방법을 사용할 것을 고려.</p>
<p>노이즈가 독립적인 것처럼 웨이블릿 임계값을 수행하지만 다른 수준에서 다른 노이즈 분산을 허용하는 것이 적절한 접근임을 보임.</p>
<p>이것은 각 수준에서 개별적으로 만들어진 중앙값 절대 편차 함수를 사용하여 분산을 추정하는 것과 일치</p>
<p>ebayesthresh.wavelet 패키지의 the parameter value <code>vscale</code>=“level”로 수준에 따라 임계값이 계산되기 때문에 level이 coarser(거칠수록) 임계값이 더 커짐</p>
<ul>
<li>scale이 커질 수록 sparse희소성이 감소한다는 점을 밝힘</li>
</ul>
<p>백색소음<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<p>정상소음<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
<p>Overall the stationary noise plots remove some moderately high frequency effects still present in the white noise plots.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/8c08b1d0-27c9-41f0-a241-57d975857621-1-7d6db8ab-0a84-4d1c-a399-220dcfc0f2ba.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image.png</figcaption><p></p>
</figure>
</div>
</section>
<section id="the-translation-invariant-wavelet-transform" class="level2">
<h2 class="anchored" data-anchor-id="the-translation-invariant-wavelet-transform">The translation-invariant wavelet transform</h2>
<p>경험적 베이즈 접근법을 수행하는 가장 직관적인 방법은 독립적인 시퀀스처럼 각 수준에서 계수 벡터를 임계값으로 취하는 것.</p>
<p>As discussed in detail in Johnstone and Silverman (2005), the most straightforward way of applying the empirical Bayes approach is to threshold the coefficient vector at each level as if it were an independent sequence.</p>
</section>
<section id="smoothing-an-image" class="level2">
<h2 class="anchored" data-anchor-id="smoothing-an-image">Smoothing an image</h2>
<ul>
<li>경험적 베이즈 접근법은 사용된 변환에 상관없이 동일하게 적용 가능</li>
<li>추정되는 함수 또는 이미지의 표현에서 희소성을 활용할 것이므로, 이러한 유형의 이미지의 표현에 더 구체적으로 적합한 사전이 사용된다면 훨씬 더 나은 결과가 기대됨</li>
</ul>
</section>
</section>
<section id="more-general-mixture-weight-structure" class="level1">
<h1>More general mixture weight structure</h1>
<section id="increasing-sparsity-along-the-sequence" class="level2">
<h2 class="anchored" data-anchor-id="increasing-sparsity-along-the-sequence">Increasing sparsity along the sequence</h2>
<p><span class="math inline">\(\mu_i\)</span>가 0인 prior probability이 <span class="math inline">\(i\)</span>가 증가할수록 같이 증가하는 것으로 합리적으로 고려된다는 점에서 <span class="math inline">\(i\)</span>가 증가함에 따라 더 sparse해진다고 여겨지는 single sequence<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> <span class="math inline">\(\mu_i\)</span>가 있다고 가정하자.</p>
<p>예를 들어, <span class="math inline">\(\mu_i\)</span>는 시퀀스(sequence)의 각 항(term)<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>이 관심 대상인 함수 또는 현상<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>의 다른 크기(scale)의 측면을 묘사하는 large-scale을 설명하는 함수의 사전<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>에서 계수일 수 있다.이 사전에 있는 변수들에 의해 우리는 모델링이 되고 예측을 한다.</p>
<p>natural approach는 <span class="math inline">\(\mu_i\)</span>를 이전과 같은 형태의 prior distribution<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>을 가지지만 <span class="math inline">\(i\)</span>에 의존하는 가중치 <span class="math inline">\(w\)</span>를 가지고 있어서 아래와 같은 prior density<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a>를 모델링<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a>하는 것이다.</p>
<ul>
<li>각 항이 가지는 중요도를 고려하여 i에 따라 가중치가 부여</li>
<li>“<span class="math inline">\(\mu_i\)</span>”는 i번째 항에 해당하는 계수(coefficient)를 의미</li>
<li>이러한 사전 분포는 모델링에 사용되는 데이터 이전에 존재하는 정보를 반영하며, 이를 기반으로 모델을 구성하는 과정에서 업데이트함.</li>
</ul>
<p><span class="math display">\[(1-w_i)\delta(u) + w_i\gamma(u)\]</span></p>
<p>여기서 <span class="math inline">\(w_i\)</span>를 구하려면 log marginal likelihood 를 최대화하는 것으로 <span class="math inline">\(\hat{w}_i\)</span>를 선택하면 된다.</p>
<ul>
<li>단, <span class="math inline">\(w_1 \ge w_2 \ge \dots \ge w_n\)</span></li>
</ul>
<p><span class="math display">\[\ell(w_1, \dots, w_n) = \sum^n_{i=1} log\{(1-w_i)\emptyset(x_i) + w_i g(x_i)\}\]</span></p>
<p>일단 가중치가 추정되면, <span class="math inline">\(\mu_i\)</span>를 각각 추정할건데 mixing parameter <span class="math inline">\(w_i\)</span>를 가진 베이지안 모델에 근거한 임계값 규칙을 사용.</p>
<p>routine <code>wmonfromx</code></p>
<ul>
<li><span class="math inline">\(w_i\)</span>에 해당하는 모든 임계값들이 <span class="math inline">\(\sqrt{2 log n}\)</span>에 의해 제한된다는 조건에 따라 추정을 진행.</li>
</ul>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> ((<span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>)<span class="sc">/</span><span class="dv">2000</span>)<span class="sc">^</span><span class="fl">0.25</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">2000</span>, <span class="sc">-</span><span class="dv">7</span>,<span class="dv">7</span>)<span class="sc">*</span><span class="fu">rbinom</span>(<span class="dv">2000</span>,<span class="dv">1</span>,pp)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mu,<span class="at">type=</span><span class="st">'l'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>이 signal에서 0이 아닌 값이 [-7,7] 사이에 균등하게 분포되어 있음.</p>
<p>증가하는 sparsity희소성은 특정 지점까지 0이 아닌 점의</p>
<ul>
<li>예를 들어, 0이 아닌 값의 절반 이상이 the first quarter of the sequence에서 발생함.</li>
<li>이는 시퀀스의 처음 250개의 위치에서는 123개의 0이 아닌 값이 발생하지만, 마지막 250개의 위치에서는 단 8개만 발생한다는 것을 보여줌.</li>
<li>시계열 데이터의 희소성과 노이즈가 추가된 데이터로부터 추정된 monotone weights를 사용한 추정 결과(아래)를 보여줌</li>
</ul>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>wmon   <span class="ot">&lt;-</span> <span class="fu">wmonfromx</span>(x)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>thresh <span class="ot">&lt;-</span> <span class="fu">tfromw</span>(wmon)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>muhat  <span class="ot">&lt;-</span> <span class="fu">postmed</span>(x,wmon)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(muhat)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(thresh,<span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wmon)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Monotone weights는 Bayesian adaptive regression spline (BARS) 모형에서 사용되는 가중치(weight)입니다. BARS 모형은 회귀분석 모형으로, 자료에 대한 적합성을 높이기 위해 여러 개의 스플라인(spline) 함수를 결합하여 모델을 구성합니다. 이때, 스플라인 함수의 가중치가 작을수록 해당 함수는 모델에 미치는 영향력이 작아지며, 가중치가 크면 해당 함수의 영향력이 커집니다.</p>
<p>Monotone weights는 이 가중치를 설정하는 방법 중 하나로, 스플라인 함수가 증가하는 방향으로만 움직이도록 제한합니다. 따라서 monotone weights를 사용하면 모델이 단조적으로 증가하는 형태를 띄게 되며, 시계열 데이터와 같이 시간적인 변화를 반영해야 하는 경우에 유용하게 사용됩니다.</p>
</div>
</div>
<p>위에서 추정된 weights가 구간마다 일정한 값을 유지하다가 (constant), 갑자기 내려가는 (downward jumps) 구간이 있는 것을 확인할 수 있는데 이 추정 결과는 Monotonicity constraint가 적용된 시계열 데이터에서 특징적으로 나타남.</p>
<p>Monotonicity constraint가 적용된 시계열 데이터에서는, 점프가 발생하는 위치가 인공적인 “levels”로 시계열을 분할하는 데 사용될 수 있음.</p>
<p>:::{.callout-note} Monotonicity constraint란, 특정 변수의 값이 증가하거나 감소하는 방향으로 제한하는 제약조건입니다. 이는 데이터에서 관찰되는 특정 패턴을 모델링하고자 할 때 유용하게 사용됩니다.</p>
<p>시계열 데이터에서는, 시간의 흐름에 따라 값이 증가하거나 감소하는 경향성이 있는 경우가 많습니다. 이때, Monotonicity constraint를 적용하면, 모델링에 더 적합한 결과를 얻을 수 있습니다.</p>
<p>예를 들어, 시계열 데이터에서는 Monotonicity constraint를 사용하여 값이 증가하는 경향성이 있는 변수를 모델링할 수 있습니다. 이때, Monotonicity constraint를 적용하면 모델링에 불필요한 노이즈가 제거되고, 보다 정확한 예측 결과를 얻을 수 있습니다.</p>
<p>예) 주식시장에서 어떤 종목이 상승하고 있을 때 상승한다는 monotonicity contraint를 적용하면 더 정확한 분석이 가능:::</p>
</section>
<section id="parametric-dependence" class="level2">
<h2 class="anchored" data-anchor-id="parametric-dependence">Parametric dependence</h2>
<p>sequence를 따라 감소하도록 제한된 weight고려</p>
<p>Possibility</p>
<ul>
<li>상수 <span class="math inline">\(c_i\)</span>를 알고 있고,</li>
<li>가중치가 <span class="math inline">\(c_i\)</span>에 비례하여 비례proportional 상수를 추정할 수 있기를 바라는 것</li>
</ul>
<p>EbayesThresh 패키지의 <code>zetafromx</code> 루틴으로 구현</p>
<ul>
<li>basic model = <span class="math inline">\(w_i = c_i \zeta\)</span>, <span class="math inline">\(c_i\)</span>는 상수</li>
<li><span class="math inline">\(w_{lo}\)</span>를 가중치 <span class="math inline">\(t(w{lo}=\sqrt{2 log n}\)</span>을 가지는 가중치로 생각.</li>
<li><span class="math inline">\(w_{lo} \le w_i \le 1\)</span>으로 조건 주리 위해 아래 모델을 가정</li>
</ul>
<p><span class="math display">\[w_i(\zeta) = median \{ w_{lo} , c_i \zeta, 1\}\]</span></p>
<ul>
<li><span class="math inline">\(\zeta\)</span>는 비례 상수가 아니라 가중치 파라미터가 됨.</li>
<li><span class="math inline">\(\gamma\)</span>와 <span class="math inline">\(\emptyset\)</span>을 convolution한 것을 <span class="math inline">\(g\)</span>라 놓고, 아래처럼 marginal log likelihood function으로 <span class="math inline">\(\zeta\)</span>를 구할 수 있음.</li>
</ul>
<p><span class="math display">\[\ell(\zeta) = \sum_i log[ \{1- w_i (\zeta) \} \emptyset (z_i) + w_i(\zeta) \gamma (z_i)]\]</span></p>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>wts   <span class="ot">&lt;-</span> <span class="fu">zetafromx</span>(x, <span class="at">cs=</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>))<span class="sc">$</span>w <span class="co">#   find weights</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>muhat <span class="ot">&lt;-</span> <span class="fu">postmed</span>(x, wts) <span class="co">#   carry out estimation</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>thresh<span class="ot">&lt;-</span> <span class="fu">tfromw</span>(wts) <span class="co">#   find thresholds</span></span></code></pre></div>
</div>
<p>위처럼 역수 취해서 감소하게 만들어서 routine 이용하여 <span class="math inline">\(\ell(\zeta)\)</span>찾을 수 있음</p>
</section>
</section>
<section id="appendix" class="level1">
<h1>Appendix</h1>
<p>stationary noise(이베이즈에서 posterior distribution의 sd를 1로 정함)</p>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># White Noise</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>white_noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(num_samples)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Stationary Noise</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>std_dev <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>stationary_noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(num_samples, mean, std_dev)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>num_samples</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, white_noise, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"White Noise"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Amplitude"</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, stationary_noise, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Stationary Noise"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Amplitude"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Fourier Transform 했을때</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 화이트 노이즈 생성 및 퓨리에 변환</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>white_noise_fft <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">fft</span>(white_noise))  <span class="co"># 퓨리에 변환을 통한 주파수 성분 확인</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 정상 노이즈 생성 및 퓨리에 변환</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>stationary_noise_fft <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">fft</span>(stationary_noise))  <span class="co"># 퓨리에 변환을 통한 주파수 성분 확인</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 출력</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>num_samples</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(white_noise_fft, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">main=</span><span class="st">"White Noise FFT"</span>)  <span class="co"># 화이트 노이즈의 퓨리에 변환 결과 그래프 출력</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stationary_noise_fft, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">main=</span><span class="st">"Stationary Noise FFT"</span>)  <span class="co"># 정상 노이즈의 퓨리에 변환 결과 그래프 출력</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>EbayesThresh 사용했을때</p>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>num_samples</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">postmed</span>(white_noise), <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"White Noise Ebayes"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Amplitude"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">postmed</span>(stationary_noise), <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Stationary Noise Ebayes"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Amplitude"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>num_samples</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">postmed</span>(white_noise_fft), <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"White Noise Ebayes"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Amplitude"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">postmed</span>(stationary_noise_fft), <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Stationary Noise Ebayes"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Amplitude"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-10-EbayesThreshold_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>웨이블릿에서 white noise 보다 stationary noise으로 이베이즈 봤을때 stationary noise가 white noise보다 더 잘 peak를 골라내므로 stationary noise를 가정한다.</p>
<ul>
<li>Wavelet(시간/주파수 영역 동시 분석)</li>
<li>Fourier(시간 도메인 신호를 주파수 영역으로 가져와 분석)</li>
</ul>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>추후 review 작성예정<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>정규분포와 같이 중앙이 많고 꼬리가 양 옆으로 긴 분포<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>n=1인 t분포와 비슷하다.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>the main motivation for the quasi-Cauchy is its combination of heavy tails<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>꼬리tail이 지수함수보다 느리게 감소할 때 heavy tail이라 부름.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>특정 기준을 넘는 것만 허용한다는 뜻<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>어떤 실행을 하는 코드 블록으로 생각하자<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>백색소음 모델은 모든 주파수에서 무작위로 생성된 높은 에너지를 가진 잡음으로, 시간상의 자기상관성이 없으며, 각 시간에 대한 샘플들이 서로 독립적으로 생성됩니다. 이러한 특징 때문에 백색소음 모델은 무작위적인 변화를 모사하기 위해 자주 사용됩니다.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>정상소음 모델은 시간에 대한 통계적 특성(예: 평균과 분산)이 일정한 랜덤 프로세스입니다. 이러한 특징은 특정 주파수 대역에서 높은 에너지를 가진 잡음이 아니라, 시간에 따라 변화하는 일반적인 잡음을 모사하기에 더 적합합니다.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>연속된 데이터 포인트의 나열<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>시퀀스에서 하나의 데이터 포인트<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>observed data<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>통계학이나 머신 러닝 등에서 사용되는 용어로, 특정한 현상이나 데이터의 특징을 나타내는 다양한 변수들을 모아 놓은 집합<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>베이지안 통계학에서 모델링을 시작하기 전에 사용되는 초기 분포<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>사전 분포의 밀도 함수(density function)<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p><span class="math inline">\(i\)</span>에 따라 가중치가 다르게 적용된 사전 분포를 사용하여 <span class="math inline">\(\mu_i\)</span>를 모델링하는 방법을 제안<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>