<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="SEOYEON CHOI">
<meta name="dcterms.date" content="2023-01-05">

<title>Seoyeon’s Blog for study - GNAR data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Seoyeon’s Blog for study</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../about.html" aria-current="page">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/seoyeonc/blog/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">GNAR data</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">GNAR data</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">GNAR</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>SEOYEON CHOI </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 5, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Posts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/GCN/index.html" class="sidebar-item-text sidebar-link">GCN</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-17-Algorithm_traintest.html" class="sidebar-item-text sidebar-link">1st ST-GCN Example dividing train and test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-20-Algorithm_traintest.html" class="sidebar-item-text sidebar-link">1st ST-GCN Example dividing train and test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-18-Algorithm_traintest_2.html" class="sidebar-item-text sidebar-link">2nd ST-GCN Example dividing train and test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-21-Class.html" class="sidebar-item-text sidebar-link">Class of Method</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-11-Algorithm_EX_1.html" class="sidebar-item-text sidebar-link">GCN Algorithm Example 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2023-01-05-GNAR.html" class="sidebar-item-text sidebar-link active">GNAR data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-21-ST-GCN Dataset.html" class="sidebar-item-text sidebar-link">PyTorch ST-GCN Dataset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-28-gcn_simulation.html" class="sidebar-item-text sidebar-link">Simulation of geometric-temporal</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GCN/2022-12-07-torchgcn.html" class="sidebar-item-text sidebar-link">TORCH_GEOMETRIC.NN</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/GODE/index.html" class="sidebar-item-text sidebar-link">GODE</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-11-19-class_code_for_paper.html" class="sidebar-item-text sidebar-link">Class code for Comparison Study</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-12-27-DFT_study.html" class="sidebar-item-text sidebar-link">Discrete Fourier Transform</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-10-02-Earthquake_real.html" class="sidebar-item-text sidebar-link">Earthquake</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-12-01-graph_code_guebin.html" class="sidebar-item-text sidebar-link">Graph code</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/2022-09-02-paper_simulation.html" class="sidebar-item-text sidebar-link">Simulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/GODE/Untitled.html" class="sidebar-item-text sidebar-link">Untitled</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/Quarto_tip/index.html" class="sidebar-item-text sidebar-link">Guarto tip</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Quarto_tip/2023-01-02-quarto_tips.html" class="sidebar-item-text sidebar-link">quarto blog tips</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/Study/index.html" class="sidebar-item-text sidebar-link">Study</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2022-12-31-Space-study.html" class="sidebar-item-text sidebar-link">Study for Spaces</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#gnar-network-example" id="toc-gnar-network-example" class="nav-link active" data-scroll-target="#gnar-network-example">2.3 GNAR network example</a></li>
  <li><a href="#example-gnar-model-fitting" id="toc-example-gnar-model-fitting" class="nav-link" data-scroll-target="#example-gnar-model-fitting">2.4. Example: GNAR model fitting</a></li>
  <li><a href="#example-gnar-data-simulation-on-a-given-network" id="toc-example-gnar-data-simulation-on-a-given-network" class="nav-link" data-scroll-target="#example-gnar-data-simulation-on-a-given-network">2.5. Example: GNAR data simulation on a given network</a></li>
  <li><a href="#missing-data-and-changing-connection-weights-with-gnar-models" id="toc-missing-data-and-changing-connection-weights-with-gnar-models" class="nav-link" data-scroll-target="#missing-data-and-changing-connection-weights-with-gnar-models">2.6 Missing data and changing connection weights with GNAR models</a></li>
  <li><a href="#stationary-conditions-for-a-gnar-process-with-fixed-network" id="toc-stationary-conditions-for-a-gnar-process-with-fixed-network" class="nav-link" data-scroll-target="#stationary-conditions-for-a-gnar-process-with-fixed-network">2.7. Stationary conditions for a GNAR process with fixed network</a></li>
  <li><a href="#benefits-of-our-model-and-comparisons-to-others" id="toc-benefits-of-our-model-and-comparisons-to-others" class="nav-link" data-scroll-target="#benefits-of-our-model-and-comparisons-to-others">2.8. Benefits of our model and comparisons to others</a></li>
  <li><a href="#order-selection" id="toc-order-selection" class="nav-link" data-scroll-target="#order-selection">3.1. Order selection</a></li>
  <li><a href="#model-selection-on-a-wind-network-time-series" id="toc-model-selection-on-a-wind-network-time-series" class="nav-link" data-scroll-target="#model-selection-on-a-wind-network-time-series">3.2. Model selection on a wind network time series</a></li>
  <li><a href="#constructing-a-network-to-aid-prediction" id="toc-constructing-a-network-to-aid-prediction" class="nav-link" data-scroll-target="#constructing-a-network-to-aid-prediction">3.3. Constructing a network to aid prediction</a></li>
  <li><a href="#oecd-gdp-network-structure-aids-prediction" id="toc-oecd-gdp-network-structure-aids-prediction" class="nav-link" data-scroll-target="#oecd-gdp-network-structure-aids-prediction">4. OECD GDP: Network structure aids prediction</a></li>
  <li><a href="#finding-a-network-to-aid-prediction" id="toc-finding-a-network-to-aid-prediction" class="nav-link" data-scroll-target="#finding-a-network-to-aid-prediction">4.1. Finding a network to aid prediction</a></li>
  <li><a href="#results-and-comparisons" id="toc-results-and-comparisons" class="nav-link" data-scroll-target="#results-and-comparisons">4.2. Results and comparisons</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<blockquote class="blockquote">
<p>GNAR</p>
</blockquote>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2.robjects <span class="im">as</span> ro </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.vectors <span class="im">import</span> FloatVector </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.packages <span class="im">import</span> importr</span></code></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext rpy2.ipython</span></code></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>library(GNAR)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>library(igraph)</span></code></pre></div>
</div>
<section id="gnar-network-example" class="level2">
<h2 class="anchored" data-anchor-id="gnar-network-example">2.3 GNAR network example</h2>
<ul>
<li>edge(list)</li>
<li>dist(list)</li>
</ul>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>plot(fiveNet, vertex.label <span class="op">=</span> c(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>))</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>summary(<span class="st">"fiveNet"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Length     Class      Mode 
        1 character character </code></pre>
</div>
</div>
<p><strong>other examples</strong></p>
<ul>
<li>igraphtoGNAR or GNARtoigraph쓰는 예제</li>
</ul>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fiveNet2 <span class="op">&lt;-</span> GNARtoigraph(net <span class="op">=</span> fiveNet)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>summary(fiveNet2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH eee756c U-W- 5 5 -- 
+ attr: weight (e/n)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fiveNet3 <span class="op">&lt;-</span> igraphtoGNAR(fiveNet2)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">all</span>.equal(fiveNet, fiveNet3)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(igraphtoGNAR(fiveNet2))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GNARnet with 5 nodes 
edges:1--4 1--5 2--3 2--4 3--2 3--4 4--1 4--2 4--3 5--1 
     
 edges of each of length  1 </code></pre>
</div>
</div>
<p>edge들 보고 싶을 떄</p>
<p>whereas the <strong>reverse</strong> conversion would be performed as</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">&lt;-</span> make_ring(<span class="dv">10</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(igraphtoGNAR(g))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GNARnet with 10 nodes 
edges:1--2 1--10 2--1 2--3 3--2 3--4 4--3 4--5 5--4 5--6 
     6--5 6--7 7--6 7--8 8--7 8--9 9--8 9--10 10--1 10--9 
     
 edges of each of length  1 </code></pre>
</div>
</div>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>make_ring(<span class="dv">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH 9797a3f U--- 10 10 -- Ring graph
+ attr: name (g/c), mutual (g/l), circular (g/l)
+ edges from 9797a3f:
 [1] 1-- 2 2-- 3 3-- 4 4-- 5 5-- 6 6-- 7 7-- 8 8-- 9 9--10 1--10</code></pre>
</div>
</div>
<p>이어진 방향으로 각각의 edge를 만들어주는 게 igrapphtoGNAR이다</p>
<p><code>GNARtoigraph</code> function으로 높은 수준의 이웃 구조를 포함한 그래프를 추출할 수 있다.</p>
<ul>
<li><code>as.matrix</code> or <code>matrixtoGNAR</code>로 인접 행렬 구할 수 있음</li>
</ul>
<p>we can prosucean adjacency matrix for the <code>fiveNet</code> obeject with</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">as</span>.matrix(fiveNet)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]    0    0    0    1    1
[2,]    0    0    1    1    0
[3,]    0    1    0    1    0
[4,]    1    1    1    0    0
[5,]    1    0    0    0    0</code></pre>
</div>
</div>
<p>and an example converting a weighted adjacency matrix to a <code>GNARnet</code> object is</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>adj <span class="op">&lt;-</span> matrix(runif(<span class="dv">9</span>), ncol <span class="op">=</span> <span class="dv">3</span>, nrow <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>adj[adj <span class="op">&lt;</span> <span class="fl">0.3</span>] <span class="op">&lt;-</span> <span class="dv">0</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(matrixtoGNAR(adj))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: diagonal entries present in original matrix, these will be removed
GNARnet with 3 nodes 
edges:1--3 2--1 2--3 3--1 
 edges of unequal lengths </code></pre>
</div>
</div>
</section>
<section id="example-gnar-model-fitting" class="level2">
<h2 class="anchored" data-anchor-id="example-gnar-model-fitting">2.4. Example: GNAR model fitting</h2>
<ul>
<li>GNAR로 fit과 predict 가능</li>
</ul>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>data(<span class="st">"fiveNode"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>answer <span class="op">&lt;-</span> GNARfit(vts <span class="op">=</span> fiveVTS, net <span class="op">=</span> fiveNet, alphaOrder <span class="op">=</span> <span class="dv">2</span>, betaOrder <span class="op">=</span> c(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>answer</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: 
GNAR(2,[1,1]) 

Call:
lm(formula = yvec ~ dmat + 0)

Coefficients:
 dmatalpha1  dmatbeta1.1   dmatalpha2  dmatbeta2.1  
    0.20624      0.50277      0.02124     -0.09523  
</code></pre>
</div>
</div>
<ul>
<li>파라메터 4개 가지고 있음</li>
</ul>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>layout(matrix(c(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>plot(fiveVTS[, <span class="dv">1</span>], ylab <span class="op">=</span> <span class="st">"Node A Time Series"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>lines(fitted(answer)[, <span class="dv">1</span>], col <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>plot(fiveVTS[, <span class="dv">2</span>], ylab <span class="op">=</span> <span class="st">"Node B Time Series"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>lines(fitted(answer)[, <span class="dv">2</span>], col <span class="op">=</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>layout(matrix(c(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>plot(fiveVTS[, <span class="dv">3</span>], ylab <span class="op">=</span> <span class="st">"Node C Time Series"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>lines(fitted(answer)[, <span class="dv">3</span>], col <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>plot(fiveVTS[, <span class="dv">4</span>], ylab <span class="op">=</span> <span class="st">"Node D Time Series"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>lines(fitted(answer)[, <span class="dv">4</span>], col <span class="op">=</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>각 노드의 time series(검정), fitted values from ‘answer’ model overlaid in red</li>
</ul>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>myresiduals <span class="op">&lt;-</span> residuals(answer)[, <span class="dv">1</span>]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>layout(matrix(c(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plot(ts(residuals(answer)[, <span class="dv">1</span>]), ylab <span class="op">=</span> <span class="st">"`answer' model residuals"</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>hist(residuals(answer)[, <span class="dv">1</span>], main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"`answer' model residuals"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>myresiduals <span class="op">&lt;-</span> residuals(answer)[, <span class="dv">2</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>layout(matrix(c(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>plot(ts(residuals(answer)[, <span class="dv">1</span>]), ylab <span class="op">=</span> <span class="st">"`answer' model residuals"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>hist(residuals(answer)[, <span class="dv">2</span>], main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"`answer' model residuals"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>myresiduals <span class="op">&lt;-</span> residuals(answer)[, <span class="dv">3</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>layout(matrix(c(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plot(ts(residuals(answer)[, <span class="dv">1</span>]), ylab <span class="op">=</span> <span class="st">"`answer' model residuals"</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>hist(residuals(answer)[, <span class="dv">3</span>], main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"`answer' model residuals"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>myresiduals <span class="op">&lt;-</span> residuals(answer)[, <span class="dv">4</span>]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>layout(matrix(c(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>plot(ts(residuals(answer)[, <span class="dv">1</span>]), ylab <span class="op">=</span> <span class="st">"`answer' model residuals"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>hist(residuals(answer)[, <span class="dv">4</span>], main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"`answer' model residuals"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>residual plots from ‘answer’ model fit. Top: time sereies, Bottom: Histogram</li>
</ul>
</section>
<section id="example-gnar-data-simulation-on-a-given-network" class="level2">
<h2 class="anchored" data-anchor-id="example-gnar-data-simulation-on-a-given-network">2.5. Example: GNAR data simulation on a given network</h2>
<ul>
<li><p><code>fiveNet</code> 네트워크를 사용하여 네트워크 시계열 시뮬레이션 진행</p></li>
<li><p>두 시뮬레이션 모두 sigma argument를 사용하여 표준 편차가 제어되는 표준 정규 노이즈를 사용하여 생성된다.</p></li>
</ul>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>.seed(<span class="dv">10</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>fiveVTS2 <span class="op">&lt;-</span> GNARsim(n <span class="op">=</span> <span class="dv">200</span>, net <span class="op">=</span> fiveNet, alphaParams <span class="op">=</span> <span class="bu">list</span>(c(<span class="fl">0.4</span>, <span class="dv">0</span>, <span class="op">-</span><span class="fl">0.6</span>, <span class="dv">0</span>, <span class="dv">0</span>)), betaParams <span class="op">=</span> <span class="bu">list</span>(c(<span class="fl">0.3</span>)))</span></code></pre></div>
</div>
<ul>
<li>fiveVTS2 네트워크를 사용하여 시뮬레이션 된 것이다보니 파라메터 계수 비슷</li>
</ul>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(GNARfit(vts <span class="op">=</span> fiveVTS2, net <span class="op">=</span> fiveNet, alphaOrder <span class="op">=</span> <span class="dv">1</span>, betaOrder <span class="op">=</span> <span class="dv">1</span>, globalalpha <span class="op">=</span> FALSE))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: 
GNAR(1,[1]) 

Call:
lm(formula = yvec ~ dmat + 0)

Coefficients:
dmatalpha1node1  dmatalpha1node2  dmatalpha1node3  dmatalpha1node4  
        0.45902          0.13133         -0.49166          0.03828  
dmatalpha1node5      dmatbeta1.1  
        0.02249          0.24848  
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>.seed(<span class="dv">10</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>fiveVTS3 <span class="op">&lt;-</span> GNARsim(n <span class="op">=</span> <span class="dv">200</span>, net <span class="op">=</span> fiveNet, alphaParams <span class="op">=</span> <span class="bu">list</span>(rep(<span class="fl">0.2</span>, <span class="dv">5</span>), rep(<span class="fl">0.3</span>, <span class="dv">5</span>)), betaParams <span class="op">=</span> <span class="bu">list</span>(c(<span class="fl">0.2</span>, <span class="fl">0.3</span>), c(<span class="dv">0</span>)))</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(GNARfit(vts <span class="op">=</span> fiveVTS3, net <span class="op">=</span> fiveNet, alphaOrder <span class="op">=</span> <span class="dv">2</span>, betaOrder <span class="op">=</span> c(<span class="dv">2</span>,<span class="dv">0</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: 
GNAR(2,[2,0]) 

Call:
lm(formula = yvec ~ dmat + 0)

Coefficients:
 dmatalpha1  dmatbeta1.1  dmatbeta1.2   dmatalpha2  
     0.2537       0.1049       0.3146       0.2907  
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>fiveVTS4 <span class="op">&lt;-</span> simulate(GNARfit(vts <span class="op">=</span> fiveVTS2, net <span class="op">=</span> fiveNet, alphaOrder <span class="op">=</span> <span class="dv">1</span>, betaOrder <span class="op">=</span> <span class="dv">1</span>, globalalpha <span class="op">=</span> FALSE), n <span class="op">=</span> <span class="dv">200</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(GNARfit(vts <span class="op">=</span> fiveVTS4, net <span class="op">=</span> fiveNet, alphaOrder <span class="op">=</span> <span class="dv">1</span>, betaOrder <span class="op">=</span> <span class="dv">1</span>, globalalpha <span class="op">=</span> FALSE))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: 
GNAR(1,[1]) 

Call:
lm(formula = yvec ~ dmat + 0)

Coefficients:
dmatalpha1node1  dmatalpha1node2  dmatalpha1node3  dmatalpha1node4  
        0.48833          0.08260         -0.43978         -0.06986  
dmatalpha1node5      dmatbeta1.1  
       -0.05755          0.24028  
</code></pre>
</div>
</div>
<ul>
<li>위와 같이 GNAR 모델에 있는 시계열을 simulate하기 위해 GNARfit object에 대해 simulate S3 method 사용할 수 있다</li>
</ul>
</section>
<section id="missing-data-and-changing-connection-weights-with-gnar-models" class="level2">
<h2 class="anchored" data-anchor-id="missing-data-and-changing-connection-weights-with-gnar-models">2.6 Missing data and changing connection weights with GNAR models</h2>
<ul>
<li>The flexibility of GNAR modelling이 의미하는 것은 연결 가중치를 바꾸지 않고 변하는 네트워크로 missing data 를 모델링 할 수 있다.</li>
<li>한 노드가 missing data 구간이 생기면 그 구간에서만 네트워크를 변화하여 weight가 변경된다.</li>
</ul>
<div class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>fiveVTS0 <span class="op">&lt;-</span> fiveVTS</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>fiveVTS0[<span class="dv">50</span>:<span class="dv">150</span>, <span class="dv">3</span>] <span class="op">&lt;-</span> NA</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>nafit <span class="op">&lt;-</span> GNARfit(vts <span class="op">=</span> fiveVTS0, net <span class="op">=</span> fiveNet, alphaOrder <span class="op">=</span> <span class="dv">2</span>, betaOrder <span class="op">=</span> c(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>layout(matrix(c(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>plot(ts(fitted(nafit)[, <span class="dv">3</span>]), ylab <span class="op">=</span> <span class="st">"Node C fitted values"</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>plot(ts(fitted(nafit)[, <span class="dv">4</span>]), ylab <span class="op">=</span> <span class="st">"Node D fitted values"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-25-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span></code></pre></div>
</div>
</section>
<section id="stationary-conditions-for-a-gnar-process-with-fixed-network" class="level2">
<h2 class="anchored" data-anchor-id="stationary-conditions-for-a-gnar-process-with-fixed-network">2.7. Stationary conditions for a GNAR process with fixed network</h2>
<p><strong>Theorem 1</strong></p>
<ul>
<li><em>Given an unchanging network, <span class="math inline">\(\mathcal{G}\)</span> a sufficient condition for the GNAT model (1) to be stationary is</em></li>
</ul>
<p><span class="math display">\[\sum^p_{j=1}(|\alpha_{i,j}| + \sum^{C}_{c=1} \sum^{s_j}_{r=1} |\beta_{j,t,c}|)&lt;1 , \forall_i \in 1,\dots, N\]</span></p>
<p>위 조건을 <code>GNARsim</code>을 이용하여 확인 할 수 있다.</p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>.seed(<span class="dv">10</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>fiveVTS4 <span class="op">&lt;-</span> GNARsim(n <span class="op">=</span> <span class="dv">200</span>, net <span class="op">=</span> fiveNet, alphaParams <span class="op">=</span> <span class="bu">list</span>(rep(<span class="fl">0.2</span>, <span class="dv">5</span>)), betaParams <span class="op">=</span> <span class="bu">list</span>(c(<span class="fl">0.85</span>)))</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>c(mean(fiveVTS4[<span class="dv">1</span>:<span class="dv">50</span>, ]), mean(fiveVTS4[<span class="dv">51</span>:<span class="dv">100</span>, ]), mean(fiveVTS4[<span class="dv">101</span>:<span class="dv">150</span>, ]), mean(fiveVTS4[<span class="dv">151</span>:<span class="dv">200</span>, ]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    -120.511   -1370.216  -15725.884 -180319.140</code></pre>
</div>
</div>
<ul>
<li>The mean increases rapidly indicating nonstationarity.</li>
<li>평균이 빠르게 증가하는 것으로 보아 정상성을 띄고 있지 않다.</li>
</ul>
</section>
<section id="benefits-of-our-model-and-comparisons-to-others" class="level2">
<h2 class="anchored" data-anchor-id="benefits-of-our-model-and-comparisons-to-others">2.8. Benefits of our model and comparisons to others</h2>
</section>
<section id="order-selection" class="level2">
<h2 class="anchored" data-anchor-id="order-selection">3.1. Order selection</h2>
<p><strong>Bayesian information criterion</strong></p>
<p><span class="math display">\[BIC(p,s) = ln|\sum^{\hat{}}_{p,s}| + T^{-1} M ln(T)\]</span></p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>BIC(GNARfit())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.003953124</code></pre>
</div>
</div>
<div class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>BIC(GNARfit(betaOrder <span class="op">=</span> c(<span class="dv">2</span>, <span class="dv">1</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02251406</code></pre>
</div>
</div>
<p><strong>Akaike information criterion</strong></p>
<p><span class="math display">\[AIC(p,s) = ln|\sum^{\hat{}}_{p,s}| + 2T^{-1} M\]</span></p>
<div class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>AIC(GNARfit())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.06991947</code></pre>
</div>
</div>
<div class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>AIC(GNARfit(betaOrder <span class="op">=</span> c(<span class="dv">2</span>, <span class="dv">1</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.05994387</code></pre>
</div>
</div>
</section>
<section id="model-selection-on-a-wind-network-time-series" class="level2">
<h2 class="anchored" data-anchor-id="model-selection-on-a-wind-network-time-series">3.2. Model selection on a wind network time series</h2>
<p>the data suite vswind that contains a number of R objects pertaining to 721 wind speeds taken at each of 102 weather stations in England and Wales. The suite contains the vector time series vswindts, the associated network vswindnet, a character vector of the weather station location names in vswindnames and coordinates of the stations in the two column matrix vswindcoords. The data originate from the UK Met Office site http://wow.metoffice.gov.uk and full details can be found in the vswind help file in the GNAR package.</p>
<ul>
<li>nodes : 102</li>
<li>time step : 721</li>
</ul>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>oldpar <span class="op">&lt;-</span> par(cex <span class="op">=</span> <span class="fl">0.75</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>windnetplot()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>par(oldpar)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Plot of the wind speed network</p>
<ul>
<li>blue numbers are relative distance between sites</li>
<li>labels are the site name</li>
</ul>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>BIC(GNARfit(vts <span class="op">=</span> vswindts, net <span class="op">=</span> vswindnet, alphaOrder <span class="op">=</span> <span class="dv">1</span>, betaOrder <span class="op">=</span> <span class="dv">0</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -233.3848</code></pre>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>BIC(GNARfit(vts <span class="op">=</span> vswindts, net <span class="op">=</span> vswindnet, alphaOrder <span class="op">=</span> <span class="dv">1</span>, betaOrder <span class="op">=</span> <span class="dv">0</span>, globalalpha <span class="op">=</span> FALSE))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -233.1697</code></pre>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>BIC.Alpha2.Beta <span class="op">&lt;-</span> matrix(<span class="dv">0</span>, ncol <span class="op">=</span> <span class="dv">15</span>, nrow <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b1 <span class="kw">in</span> <span class="dv">0</span>:<span class="dv">14</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(b2 <span class="kw">in</span> <span class="dv">0</span>:<span class="dv">14</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>        BIC.Alpha2.Beta[b1 <span class="op">+</span> <span class="dv">1</span>, b2 <span class="op">+</span> <span class="dv">1</span>] <span class="op">&lt;-</span> BIC(GNARfit(vts <span class="op">=</span> vswindts,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                    net <span class="op">=</span> vswindnet, alphaOrder <span class="op">=</span> <span class="dv">2</span>, betaOrder <span class="op">=</span> c(b1, b2)))</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>contour(<span class="dv">0</span>:<span class="dv">14</span>, <span class="dv">0</span>:<span class="dv">14</span>, log(<span class="dv">251</span> <span class="op">+</span> BIC.Alpha2.Beta), xlab <span class="op">=</span> <span class="st">"Lag 1 Neighbour Order"</span>, ylab <span class="op">=</span> <span class="st">"Lag 2 Neighbour Order"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-35-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>a set of <code>GNAR(2,[b1,b2])</code> models with b1, b2 ranging from zero to 14</li>
<li>Contour plot of BIC values for the two-lag autoregressive model incorporating b1-stage and b2-stage neighbours at time lags one and two. Values shown are log(251 + BIC) to display clearer contours.</li>
</ul>
<p><em>이해 덜 됨..</em></p>
<ul>
<li>increasing the lag two neighbour sets beyond first stage neighbours would appear to increase the BIC for those lag one neighbour stages greater than five</li>
</ul>
<p><em>chatGPT</em></p>
<p>이 문장을 조금 더 자세히 설명하면, BIC(Bayesian Information Criterion)는 모델을 선택할 때 사용하는 지표로서, 우리가 선택한 모델이 얼마나 적합한지를 측정합니다. 이 문장에서는, 이웃 집합의 대기 시간이 증가할수록 BIC 값이 증가할 것이라고 언급하고 있습니다. 이는 우리가 선택한 모델이 적합하지 않을 가능성이 있다는 의미입니다. 그래프를 보고 있을 때, 수평 윤곽선은 BIC 값이 0인 스테이지를 의미합니다. 이는 우리가 선택한 모델이 완벽하게 적합한다는 의미입니다.</p>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>goodmod <span class="op">&lt;-</span> GNARfit(vts <span class="op">=</span> vswindts, net <span class="op">=</span> vswindnet, alphaOrder <span class="op">=</span> <span class="dv">2</span>, betaOrder <span class="op">=</span> c(<span class="dv">5</span>, <span class="dv">1</span>))</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>goodmod</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: 
GNAR(2,[5,1]) 

Call:
lm(formula = yvec ~ dmat + 0)

Coefficients:
 dmatalpha1  dmatbeta1.1  dmatbeta1.2  dmatbeta1.3  dmatbeta1.4  dmatbeta1.5  
    0.56911      0.10932      0.03680      0.02332      0.02937      0.04709  
 dmatalpha2  dmatbeta2.1  
    0.23424     -0.04872  
</code></pre>
</div>
</div>
</section>
<section id="constructing-a-network-to-aid-prediction" class="level2">
<h2 class="anchored" data-anchor-id="constructing-a-network-to-aid-prediction">3.3. Constructing a network to aid prediction</h2>
<p>We propose a network construction method that uses prediction error, but note here that our scope is <strong>not to estimate an underlying network</strong>, but merely to find a structure that is useful in the task of prediction.</p>
<p>we use a prediction error measure, understood as the sum of squared differences between the observations and the estimates:</p>
<p><span class="math display">\[\sum^N_{i=1} (X_{i,t} - \hat{X}_{i,t})^2\]</span></p>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">&lt;-</span> predict(GNARfit(vts <span class="op">=</span> fiveVTS[<span class="dv">1</span>:<span class="dv">199</span>,], net <span class="op">=</span> fiveNet, alphaOrder <span class="op">=</span> <span class="dv">2</span>, betaOrder <span class="op">=</span> c(<span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>prediction</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time Series:
Start = 1 
End = 1 
Frequency = 1 
    Series 1  Series 2  Series 3  Series 4   Series 5
1 -0.6427718 0.2060671 0.2525534 0.1228404 -0.8231921</code></pre>
</div>
</div>
</section>
<section id="oecd-gdp-network-structure-aids-prediction" class="level2">
<h2 class="anchored" data-anchor-id="oecd-gdp-network-structure-aids-prediction">4. OECD GDP: Network structure aids prediction</h2>
<p>GOP growth rate time series</p>
<ul>
<li><p>35 countries from the OECD website</p></li>
<li><p>time series : 1961 - 2013</p></li>
<li><p>T = 52</p></li>
<li><p>Nodes = 35</p></li>
<li><p>In this data set 20.8% (379 out of 1820) of the observations were missing due to some nodes not being included from the start.</p></li>
<li><p>we do not uese covariate information, so C=1</p></li>
</ul>
<div class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>library(<span class="st">"fields"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>layout(matrix(c(<span class="dv">1</span>, <span class="dv">2</span>), nrow <span class="op">=</span> <span class="dv">1</span>, ncol <span class="op">=</span> <span class="dv">2</span>), widths <span class="op">=</span> c(<span class="fl">4.5</span>, <span class="dv">1</span>))</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>image(t(<span class="bu">apply</span>(gdpVTS, <span class="dv">1</span>, rev)), xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>, col <span class="op">=</span> gray.colors(<span class="dv">14</span>), xlab <span class="op">=</span> <span class="st">"Year"</span>, ylab <span class="op">=</span> <span class="st">"Country"</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>axis(side <span class="op">=</span> <span class="dv">1</span>, at <span class="op">=</span> seq(<span class="im">from</span> <span class="op">=</span> <span class="dv">0</span>, to <span class="op">=</span> <span class="dv">1</span>, length <span class="op">=</span> <span class="dv">52</span>), labels <span class="op">=</span> FALSE, col.ticks <span class="op">=</span> <span class="st">"grey"</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>axis(side <span class="op">=</span> <span class="dv">1</span>, at <span class="op">=</span> seq(<span class="im">from</span> <span class="op">=</span> <span class="dv">0</span>, to <span class="op">=</span> <span class="dv">1</span>, length <span class="op">=</span> <span class="dv">52</span>)[<span class="dv">5</span><span class="op">*</span>(<span class="dv">1</span>:<span class="dv">11</span>)], labels <span class="op">=</span> (<span class="dv">1</span>:<span class="dv">52</span>)[<span class="dv">5</span><span class="op">*</span>(<span class="dv">1</span>:<span class="dv">11</span>)])</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>axis(side <span class="op">=</span> <span class="dv">2</span>, at <span class="op">=</span> seq(<span class="im">from</span> <span class="op">=</span> <span class="dv">1</span>, to <span class="op">=</span> <span class="dv">0</span>, length <span class="op">=</span> <span class="dv">35</span>), labels <span class="op">=</span> colnames(gdpVTS), las <span class="op">=</span> <span class="dv">1</span>, cex <span class="op">=</span> <span class="fl">0.8</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>layout(matrix(<span class="dv">1</span>))</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>image.plot(zlim <span class="op">=</span> <span class="bu">range</span>(gdpVTS, na.rm <span class="op">=</span> TRUE), legend.only <span class="op">=</span> TRUE, col <span class="op">=</span> gray.colors(<span class="dv">14</span>))</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-38-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Heat plot(grey scale) of the differenced time series,</p>
<ul>
<li>white space indicates missing time series observations</li>
</ul>
</section>
<section id="finding-a-network-to-aid-prediction" class="level2">
<h2 class="anchored" data-anchor-id="finding-a-network-to-aid-prediction">4.1. Finding a network to aid prediction</h2>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>net1 <span class="op">&lt;-</span> seedToNet(seed.no <span class="op">=</span> seed.nos[<span class="dv">1</span>], nnodes <span class="op">=</span> <span class="dv">35</span>, graph.prob <span class="op">=</span> <span class="fl">0.15</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>net2 <span class="op">&lt;-</span> seedToNet(seed.no <span class="op">=</span> seed.nos[<span class="dv">2</span>], nnodes <span class="op">=</span> <span class="dv">35</span>, graph.prob <span class="op">=</span> <span class="fl">0.15</span>)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>layout(matrix(c(<span class="dv">2</span>, <span class="dv">1</span>), <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>par(mar<span class="op">=</span>c(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>plot(net1, vertex.label <span class="op">=</span> colnames(gdpVTS), vertex.size <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>plot(net2, vertex.label <span class="op">=</span> colnames(gdpVTS), vertex.size <span class="op">=</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-40-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li><p>Erdos-Renyi random graphs xonstructed from the first two elements of the <code>seed.nos</code> variable with 35 nodes and connection probability 0.15.</p></li>
<li><p>자기회귀 모델인 GNAR 모델을 예측에 사용할 때, 어떤 네트워크가 가장 적합한지 조사해야 함.</p></li>
<li><p>이때 각 노드의 자기 상관 함수를 이용한 초기 분석 결과, 2차 자기회귀 구성 요소가 충분할 것으로 예상되어 p = 2까지의 GNAR 모델을 시험함.</p></li>
<li><p>각 시간 지연에서 최대 2개의 이웃 집합을 포함함.</p></li>
<li><p>이에 따라 아래와 같은 GNAR 모델이 시험됨.</p>
<ul>
<li>GNAR(1, [0]), GNAR(1, [1]), GNAR(2, [0, 0]), GNAR(2, [1, 0]), GNAR(2, [1, 1]), GNAR(2, [2, 0]), GNAR(2, [2, 1]), 그리고 GNAR(2, [2, 2])가 시험되며, 각각 individual-<span class="math inline">\(\alpha\)</span>와 global-<span class="math inline">\(\alpha\)</span> GNAR 모델로 적합함.</li>
<li>총 16개의 모델이 생성됨.</li>
<li>이 중에서 전체 GDP 예측에 사용할 GNAR 모델을 선택할 것.</li>
<li>연결 확률이 0.15인 10,000개의 임의의 양방향 네트워크를 생성하고, 위에서 언급한 GNAR 모델을 이용해 예측할 것.</li>
<li>그래서 이 예제는 상당한 계산 시간이 필요(데스크탑 PC에서 약 90분).</li>
<li>이를 위해 아래 코드에는 일부 분석만 포함.</li>
<li>계산 상의 이유로, 우선 각 노드에서 표준 편차로 나눠서 잔차가 각 노드에서 동일한 분산을 가지게 함.</li>
<li>seedSim 함수는 예측값과 원래 값의 제곱 차이의 합을 출력하고, 이를 예측 정확도의 측정 기준으로 사용</li>
</ul></li>
</ul>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>gdpVTSn <span class="op">&lt;-</span> <span class="bu">apply</span>(gdpVTS, <span class="dv">2</span>, function(x){x <span class="op">/</span> sd(x[<span class="dv">1</span>:<span class="dv">50</span>], na.rm <span class="op">=</span> TRUE)})</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">&lt;-</span> c(rep(<span class="dv">1</span>, <span class="dv">2</span>), rep(<span class="dv">2</span>, <span class="dv">6</span>))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>betas <span class="op">&lt;-</span> <span class="bu">list</span>(c(<span class="dv">0</span>), c(<span class="dv">1</span>), c(<span class="dv">0</span>, <span class="dv">0</span>), c(<span class="dv">1</span>, <span class="dv">0</span>), c(<span class="dv">1</span>, <span class="dv">1</span>), c(<span class="dv">2</span>, <span class="dv">0</span>), c(<span class="dv">2</span>, <span class="dv">1</span>), c(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>seedSim <span class="op">&lt;-</span> function(seedNo, modelNo, globalalpha){</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    net1 <span class="op">&lt;-</span> seedToNet(seed.no <span class="op">=</span> seedNo, nnodes <span class="op">=</span> <span class="dv">35</span>, graph.prob <span class="op">=</span> <span class="fl">0.15</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    gdpPred <span class="op">&lt;-</span> predict(GNARfit(vts <span class="op">=</span> gdpVTSn[<span class="dv">1</span>:<span class="dv">50</span>, ], net <span class="op">=</span> net1,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                               alphaOrder <span class="op">=</span> alphas[modelNo], betaOrder <span class="op">=</span> betas[[modelNo]],</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>                               globalalpha <span class="op">=</span> globalalpha))</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(<span class="bu">sum</span>((gdpPred <span class="op">-</span> gdpVTSn[<span class="dv">51</span>, ])<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>seedSim(seedNo <span class="op">=</span> seed.nos[<span class="dv">1</span>], modelNo <span class="op">=</span> <span class="dv">1</span>, globalalpha <span class="op">=</span> TRUE)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 23.36913</code></pre>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>seedSim(seed.nos[<span class="dv">1</span>], modelNo <span class="op">=</span> <span class="dv">3</span>, globalalpha <span class="op">=</span> TRUE)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.50739</code></pre>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>seedSim(seed.nos[<span class="dv">1</span>], modelNo <span class="op">=</span> <span class="dv">3</span>, globalalpha <span class="op">=</span> FALSE)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18.96766</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="2023-01-05-GNAR_files/figure-html/433688fa-9944-49b8-a0d4-a03ccbfa7453-1-505b0599-3887-46b8-aca5-d82dfa177e82.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image.png</figcaption><p></p>
</figure>
</div>
<ul>
<li>10,000개의 임의의 네트워크와 16개의 모델로부터 시뮬레이션한 예측 오류의 박스 그래프</li>
<li>(계산 시간이 길어(90분) 코드는 생략).</li>
<li>일반적으로 global-α 모델은 더 낮은 예측 오류를 일으킴.</li>
<li>그래서 이 버전의 GNAR 모델을 사용할 것.</li>
<li>그림 9에서 첫 번째 모델인 GNAR(1, [0])과 세 번째 모델인 GNAR(2, [0, 0])의 경우, “박스 그래프”는 인접한 매개변수가 적합되지 않아 결과가 전부 동일해 짧은 수평선으로 표시됨.</li>
<li>다른 global-α 모델들은 이 안에 포함되어 있기 때문에, global-α GNAR(2, [2, 2])의 예측 오류가 최소가 되는 임의의 그래프를 선택할 것.</li>
<li>이는 seed.nos[921]에서 생성된 네트워크가 선택되게 됩니다.</li>
</ul>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>net921 <span class="op">&lt;-</span> seedToNet(seed.no <span class="op">=</span> seed.nos[<span class="dv">921</span>], nnodes <span class="op">=</span> <span class="dv">35</span>, graph.prob <span class="op">=</span> <span class="fl">0.15</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>layout(matrix(c(<span class="dv">1</span>), <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>plot(net921, vertex.label <span class="op">=</span> colnames(gdpVTS), vertex.size <span class="op">=</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-01-05-GNAR_files/figure-html/cell-45-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Randomly generated un-weighted and un-directed graph over the OECD ountries that minimises the prediction error at t = 51 using GNAR(2, [2, 2]).</p>
<ul>
<li>seed.nos[921]에서 생성된 네트워크</li>
<li>네트워크에는 전부 2개 이상의 이웃을 가지고 있는 countries들이 있고, 총 97개의 edges이 있음.</li>
<li>이 “921” 네트워크는 GDP 예측을 위해 생성되었기 때문에, 찾은 네트워크에 인식 가능한 구조가 있지 않을 것이라고 예상할 수 있음</li>
<li>그러나 미국, 멕시코, 캐나다는 각각 8개, 8개, 6개의 edge을 가지고 있어 매우 잘 연결되어 있음.</li>
<li>스웨덴과 칠레도 잘 연결되어 있으며, 각각 8개와 7개의 edge을 가지고 있습니다.</li>
<li>예측 성능이 유사한 적은 개수의 edge를 가진 네트워크를 찾기 위해 테스트 될 수 있지만, 여기서는 전체 선택된 네트워크를 그대로 사용.</li>
<li>이 네트워크를 사용하면 BIC를 이용해 최적의 GNAR 순서를 선택할 수 있음.</li>
</ul>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>res <span class="op">&lt;-</span> rep(NA, <span class="dv">8</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="kw">in</span> <span class="dv">1</span>:<span class="dv">8</span>){</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    res[i] <span class="op">&lt;-</span> BIC(GNARfit(gdpVTSn[<span class="dv">1</span>:<span class="dv">50</span>, ],</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>                          net <span class="op">=</span> seedToNet(seed.nos[<span class="dv">921</span>], nnodes <span class="op">=</span> <span class="dv">35</span>, graph.prob <span class="op">=</span> <span class="fl">0.15</span>),</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>                          alphaOrder <span class="op">=</span> alphas[i], betaOrder <span class="op">=</span> betas[[i]]))}</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>order(res)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6 3 4 7 8 5 1 2</code></pre>
</div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>sort(res)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -64.44811 -64.32155 -64.18751 -64.12683 -64.09656 -63.86919 -60.67858
[8] -60.54207</code></pre>
</div>
</div>
</section>
<section id="results-and-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="results-and-comparisons">4.2. Results and comparisons</h2>
<ul>
<li>이전 섹션의 모델을 사용해 t=52일 때의 값을 예측</li>
<li>이 예측 오류를 표준 AR과 VAR 모델을 사용해 찾은 예측 오류와 비교</li>
<li>GNAR 예측은 선택된 네트워크(seed.nos[921]에 해당)를 가진 GNAR(2, [2, 0]) 모델을 t=51까지의 데이터에 적합시키고, t=52일 때의 값을 예측</li>
<li>우선 series를 정규화한 다음, 모델 적합으로부터 SSE를 계산합니다.</li>
</ul>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>gdpVTSn2 <span class="op">&lt;-</span> <span class="bu">apply</span>(gdpVTS, <span class="dv">2</span>, function(x){x <span class="op">/</span> sd(x[<span class="dv">1</span>:<span class="dv">51</span>], na.rm <span class="op">=</span> TRUE)})</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>gdpFit <span class="op">&lt;-</span> GNARfit(gdpVTSn2[<span class="dv">1</span>:<span class="dv">51</span>,], net <span class="op">=</span> net921, alphaOrder <span class="op">=</span> <span class="dv">2</span>, betaOrder <span class="op">=</span> c(<span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>summary(gdpFit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yvec2 ~ dmat2 + 0)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4806 -0.5491 -0.0121  0.5013  3.1208 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
dmat2alpha1  -0.41693    0.03154 -13.221  &lt; 2e-16 ***
dmat2beta1.1 -0.12662    0.05464  -2.317   0.0206 *  
dmat2beta1.2  0.28044    0.06233   4.500  7.4e-06 ***
dmat2alpha2  -0.33282    0.02548 -13.064  &lt; 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.8926 on 1332 degrees of freedom
  (23 observations deleted due to missingness)
Multiple R-squared:  0.1859,    Adjusted R-squared:  0.1834 
F-statistic: 76.02 on 4 and 1332 DF,  p-value: &lt; 2.2e-16

GNAR BIC: -62.86003</code></pre>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>((predict(gdpFit) <span class="op">-</span> gdpVTSn2[<span class="dv">52</span>, ])<span class="op">^</span><span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.737203</code></pre>
</div>
</div>
<p>이 GNAR 모델의 적합된 매개변수는 <span class="math inline">\(\alpha^1 = - 0.42, \beta^1,1 = - 0.13, \beta^1,2 = 0.28\)</span>, 그리고 <span class="math inline">\(\alpha^2 = - 0.33\)</span>입니다.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">parameters</th>
<th style="text-align: right;">prediction error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GNAR(2,[2,0])</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Individual AR(2)</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">8.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VAR(1)</td>
<td style="text-align: right;">199</td>
<td style="text-align: right;">26.2</td>
</tr>
</tbody>
</table>
<p>Estimated prediction error of differenced real GDP change at t = 52 for all 35 countries.</p>
<p>우리의 방법과 CRAN forecast 패키지의 버전 8.0에서의 forecast.ar()과 auto.arima() 함수를 사용해 각 노드별로 AR 모델을 적합한 결과를 비교</p>
<ul>
<li>섹션 4.1의 자기상관 분석을 고려해 각각 35개의 개별 모델의 최대 AR 순서를 p=2로 설정</li>
</ul>
<div class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>library(<span class="st">"forecast"</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>arforecast <span class="op">&lt;-</span> <span class="bu">apply</span>(gdpVTSn2[<span class="dv">1</span>:<span class="dv">51</span>, ], <span class="dv">2</span>, function(x){</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>            forecast(auto.arima(x[<span class="op">!</span><span class="kw">is</span>.na(x)], d<span class="op">=</span> ,D<span class="op">=</span><span class="dv">0</span>,<span class="bu">max</span>.p <span class="op">=</span> <span class="dv">2</span>,<span class="bu">max</span>.q<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                                <span class="bu">max</span>.P<span class="op">=</span><span class="dv">0</span>,<span class="bu">max</span>.Q <span class="op">=</span> <span class="dv">0</span>,stationary <span class="op">=</span> TRUE, seasonal <span class="op">=</span> FALSE), ic <span class="op">=</span> <span class="st">"bic"</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                     allowmean <span class="op">=</span> FALSE, allowdraft <span class="op">=</span> FALSE, trace <span class="op">=</span> FALSE, h<span class="op">=</span><span class="dv">1</span>)$mean</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>((arforecast <span class="op">-</span> gdpVTSn2[<span class="dv">52</span>, ])<span class="op">^</span><span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.8974</code></pre>
</div>
</div>
<p>We fit the model using the VAR function and then use the restrict function to reduce dimensionality further, by setting to zero any coefficient whose associated absolute t-statistic value is less than two.</p>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>library(<span class="st">"vars"</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>gdpVTSn2<span class="fl">.0</span> <span class="op">&lt;-</span> gdpVTSn2</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>gdpVTSn2<span class="fl">.0</span>[<span class="kw">is</span>.na(gdpVTSn2<span class="fl">.0</span>)] <span class="op">&lt;-</span> <span class="dv">0</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>varforecast <span class="op">&lt;-</span> predict(restrict(VAR(gdpVTSn2<span class="fl">.0</span>[<span class="dv">1</span>:<span class="dv">51</span>, ], p <span class="op">=</span> <span class="dv">1</span>, <span class="bu">type</span> <span class="op">=</span> <span class="st">"none"</span>)), n.ahead <span class="op">=</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<p>compute the prediction error</p>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>getfcst <span class="op">&lt;-</span> function(x){<span class="cf">return</span>(x[<span class="dv">1</span>])}</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>varforecastpt <span class="op">&lt;-</span> unlist(lapply(varforecast$fcst, getfcst))</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>((varforecastpt <span class="op">-</span> gdpVTSn2<span class="fl">.0</span>[<span class="dv">52</span>, ])<span class="op">^</span><span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26.19805</code></pre>
</div>
</div>
<p>GNAR 모델은 AR과 VAR 결과보다 적은 예측 오류를 제공합니다. 이는 AR과 비교했을 때 29%가 줄어들고, VAR과 비교했을 때 78%가 줄어듭니다.</p>
<p>위 절차를 반복해 2단계 앞으로의 예측을 기반으로 분석을 수행합니다.</p>
<p>이 경우 다른 네트워크가 GNAR(2,[2,2]) 모델의 예측 오류를 최소화합니다.</p>
<p>그러나 BIC 단계에서 GNAR(2,[0,0]) 모델이 최적으로 적합된 것을 식별하였고, 이는 네트워크 회귀 매개변수를 포함하지 않는 모델입니다.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>